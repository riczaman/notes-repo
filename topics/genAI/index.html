
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Personal Technical Notes">
      
      
        <meta name="author" content="Ricky Zaman">
      
      
        <link rel="canonical" href="https://riczaman.github.io/notes-repo/topics/genAI/">
      
      
        <link rel="prev" href="../aiFoundations/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Oracle Generative AI Professional - Ricky's Notes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Raleway";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fundamentals-of-large-language-models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Ricky&#39;s Notes" class="md-header__button md-logo" aria-label="Ricky's Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ricky's Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Oracle Generative AI Professional
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/riczaman/notes-repo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Ricky&#39;s Notes" class="md-nav__button md-logo" aria-label="Ricky's Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Ricky's Notes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/riczaman/notes-repo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Topics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jenkins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jenkins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GitHub Actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aiFoundations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Oracle AI Foundations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Oracle Generative AI Professional
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Oracle Generative AI Professional
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fundamentals-of-large-language-models" class="md-nav__link">
    <span class="md-ellipsis">
      Fundamentals of Large Language Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fundamentals of Large Language Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basics-of-llms" class="md-nav__link">
    <span class="md-ellipsis">
      Basics of LLMs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#llm-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      LLM Architectures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prompting-prompt-engineering" class="md-nav__link">
    <span class="md-ellipsis">
      Prompting &amp; Prompt Engineering
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prompting &amp; Prompt Engineering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decoding" class="md-nav__link">
    <span class="md-ellipsis">
      Decoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hallucination" class="md-nav__link">
    <span class="md-ellipsis">
      Hallucination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#llm-applications" class="md-nav__link">
    <span class="md-ellipsis">
      LLM Applications
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oci-generative-services" class="md-nav__link">
    <span class="md-ellipsis">
      OCI Generative Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OCI Generative Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chat-models" class="md-nav__link">
    <span class="md-ellipsis">
      Chat Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chat-model-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Chat Model Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generative-ai-inference-api" class="md-nav__link">
    <span class="md-ellipsis">
      Generative AI Inference API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedding-models" class="md-nav__link">
    <span class="md-ellipsis">
      Embedding Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt-engineering" class="md-nav__link">
    <span class="md-ellipsis">
      Prompt Engineering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customizing-llms-with-data" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing LLMs with Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fine-tuning-and-inference-in-oci-gen-ai" class="md-nav__link">
    <span class="md-ellipsis">
      Fine Tuning and Inference in OCI Gen AI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dedicated-ai-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      Dedicated AI Clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fine-tuning-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Fine-Tuning Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oci-ai-generative-security" class="md-nav__link">
    <span class="md-ellipsis">
      OCI AI Generative Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#-the-main-advantage-of-using-few-shot-model-prompting-to-customize-a-large-language-model-llm-is-its-ability-to-adapt-the-model-quickly-and-effectively-to-new-tasks-or-domains-with-only-a-small-amount-of-training-data-instead-of-retraining-the-entire-model-from-scratch-which-can-be-time-consuming-and-resource-intensive-few-shot-prompting-leverages-the-models-pre-existing-knowledge" class="md-nav__link">
    <span class="md-ellipsis">
      - The main advantage of using few-shot model prompting to customize a Large Language Model (LLM) is its ability to adapt the model quickly and effectively to new tasks or domains with only a small amount of training data. Instead of retraining the entire model from scratch, which can be time-consuming and resource-intensive, few-shot prompting leverages the model's pre-existing knowledge.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rag-using-genai-service-oracle-23-ai-vector-search" class="md-nav__link">
    <span class="md-ellipsis">
      RAG using GenAI Service &amp; Oracle 23 ai Vector Search
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RAG using GenAI Service &amp; Oracle 23 ai Vector Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#oci-genai-integrations" class="md-nav__link">
    <span class="md-ellipsis">
      OCI GenAI Integrations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rag" class="md-nav__link">
    <span class="md-ellipsis">
      RAG
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conversational-rag" class="md-nav__link">
    <span class="md-ellipsis">
      Conversational RAG
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chatbot-using-generative-ai-agent-service" class="md-nav__link">
    <span class="md-ellipsis">
      Chatbot using Generative AI Agent Service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oracle-generative-ai-agent-service" class="md-nav__link">
    <span class="md-ellipsis">
      Oracle Generative AI Agent Service
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Oracle Generative AI Agent Service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chatbot-using-object-store" class="md-nav__link">
    <span class="md-ellipsis">
      Chatbot using Object Store
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chatbot-using-oracle-23ai" class="md-nav__link">
    <span class="md-ellipsis">
      Chatbot using Oracle 23ai
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Notes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-question-study-guide" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Question Study Guide:
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fundamentals-of-large-language-models" class="md-nav__link">
    <span class="md-ellipsis">
      Fundamentals of Large Language Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fundamentals of Large Language Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basics-of-llms" class="md-nav__link">
    <span class="md-ellipsis">
      Basics of LLMs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#llm-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      LLM Architectures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prompting-prompt-engineering" class="md-nav__link">
    <span class="md-ellipsis">
      Prompting &amp; Prompt Engineering
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prompting &amp; Prompt Engineering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decoding" class="md-nav__link">
    <span class="md-ellipsis">
      Decoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hallucination" class="md-nav__link">
    <span class="md-ellipsis">
      Hallucination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#llm-applications" class="md-nav__link">
    <span class="md-ellipsis">
      LLM Applications
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oci-generative-services" class="md-nav__link">
    <span class="md-ellipsis">
      OCI Generative Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OCI Generative Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chat-models" class="md-nav__link">
    <span class="md-ellipsis">
      Chat Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chat-model-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Chat Model Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generative-ai-inference-api" class="md-nav__link">
    <span class="md-ellipsis">
      Generative AI Inference API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedding-models" class="md-nav__link">
    <span class="md-ellipsis">
      Embedding Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt-engineering" class="md-nav__link">
    <span class="md-ellipsis">
      Prompt Engineering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customizing-llms-with-data" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing LLMs with Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fine-tuning-and-inference-in-oci-gen-ai" class="md-nav__link">
    <span class="md-ellipsis">
      Fine Tuning and Inference in OCI Gen AI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dedicated-ai-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      Dedicated AI Clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fine-tuning-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Fine-Tuning Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oci-ai-generative-security" class="md-nav__link">
    <span class="md-ellipsis">
      OCI AI Generative Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#-the-main-advantage-of-using-few-shot-model-prompting-to-customize-a-large-language-model-llm-is-its-ability-to-adapt-the-model-quickly-and-effectively-to-new-tasks-or-domains-with-only-a-small-amount-of-training-data-instead-of-retraining-the-entire-model-from-scratch-which-can-be-time-consuming-and-resource-intensive-few-shot-prompting-leverages-the-models-pre-existing-knowledge" class="md-nav__link">
    <span class="md-ellipsis">
      - The main advantage of using few-shot model prompting to customize a Large Language Model (LLM) is its ability to adapt the model quickly and effectively to new tasks or domains with only a small amount of training data. Instead of retraining the entire model from scratch, which can be time-consuming and resource-intensive, few-shot prompting leverages the model's pre-existing knowledge.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rag-using-genai-service-oracle-23-ai-vector-search" class="md-nav__link">
    <span class="md-ellipsis">
      RAG using GenAI Service &amp; Oracle 23 ai Vector Search
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RAG using GenAI Service &amp; Oracle 23 ai Vector Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#oci-genai-integrations" class="md-nav__link">
    <span class="md-ellipsis">
      OCI GenAI Integrations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rag" class="md-nav__link">
    <span class="md-ellipsis">
      RAG
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conversational-rag" class="md-nav__link">
    <span class="md-ellipsis">
      Conversational RAG
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chatbot-using-generative-ai-agent-service" class="md-nav__link">
    <span class="md-ellipsis">
      Chatbot using Generative AI Agent Service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oracle-generative-ai-agent-service" class="md-nav__link">
    <span class="md-ellipsis">
      Oracle Generative AI Agent Service
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Oracle Generative AI Agent Service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chatbot-using-object-store" class="md-nav__link">
    <span class="md-ellipsis">
      Chatbot using Object Store
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chatbot-using-oracle-23ai" class="md-nav__link">
    <span class="md-ellipsis">
      Chatbot using Oracle 23ai
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Notes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-question-study-guide" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Question Study Guide:
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Oracle Generative AI Professional</h1>

<h2 id="fundamentals-of-large-language-models"><mark><strong>Fundamentals of Large Language Models</strong></mark></h2>
<h3 id="basics-of-llms">Basics of LLMs</h3>
<ul>
<li><code>Language Model</code> = probablilstic model of text. Large LMs just refers to the number of parameters (large)</li>
<li><code>Decoding</code> = Term for generating text from an LLM</li>
<li><code>Prompting</code> = Affects the distribution of the LLMs vocabulary but it does not change the models parameters</li>
<li><code>Training</code> = Affects the distribution and changes the models parameters. </li>
</ul>
<h3 id="llm-architectures">LLM Architectures</h3>
<ol>
<li><mark><strong>Encoders</strong></mark> they are used for <code>embedding</code></li>
<li><mark><strong>Decoders</strong></mark> they are used for <code>text generation</code></li>
<li>Capabilities can be embedding or text generation </li>
<li>All models are built using the <code>Transformer</code> Architecture. </li>
<li><code>Embedding</code> = convert a sequence of word into a vector or sequence of vectors. Basically, embedding converts the text into a numerical representation of the text with meaning.</li>
<li>
<p><code>Generation</code> = Generate text based on a sequence of input words. </p>
</li>
<li>
<p>Encoders and Decoders can come in all sizes. Sizes is defined by the number of trainable parameters it has. <code>Decoder models are larger than encoders</code> but you can make encoders big but its not needed. </p>
</li>
<li>
<p><code>Encoders</code>: Semantic search is the primary use where you can store an input snippet into an index and then use a group of documents to find the one that is most similair </p>
</li>
<li>
<p><code>Decoders</code>: take a sequence of tokens and generate the next word in the sequence. They only produce a single token at a time. </p>
</li>
<li>
<p><code>Encoder-Decoder</code>: encodes a sequence of words and uses the encoded to output the next word. Used for machine translation. </p>
</li>
</ol>
<h2 id="prompting-prompt-engineering">Prompting &amp; Prompt Engineering</h2>
<ul>
<li>LLMs typically only involve decoder only models</li>
</ul>
<p><mark><strong>Prompting</strong></mark></p>
<ul>
<li>
<p>Altering the content or structure of the input that you pass to the model: text provided to an LLM as input, sometimes containing instructions and/or examples.</p>
</li>
<li>
<p>Decoders have pre-training which is where they are trained on a large set of input</p>
</li>
</ul>
<p><mark><strong>Prompt Engineering</strong></mark>
- The process of iteratively refining a prompt for the purpose of eliciting a particular style of response. </p>
<ol>
<li>
<p><em>In-context learning</em>: prompting an LLM with instructions and or demonstrations of the task its meant to complete. </p>
</li>
<li>
<p><em>k-shot prompting</em>: explicitly providing k examples of the intended task in the prompt.</p>
</li>
<li>
<p>0-shot prompting means not providing any examples</p>
</li>
<li>
<p><em>Chain-of-Thought prompting</em>: prompt the LLM to emit intermediate reasoning steps </p>
</li>
<li>
<p><em>Least-to-Most prompting</em>: prompt the LLM to decompose the problem and solve, easy first then hardest. </p>
</li>
<li>
<p><em>Step-Back prompting</em>: prompt the LLM to identify high-level concepts pertinent to a specific task.</p>
</li>
</ol>
<p><code>Issues with Prompting</code>:
1. <em>Prompt Injection</em>: deliberately provide an LLM with input that attempts to cause it to ignore instructions, cause harm, or behave contrary to deployment expectations. </p>
<ol>
<li><em>Memorization</em>: after answering, repeat the original prompt (leaked prompt) or data from a previous prompt answer</li>
</ol>
<p><mark><strong>Training</strong></mark>:
- prompting alone may be inappropriate when: training data exists or domain adaption is required because small changes in the prompt can lead to huge changes in the probablity of the next output. </p>
<ul>
<li>
<p><em>Domain-Adaption</em>: adapting a model through training to enhance its performance outside of the domain/subject area it was trained on. </p>
</li>
<li>
<p>Training is the process of giving a model an input then having the model guess the output and then based on the answer alter the parameters of the model so next time it generates something closer to the answer. </p>
</li>
</ul>
<p>Training Styles:
1. <em>Fine-Tuning</em>: take a pre-training model and train the model on custom data but its very expensive 
2. <em>Param Efficient Fine Tuning</em>: Isolate a small set of the models parameters to train - Cheaper (LORA)
3. <em>Soft Prompting</em>: Adding parameters to the prompt or specialized words in the prompt - learning and only uses a few parameters
4. <em>Pre-Training</em>: changes all parameters but it uses unlabeled data </p>
<ul>
<li>Pre-training is more expensive then fine tuning</li>
</ul>
<h3 id="decoding">Decoding</h3>
<ul>
<li>
<p>The process of generating text with an LLM</p>
</li>
<li>
<p>It happens 1 word at a time and it is iterative </p>
</li>
<li>
<p>Word is appended to the input and the new revised input is fed into the model to be decoded for the next word. </p>
</li>
</ul>
<p>Types of Decoding:</p>
<ol>
<li>
<p><em>Greedy Decoding</em>: pick the highest probability word at each step. </p>
</li>
<li>
<p><em>Non-Deterministic Decoding</em>: Pick randomly among high probability candidates at each step. <strong>Tempature</strong> = controls the sharpness or smoothness of this probability distribution. A low temperature value results in a sharper distribution, meaning that the model is more confident in its predictions and tends to select the most likely word with higher probability. Conversely, a higher temperature value smooths out the distribution, making it more likely for lower probability words to be chosen, leading to more diverse and varied output.</p>
</li>
<li>When temperature is decreased, the distribution is more peaked around the most likely word. = Greedy Decoding</li>
<li>When temperature is increased, the distribution is flattened over all words. </li>
<li>
<p>But the probability in terms of the highest and lowest rated ones will always state that way. == Ordering of words is unaffected by temperature.</p>
</li>
<li>
<p><em>Nucleus Sampling Decoding</em>: Precise what portion of the distrubtion words you can sample from</p>
</li>
<li>
<p><em>Beam Search</em>: Multiple similar sequences simultaneously and it is not greedy but outputs sequences with higher probability than greedy decoding. </p>
</li>
</ol>
<h3 id="hallucination">Hallucination</h3>
<ul>
<li>generated text that is non-factual and or ungrounded. </li>
</ul>
<p>Reducing Hallucinations (no way to eliminate):
- <em>Grounded</em>: generated text is grounded in a document if the document supports the text. Attribution/Grounding </p>
<h3 id="llm-applications">LLM Applications</h3>
<ol>
<li><mark><strong>Retrieval Augmented Generation</strong></mark> (RAG): a system where input is turned into a query that has access to support documents which will generate a correct answer and this can reduce hallucination. </li>
<li>
<p>Non-parametric way of improving the model because you just add more documents but not the model itself</p>
</li>
<li>
<p><mark><strong>Code Models</strong></mark>: Are LLMs training on code and comments instead of written language </p>
</li>
<li>
<p><mark><strong>Mult-Modal Models</strong></mark>: Are trained on multiple modalities like languages, images, etc. </p>
</li>
<li>
<p><mark><strong>Language Agents</strong></mark>: Models that are intended for sequential decision making scenarios like playing chess and take actions iteratively in response to their enviornment. </p>
</li>
<li>ReAct: Prompt the model for thoughts, then acts, and observes the results </li>
<li>Toolformer: strings are replaced with calls to tools</li>
<li>Bootstrapped reasoningL emit rationalization of intermediate steps</li>
</ol>
<hr />
<h2 id="oci-generative-services"><mark><strong>OCI Generative Services</strong></mark></h2>
<h3 id="chat-models">Chat Models</h3>
<ul>
<li><em>Tokens</em>: Language models understand tokens instead of characters and tokens can be a part of a word, an entire word or punctuation. </li>
<li>For example a sentence with 10 words can have 15 tokens </li>
</ul>
<p>Pretrained Chat Models</p>
<ol>
<li>
<p><em>command r-plus</em>: used for q&amp;a, info retrieval and sentiment analysis</p>
</li>
<li>
<p><em>command r-16k</em>: This is the smaller and more fast version of r and it used when speed and cost is important. </p>
</li>
<li>
<p><em>llama-3.1-405b/70b instruct</em>: largest publically available LLM</p>
</li>
</ol>
<h3 id="chat-model-parameters">Chat Model Parameters</h3>
<ol>
<li>
<p><em>Maximum Output Tokens</em>: The max number of tokens model generates per response. </p>
</li>
<li>
<p><em>Premble Override</em>: Initial guideline message that can change the models overall chat behaviour and conversation style. </p>
</li>
<li>
<p><em>Temperature</em>: Controls the randomness of the output. To generate the same output for a prompt you use 0 (highest probability answer). Lower values are more correct and used for Q&amp;A and higher values are more random and used for creative. </p>
</li>
<li>
<p><em>Top k</em>: Top K tells the model to pick the next token from the top 'k' tokens in the list sorted by probability</p>
</li>
<li>
<p><em>Top p</em>: Pick top tokens based on the sum of their probabilities (finds the combination of p tokens that yields the highes probabililty)</p>
</li>
<li>
<p><em>Frequency Penalty</em>: Used to get rid of repetition in your outputs. Frequency Penalty penalizes tokens that have already appeared in the preeceding text. </p>
</li>
<li>
<p><em>Presence Penalty</em>: Also used to get rid of repetition by applying the penalty regardless of frequency so if the token has appeared once it will be penalized. </p>
</li>
</ol>
<h3 id="generative-ai-inference-api">Generative AI Inference API</h3>
<ul>
<li>
<p>Within the Oracle cloud if you go to the Generative AI module you can actually copy the code that is developed from the playground and then take that python code and run it in a Jupyter notebook.</p>
</li>
<li>
<p>inference API is the basically the endpoint you use within the Python script </p>
</li>
<li>
<p>To setup the config file within the Oracle cloud you go to My Profile and within your details you will see <code>API keys</code>. When you create an API key make sure you download the private key file as well as adding the config file</p>
</li>
</ul>
<h3 id="embedding-models"><mark><strong>Embedding Models</strong></mark></h3>
<ul>
<li>
<p>Translation is a sequence to sequence task</p>
</li>
<li>
<p><em>Word Embeddings</em>: Capture properties of the word. For example, the word is an animal so some properties could be size and age. But actual embeddings represent more properties than just two </p>
</li>
<li>
<p><em>Semantic Similarity</em>: Cosine and Dot product similairity can be used to compute <mark><strong>numerical similarility</strong></mark></p>
</li>
<li>
<p>embeddings that are numberically similair are also semantically similair</p>
</li>
<li>
<p><em>Sentence Embeddings</em>: Associates every sentence with a vector of numbers. </p>
</li>
</ul>
<p>Embeddings use case:</p>
<ul>
<li><em>Retrieval Augmented Generation (RAG)</em>: take a large document and generate the embeddings of each paragraph and put it into a vector database to allow you to get semantic search. </li>
</ul>
<p>Embedding Models in GenAI</p>
<ol>
<li><em>cohere.embed-english</em></li>
<li><em>cohere.ember-english-light</em></li>
<li><em>cohere.emberd.multilingual</em>
   -use cases: semantic search, text classification, and text clustering </li>
<li>
<p>1024-dimensional vector for eaxch embedding and max 512 tokens. The light version only uses a 384 dimensionsal vector.</p>
</li>
<li>
<p>As you compress the embeddings to lower dimensions the information retained is less </p>
</li>
</ol>
<h3 id="prompt-engineering">Prompt Engineering</h3>
<ul>
<li>
<p>LLMs are next word predictors they attempt to produce the next series of words that are most likely to follow from the previous text. </p>
</li>
<li>
<p><em>Reinforcement Learning from Human Feedback (RLHF)</em> is used to fine-tune LLMs to follow a broad class of written instructions.</p>
</li>
</ul>
<p>Prompt Formats:</p>
<ul>
<li>large language models are trained on a specific prompt format. </li>
<li>
<p><em>Llama2 Prompt formatting</em>: They use a beginning and end [INST] tag. Instruction tags</p>
</li>
<li>
<p><em>Zero Shot Chain-of-Thought</em>: apply chain of thought but you don't provide example so you just ask it a phrase like lets think step by step as opposed to chain of thought were you provide it the examples for reasoning. </p>
</li>
</ul>
<h3 id="customizing-llms-with-data">Customizing LLMs with Data</h3>
<p>Training LLMs from scratch Cons:</p>
<ol>
<li><em>Cost</em>: Very expensive to train </li>
<li><em>Data</em>: A lot of data is needed and you need to annotated data (labelled)</li>
<li><em>Expertise</em>: Pretraining is hard and you need to understand what model performance means</li>
</ol>
<p>3 Options to Customize LLMs:</p>
<ol>
<li><em>In-context Learning/Few Shot Prompting</em></li>
<li><em>Chain of Thought Prompting</em>: Breaking a model down into smaller chunks and give reasoning.</li>
<li>
<p>Limitation of in context learning: <mark><strong>Model Context length</strong></mark> (which is the number of tokens it can process)</p>
</li>
<li>
<p><em>Fine-tuning a pretrained model</em>: optimizing a model on a smaller domain-specific dataset</p>
</li>
<li>Benefits: a) Improve the model performance on specific tasks</li>
<li>
<p>b) Improve the model efficiency - reduce the number of tokens needed for your model to perform well on your tasks. </p>
</li>
<li>
<p><em>Retrieval Augmented Generation (RAG)</em>: language model is able to query enterprise knowledge bases and its grounded. These do not require Fine Tuning.</p>
</li>
<li>
<p>Few shot prompting its simple and no training cost but the con is it adds latency to each model. Fine Tuning is used when the LLM does not perform well on a particular task and its more efficient and better performance but the con is it requires a labelled dataset (expensive and time consuming.) RAG is used when the data changes rapidly and it accesses the latest data and grounds results but its complez to setup. </p>
</li>
<li>
<p>Look at <code>LLM Optimization</code> vs <code>Context Optimization</code>:</p>
</li>
<li>context is what the model needs to know and optimization is how the model needs to act. </li>
<li>Always start with prompt engineering and then if its a context issue you do RAG but if its an optimization issue then you do fine tuning. </li>
</ol>
<h3 id="fine-tuning-and-inference-in-oci-gen-ai">Fine Tuning and Inference in OCI Gen AI</h3>
<ul>
<li>
<p>Inference is using a trained ML to make predictions or decisions based on new input data.</p>
</li>
<li>
<p><em>Custom Model</em> is on that you create by using a <em>pretrained model</em> as a base and using your own data set to fine-tune the model. </p>
</li>
</ul>
<p>Fine-Tuning Workflow: 
   1. Create a Dedicated AI Cluster for Fine Tuning
   2. Gather training data
   3. Kickstart fine tuning
   4. Fine-tuned (custom) Model is created</p>
<ul>
<li><em>Model Endpoint</em>: is a designated point on an AI Cluster where a LLM can accept user request and send back responses </li>
</ul>
<p>Inference Worflow:
   1. Create Dedicated AI Cluster for Hosting
   2. Create Endpoint
   3. Serve the Model</p>
<p><mark><strong>T-Few Fine Tuning</strong></mark>
- regular fine-tuning involves updating the weights of all layers in the model which takes longer training time and has more cost.
- T-Few only updates a fraction of the models weights. (Few-Shot Parameter Efficient Fine Tuning = PEFT) and this reduce the training time and the cost. ~0.01% of the baselines model size</p>
<p>Reducing Inference Costs:
- usually inference is expensive 
- Each hosting cluster can have 1 base model endpoint and N Fine-tuned custom models. So they share the same GPU resources. 
- GPU memory is limited so if you switch between models it can cause alot of overhead since you have to reload the full GPU memory. 
- <code>Parameter Sharing</code> reduces the total amount of memory and has minimal overheard. </p>
<h3 id="dedicated-ai-clusters">Dedicated AI Clusters</h3>
<ul>
<li>
<p>A single-tenant deployment where the GPU model is used to only host your custom models and since the endpoint is not shared the throughput is consistent</p>
</li>
<li>
<p>2 types:</p>
</li>
<li><em>Fine-Tuning</em></li>
<li><em>Hositng</em></li>
</ul>
<p>Dedicated AI Clusters Sizing &amp; Pricing:</p>
<p>Different Cluster Unit Types:
1. <em>Large Cohere Dedicated</em>: You can do both fine-tuning and hosting but its limited to the cohere R command family.</p>
<ol>
<li>
<p><em>Small Cohere Dedicated</em>: Same as above but a smaller count</p>
</li>
<li>
<p><em>Embed Cohere Dedicated</em>: Used for embedding but no fine-tuning but you can still host. </p>
</li>
<li>
<p><em>Large Meta Dedicated</em>: Used for both finetuning and hosting but uses Meta Llama models. </p>
</li>
</ol>
<p>Unit Sizing:
   1. Cohere Command R+ - Does not support Fine tuning and needs 2 units of large cohere dedicated units for hosting.</p>
<ol>
<li>
<p>Cohere Command R - Supports fine tuning and needs 8 units of small cohere dedicated and for hosting it needs 1 unit of small cohere dedicated.</p>
</li>
<li>
<p>Meta Llmama - It neeeds 4 units of large meta dedicated for fine tuning and 1 unit large meta for hosting. </p>
</li>
<li>
<p>Cohere English Embed - doesnt support fine tuning and needs 1 unit of embed dedicated for hosting. </p>
</li>
</ol>
<p>Pricing Example:
   - Cohere Command R 08-2024
   - Min hosting commitment = 744unit-hours/cluster
   - Fine tuning commitment = 1 unit-hour/fine tuning
   - So for hosting you have to pay for the month but fine tuning is on a per hour basis</p>
<h3 id="fine-tuning-configuration">Fine-Tuning Configuration</h3>
<p>2 Training Methods:
  - <em>T-Few</em>
  - <em>LoRA</em>: Low rank adaptation 
  - Both of them are PEFT (parameter efficient fine tuning) ie. they fine tune only a subset parameters.</p>
<p>Hyperparameters:
   1. <em>Total Training Epochs</em>: the number of times the model is trained using the entire dataset. </p>
<ol>
<li>
<p><em>Total Batch Size</em>: number of samples processed before updating the model parameters. Large batches speed up learning</p>
</li>
<li>
<p><em>Learning Rate</em>: How fast the model adjusts it settings. </p>
</li>
<li>
<p><em>Early Stopping Threshold</em>: When the machine should stop training if its not improving fast enough </p>
</li>
<li>
<p><em>Early Stopping Patience</em>: How long the machine waits before its not learning.</p>
</li>
<li>
<p><em>Log model metrics interval in steps</em>: Determines how frequently to log model metrics. </p>
</li>
</ol>
<p>Evaluating Fine-Tuning:</p>
<ol>
<li>
<p><em>Accuracy</em>: Measures whether the generated tokens match the annotated tokens (labelled output)</p>
</li>
<li>
<p><em>Loss</em>: Tells you how many predictions the model got wrong. Loss decreases as the model icreases. A loss of 0 means all output was perfect. If the context is simialir then loss is low.
 -<strong>Loss is the preferred metric because Gen AI doesn't always know what is right</strong></p>
</li>
<li>
<p>Model training set needs to keys: the prompt and the completion.</p>
</li>
</ol>
<h3 id="oci-ai-generative-security">OCI AI Generative Security</h3>
<ul>
<li>
<p>GPUs allocated for a customers gen AI task are isolated from other GPUs</p>
</li>
<li>
<p>dedicated GPU cluster only handles your base and fine-tuned models within your set of GPUs so there is data isolation.</p>
</li>
<li>
<p>Customer data is restricted within the customers tenancy so one customers data cant be seen by another customer. </p>
</li>
<li>
<p>Also uses <code>OCI IAM</code> for authentication and authorization. </p>
</li>
<li>
<p><code>OCI Key Management</code> is used for secrets.</p>
</li>
<li>
<p><code>OCI Object Storage buckets</code> for customer fine tuned models.</p>
</li>
</ul>
<p>Question about periods as a stop sequence: The model stops generating text once it reaches the end of the first sentence, even if the token limit is much higher.
Explanation: Stop sequences, in the context of text generation, are special tokens or symbols used to signal the end of the generated text. These sequences serve as markers for the model to halt its generation process. Common stop sequences include punctuation marks such as periods (.), question marks (?), and exclamation marks (!), as they typically denote the end of sentences in natural language.</p>
<h2 id="-the-main-advantage-of-using-few-shot-model-prompting-to-customize-a-large-language-model-llm-is-its-ability-to-adapt-the-model-quickly-and-effectively-to-new-tasks-or-domains-with-only-a-small-amount-of-training-data-instead-of-retraining-the-entire-model-from-scratch-which-can-be-time-consuming-and-resource-intensive-few-shot-prompting-leverages-the-models-pre-existing-knowledge">- The main advantage of using few-shot model prompting to customize a Large Language Model (LLM) is its ability to adapt the model quickly and effectively to new tasks or domains with only a small amount of training data. Instead of retraining the entire model from scratch, which can be time-consuming and resource-intensive, few-shot prompting leverages the model's pre-existing knowledge.</h2>
<h2 id="rag-using-genai-service-oracle-23-ai-vector-search"><mark><strong>RAG using GenAI Service &amp; Oracle 23 ai Vector Search</strong></mark></h2>
<h3 id="oci-genai-integrations">OCI GenAI Integrations</h3>
<ul>
<li>LangChain provides a wrapper class for using OCI GenAI with LangChain</li>
<li><em>LangChain</em>: is a framework for developing apps powered by language models. </li>
</ul>
<p>To create a chatbot you need:
1. LLM
2. Prompts
3. Memory
4. Chains
5. Vector Stores
6. Document Loaders </p>
<p>2 Main Tyes of LangChain Models:</p>
<ol>
<li><code>LLMs</code>: Pure text completion models</li>
<li><code>Chatbots</code>: tuned specific for having conversations. </li>
<li>the core element of a language model is the model</li>
</ol>
<p>LangChain Prompt Templates:
- LangChain prompts can be created using 2 types of langchain prompt templates</p>
<ol>
<li><em>String Prompt Template</em>: created from a formatted python string and can have any number of variables and the output is a string. </li>
<li>
<p>Used for Generation Models</p>
</li>
<li>
<p><em>Chat Prompt Template</em>: this type of prompt template supports a list of messages and is used for Chat Models. </p>
</li>
</ol>
<p>LangChain Chains:
- provides frameworks for creating chains of components including LLMs and other types. </p>
<p>2 Ways to create Chains:
1. <em>LCEL</em>: this creates chains declaratively (LangChain Expression Language). This is preferred. </p>
<ol>
<li>
<p><em>Legacy</em>: creates chains using python classes like LLM Chain</p>
</li>
<li>
<p>Using Chains is how you link between getting user input to generating the response </p>
</li>
</ol>
<p>LangChain Memory
- ability to store information about past interactions = <code>memory</code>
- Chain interacts with the memory to pass the information along with the question. 
-Oracle 23ai can be used a vector store and LangChain can use these vector stores. </p>
<ul>
<li><em>Oracle AI Vector Search</em> offers vector utilities to automatically generate vector embeddings from unstructure data</li>
<li><em>Oracle Select AI</em> can generate sql from natural language. </li>
</ul>
<h3 id="rag">RAG</h3>
<ul>
<li>Mitigate bias in training data because its getting information from an external data source. </li>
<li>Can overcome model limitations by feeding in only the top results from the document instead of the full document</li>
<li>handle queries without new training.</li>
</ul>
<p>RAG Pipeline:
1. <em>Ingestion</em>: Where you have documents that get broken into chunks and then they are turned into embeddings and then indexed into a database. 
   - <code>Document Loaders</code> are reponsible for loading documents from a variety of sources
   - <code>Chunking</code> - Text Splitters take a document and split it into chunks:</p>
<p>a. <em>Chunk Size</em> - Many LLMs have max input size constraints so splitting allows us to process documents that would otherwise exceed the limits. But if chunks are too small they wont be semantically useful AND if its too big then it wont be semantically specific. </p>
<ul>
<li>Embeddings capture semantic relationship</li>
<li>Embeddings of similair words are close in the multi-dimensional space</li>
<li>Vector embeddings can be generated outside Oracle 23ai db by using 3rd party embedding models</li>
<li>Vector embeddings generated inside oracle 23ai use <mark><strong>ONNX</strong></mark> format</li>
</ul>
<p>b. <em>Chunk Overlap</em> - is the number of overlapping characters between adjacent chunks. This helps preserve context between chunks. </p>
<p>c. <em>Splitting Method</em> - split block of text based on seperators like new line. It tries to retain paragraphs and sentences. </p>
<ol>
<li><em>Retrieval</em>: There is a query which then gets searched within the index database and then the system selects the top K most relevant results. </li>
<li>A users natural language question is encoded as a vector and sent to <strong>AI Vector Search</strong> </li>
<li>Vector search uses dot product and cosine product (only cares about angle). </li>
<li>Less angle means more similarity</li>
<li><strong>Vector Indexes</strong> Are used for larger sets of data to speed up vector simialirty searches. Uses clustering, partioning, and neighbour graphs to group simialir vectors together. </li>
<li>
<p>AI Vector search supports HNSW and IVF</p>
</li>
<li>
<p><em>Generation</em>: Using the top K results a response to the user is generated. </p>
</li>
</ol>
<h3 id="conversational-rag">Conversational RAG</h3>
<ul>
<li>RAGs and the Chatbot both need to be conversational.</li>
<li>
<p>Dependence on memory which holds prior chat history to be inserted to the prompt as additional context. </p>
</li>
<li>
<p>In the LangChain framework, memory serves as a dynamic repository for retaining and managing information throughout the system's operation. It allows the framework to maintain state and context, enabling chains to access, reference, and utilize past interactions and information in their decision-making processes.</p>
</li>
<li>
<p>Large Language Models (LLMs) without Retrieval Augmented Generation (RAG) primarily rely on internal knowledge learned during pretraining on a large text corpus. These models are trained on vast amounts of text data, which enables them to learn complex patterns, structures, and relationships within language.</p>
</li>
</ul>
<hr />
<h2 id="chatbot-using-generative-ai-agent-service"><mark><strong>Chatbot using Generative AI Agent Service</strong></mark></h2>
<h2 id="oracle-generative-ai-agent-service">Oracle Generative AI Agent Service</h2>
<ul>
<li>Agents Fully managed service that combines LLM with an intelligent retrieval answers from a knowledge base</li>
</ul>
<p>Architecture:
1. <em>Interface</em>: This is the starting point and this is where the user interacts with the AI agent like a web app or a chatbox</p>
<ol>
<li>
<p><em>Inputs fed into LLM</em>: Can be <code>Short/Long Term Memory</code>, <code>Tools</code>, and then <code>prompts</code> and there is a knowledge database</p>
</li>
<li>
<p><em>Response Generation</em></p>
</li>
</ol>
<p>Agent Concepts:</p>
<ul>
<li>
<p><em>Generative AI Model</em>: This is the LLM trained on large data </p>
</li>
<li>
<p><em>Agent</em>: Autonomous system based off the LLM that understands and generates human like text with high answerability and groundness </p>
</li>
<li>
<p><em>Knowledge Base</em>: Agent connexts to a knowledge base which is vector based</p>
</li>
<li>
<p><em>Data Source</em>: Data source provide connection to the data store</p>
</li>
<li>
<p><em>Data Ingestion</em>: extract data from data source and convert it to a structure format and then store in a knowledege base. </p>
</li>
<li>
<p><em>Session</em>: A series of exchanges where the user sends queries or prompts and the agent responds with relevant information </p>
</li>
<li>
<p><em>Agent Endpoint</em>: Specific points of access in a network that agents use to interact with other systems or services </p>
</li>
<li>
<p><em>Trace</em>: Tracks and display the conversation history both the original and generated response </p>
</li>
<li>
<p><em>Citation</em>: Source of information that the agent uses to respond (ie. document id, page number, etc)</p>
</li>
<li>
<p><em>Content Moderation</em>: Feature to help detect or filter out certain toxic, violent or abusive phrases from the generated responses and from prompts. </p>
</li>
</ul>
<p>Object Storage Guideline:
- Data sources: data for gen AI agents must be uploaded as files to an object storage bucket 
- Only one bucket can be allowed per data source
- Only pdf and txt files are supported no larger than 100mb
- PDF files can have images and charts 
- No need to format charts since they are already 2D
- You can also use reference tables
- Hyperlinks are also shown as clickable links in the chat reponses</p>
<p>Oracle Database Guidelines: 
- Gen AI Agents dont manage databases so they have to be created ahead of time and within the database you need the following:
1. DOCID
2. Body - is the actual content that you want the agent to search 
3. Vector</p>
<p>Optional:
4. CHUNKID
5. URL
6. Title
7. Page_Numbers </p>
<ul>
<li>The embedding model used in the query has to be the same as the embedding model that was used for the database. </li>
</ul>
<h3 id="chatbot-using-object-store">Chatbot using Object Store</h3>
<p>Creating Agents process:
1. Create the knowledge Base
   - Data Storage type can be:
      a. <em>Object Storage</em>
      b. <em>OCI OpenSearch</em>
      c. <em>Oracle AI Vector Search</em></p>
<ul>
<li>lexical search is key word</li>
<li>semantic search is based on context. </li>
<li>When restarting the job it will ignore previously read in storage and will only focus on the new content.</li>
<li>You can only delete a knowledge base if it is not being used by an agent. </li>
<li>
<p>Data sources can be deleted at any time.</p>
</li>
<li>
<p>Create the Agent</p>
</li>
<li>
<p>Within the endpoints option is where you create the endpoint to the knowledge base. </p>
</li>
<li>
<p>Test the agent</p>
</li>
</ul>
<h3 id="chatbot-using-oracle-23ai">Chatbot using Oracle 23ai</h3>
<ul>
<li>
<p>Database Tools is used to create a connection to a database and then you can use this tool with the agent that you set up. </p>
</li>
<li>
<p>When you restart a previously run ingestion job, the pipeline detects files that were successfully ingested earlier and skips them. It only ingests files that failed previously and have since been updated.</p>
</li>
<li>
<p>3 is the number of endpoints you can create for each agent.</p>
</li>
<li>
<p>If your data isn't available yet, create an empty folder for the data source and populate it later. This way, you can ingest data into the source after the folder is populated.</p>
</li>
</ul>
<hr />
<h2 id="additional-notes">Additional Notes</h2>
<ul>
<li>OCI Generative AI Service = ~40% of the exam</li>
<li>Increasing temperature flattens the distribution allowing for more varied words. </li>
</ul>
<hr />
<h2 id="sample-question-study-guide">Sample Question Study Guide:</h2>
<ol>
<li>
<p>The OCI Generative AI Agents service retains customer-provided queries and retrieved context used for chatting with Large Language Models (LLMs) during the user's session. However, this data isn't stored beyond the session. Also, the service doesn't use customer chat data or knowledge base data for model training. = Permanently Deleted </p>
</li>
<li>
<p>When a model is deprecated, it remains available for use temporarily. The company should plan to migrate to another model before the deprecation period ends and the model is retired.</p>
</li>
<li>
<p>The OnDemandServingMode is used to configure the Generative AI model to handle requests on-demand, which is suitable for use cases where requests are sporadic or less frequent.</p>
</li>
<li>
<p>Cosine distance (or cosine similarity) measures the angle between two vectors in a high-dimensional space. A cosine distance of 0 (which corresponds to a cosine similarity of 1) means that the vectors are identical in direction, indicating strong semantic similarity between the two embeddings. This is crucial in vector search and retrieval systems, where similar meanings are identified based on direction rather than magnitude.</p>
</li>
<li>
<p>Multi-modal parsing is used to parse and include information from charts and graphs in the documents.</p>
</li>
<li>
<p>In Retrieval-Augmented Generation (RAG), Groundedness ensures that the model s response is factually correct and traceable to retrieved sources, minimizing hallucinations. Answer Relevance, on the other hand, evaluates how well the response aligns with the user s query, ensuring that the retrieved and generated content is contextually appropriate rather than just factually correct. Both are essential for high-quality AI-generated responses.</p>
</li>
<li>
<p>The endpoint variable stores the URL where requests to Oracle's Generative AI inference service are sent. This endpoint acts as the gateway to communicate with the AI model hosted in the specified region.</p>
</li>
<li>
<p>You can only delete knowledge bases that aren't used by agents. Before you delete a knowledge base, you must delete the data sources in that knowledge base and delete the agents using that data source. The delete action permanently deletes the knowledge base. This action can't be undone.</p>
</li>
<li>
<p>If a seed value is provided, the model generates deterministic responses (same input leads to the same output). However, if no seed is specified, the model behaves non-deterministically, producing diverse responses each time it processes the same input.</p>
</li>
<li>
<p>In Retrieval-Augmented Generation (RAG), the ranker evaluates and prioritizes the retrieved information to ensure that the most relevant and high-quality data is passed to the generator. It refines the initial retrieval results by scoring and reordering them based on relevance, improving the accuracy and contextual appropriateness of the generated response. This step is crucial for minimizing irrelevant or misleading outputs.</p>
</li>
<li>
<p>Fine-tuning helps improve model efficiency by adapting a pre-trained model to a specific task or domain, allowing it to generate more relevant responses with fewer input tokens. This reduces computational costs and inference time while maintaining or improving accuracy. By refining the model's knowledge, fine-tuning enhances performance without requiring excessive amounts of new training data.</p>
</li>
<li>
<p>The seed parameter ensures that the model generates deterministic outputs. By setting a fixed seed value (e.g., 123), the model will consistently produce the same response for the same input prompt and parameters. Leaving it as None allows the model to generate varied responses each time. temperature, frequency_penalty, and top_p control aspects of the text generation process, but they do not enforce consistency across multiple runs.</p>
</li>
<li>
<p>Oracle Database typically uses port 1521 for SQL*Net (also known as Oracle Net) connections, which facilitate communication between clients and the database server. Some configurations may also use port 1522 for additional services or failover. When setting up ingress rules in an OCI subnet security list, allowing traffic over ports 1521-1522 ensures that Oracle Database can be accessed properly within the Generative AI Agents environment.</p>
</li>
<li>
<p>Retrieval-Augmented Generation (RAG) is a non-parametric approach because it retrieves relevant information from external data sources at inference time rather than relying solely on pre-trained parameters. This allows RAG to dynamically answer questions based on any corpus without requiring a separate fine-tuned model for each dataset.</p>
</li>
<li>
<p>The cohere.command-r-08-2024 model supports the T-Few and LoRA fine-tuning methods. NOT Vanilla.</p>
</li>
<li>
<p>For on-demand inferencing, the total number of billable characters is the sum of the prompt and response length.</p>
</li>
<li>
<p>In the LangChain framework, a chain typically interacts with memory at two specific points during a run. The first interaction occurs after user input but before chain execution begins. At this stage, the chain may access and retrieve relevant information or context stored in memory to inform its processing or decision-making process. The second interaction with memory occurs after the core logic of the chain has been executed but before generating the final output. At this stage, the chain may update or modify the memory based on the results of its processing, storing any relevant information or intermediate results for future reference or use.</p>
</li>
<li>
<p>Soft prompting involves learning a small set of continuous embeddings that guide the model's behavior without modifying its original parameters. Unlike traditional fine-tuning, soft prompts require no task-specific training of the full model and are efficient in adapting LLMs to different tasks with minimal computational overhead. This makes it ideal for scenarios where full fine-tuning is impractical but some level of customization is needed.</p>
</li>
<li>
<p>The totalTrainingSteps parameter is calculated as: totalTrainingSteps = (totalTrainingEpochs * size(trainingDataset)) / trainingBatchSize This formula determines the total number of training steps based on the number of epochs, the size of the training dataset, and the batch size.</p>
</li>
<li>
<p>A hosting dedicated AI cluster can have up to 50 endpoints.</p>
</li>
<li>
<p>A notification indicates that the endpoint resource is moved to the new compartment successfully. You might notice that the endpoint status changes to Updating. After the move is successful, the endpoint status changes back to Active.</p>
</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>import requests
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>import json
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>from datetime import datetime, timedelta
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>from collections import defaultdict
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>import pandas as pd
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>from typing import Dict, List, Any
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>import base64
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>from openpyxl import Workbook
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>from openpyxl.styles import Font, PatternFill, Alignment, Border, Side
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>from openpyxl.utils.dataframe import dataframe_to_rows
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>from openpyxl.formatting.rule import ColorScaleRule
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>from openpyxl.chart import BarChart, Reference
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>class TeamCityBuildAnalyzer:
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    def __init__(self, teamcity_url: str, username: str, password: str, project_filters: List[str] = None, 
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>                 build_type_filters: List[str] = None, build_name_filters: List[str] = None):
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        &quot;&quot;&quot;
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        Initialize TeamCity connection with optional filters
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>        Args:
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>            teamcity_url: TeamCity server URL (e.g., &#39;https://teamcity.company.com&#39;)
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>            username: TeamCity username
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>            password: TeamCity password
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>            project_filters: List of project names/IDs to include (case-insensitive partial matching)
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>            build_type_filters: List of build type names/IDs to include (case-insensitive partial matching)
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>            build_name_filters: List of build names to include (case-insensitive partial matching)
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        &quot;&quot;&quot;
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>        self.base_url = teamcity_url.rstrip(&#39;/&#39;)
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>        self.api_url = f&quot;{self.base_url}/app/rest&quot;
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>        # Setup authentication
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>        auth_string = f&quot;{username}:{password}&quot;
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>        auth_bytes = auth_string.encode(&#39;ascii&#39;)
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>        auth_b64 = base64.b64encode(auth_bytes).decode(&#39;ascii&#39;)
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>        self.headers = {
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>            &#39;Authorization&#39;: f&#39;Basic {auth_b64}&#39;,
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>            &#39;Accept&#39;: &#39;application/json&#39;,
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>            &#39;Content-Type&#39;: &#39;application/json&#39;
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>        }
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>        # Store filters (convert to lowercase for case-insensitive matching)
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>        self.project_filters = [f.lower() for f in project_filters] if project_filters else []
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>        self.build_type_filters = [f.lower() for f in build_type_filters] if build_type_filters else []
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>        self.build_name_filters = [f.lower() for f in build_name_filters] if build_name_filters else []
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>        # Test connection
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>        self._test_connection()
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>    def _test_connection(self):
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>        &quot;&quot;&quot;Test the connection to TeamCity server&quot;&quot;&quot;
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>        try:
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>            print(&quot;Testing connection to TeamCity...&quot;)
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>            response = requests.get(f&quot;{self.api_url}/server&quot;, headers=self.headers, timeout=10)
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>            if response.status_code == 401:
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>                raise Exception(&quot;Authentication failed. Please check your username and password.&quot;)
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>            elif response.status_code == 403:
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>                raise Exception(&quot;Access forbidden. Please check your permissions.&quot;)
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>            elif response.status_code != 200:
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>                raise Exception(f&quot;Connection failed with status code: {response.status_code}&quot;)
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>            server_info = response.json()
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>            print(f&quot;✅ Connected to TeamCity {server_info.get(&#39;version&#39;, &#39;Unknown&#39;)} successfully!&quot;)
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>        except requests.exceptions.Timeout:
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>            raise Exception(&quot;Connection timeout. Please check your TeamCity URL and network connection.&quot;)
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>        except requests.exceptions.ConnectionError:
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>            raise Exception(&quot;Connection error. Please check your TeamCity URL and network connection.&quot;)
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>        except Exception as e:
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>            raise Exception(f&quot;Connection test failed: {str(e)}&quot;)
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>    def get_project_hierarchy(self, project_id: str = None) -&gt; Dict[str, Any]:
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>        &quot;&quot;&quot;
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>        Get the full project hierarchy to understand folder structure
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>        Args:
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>            project_id: Project ID to get hierarchy for (None for root)
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>        Returns:
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>            Project hierarchy dictionary
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>        &quot;&quot;&quot;
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>        try:
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>            url = f&quot;{self.api_url}/projects&quot;
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>            params = {
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>                &#39;fields&#39;: &#39;project(id,name,parentProjectId,parentProject(id,name))&#39;,
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>                &#39;locator&#39;: f&#39;id:{project_id}&#39; if project_id else &#39;archived:false&#39;
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>            }
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>            response = requests.get(url, headers=self.headers, params=params)
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>            response.raise_for_status()
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>            return response.json()
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>        except requests.exceptions.RequestException as e:
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>            print(f&quot;Warning: Could not fetch project hierarchy: {e}&quot;)
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>            return {}
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>    def _get_project_full_path(self, project_id: str, project_name: str) -&gt; str:
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>        &quot;&quot;&quot;
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>        Get the full path of a project including parent folders
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>        Args:
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a>            project_id: Project ID
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>            project_name: Project name
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>        Returns:
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a>            Full project path (e.g., &quot;Veritas Release Projects &gt; PAT - Release Builds&quot;)
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>        &quot;&quot;&quot;
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a>        try:
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>            url = f&quot;{self.api_url}/projects/id:{project_id}&quot;
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>            params = {
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>                &#39;fields&#39;: &#39;project(id,name,parentProject(id,name,parentProject(id,name,parentProject(id,name))))&#39;
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>            }
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>            response = requests.get(url, headers=self.headers, params=params)
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>            response.raise_for_status()
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a>            project_data = response.json()
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a>            # Build path from root to current project
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a>            path_parts = []
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a>            current_project = project_data
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a>            while current_project:
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a>                path_parts.insert(0, current_project.get(&#39;name&#39;, &#39;Unknown&#39;))
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a>                current_project = current_project.get(&#39;parentProject&#39;)
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a>            # Remove root project if it&#39;s &quot;_Root&quot;
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a>            if path_parts and path_parts[0] == &#39;_Root&#39;:
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a>                path_parts = path_parts[1:]
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a>            return &#39; &gt; &#39;.join(path_parts)
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a>        except Exception as e:
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a>            print(f&quot;Warning: Could not get full path for project {project_name}: {e}&quot;)
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a>            return project_name
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a>    def _matches_filters(self, build: Dict[str, Any]) -&gt; bool:
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a>        &quot;&quot;&quot;
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a>        Check if a build matches the specified filters based on project folder structure
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a>        Args:
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a>            build: Build dictionary from TeamCity API
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a>        Returns:
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a>            True if build matches filters, False otherwise
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a>        &quot;&quot;&quot;
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a>        # If no filters are specified, include all builds
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a>        if not self.project_filters and not self.build_type_filters and not self.build_name_filters:
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a>            return True
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a>        build_type = build.get(&#39;buildType&#39;, {})
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a>        project_name = build_type.get(&#39;projectName&#39;, &#39;&#39;).lower()
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a>        project_id = build_type.get(&#39;projectId&#39;, &#39;&#39;)
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a>        build_type_name = build_type.get(&#39;name&#39;, &#39;&#39;).lower()
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a>        build_type_id = build.get(&#39;buildTypeId&#39;, &#39;&#39;).lower()
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a>        # Get full project path for better matching
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a>        full_project_path = self._get_project_full_path(project_id, project_name).lower()
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a>        # Check project filters with enhanced matching logic
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a>        project_match = True
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a>        if self.project_filters:
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a>            project_match = False  # Default to False, must match at least one filter
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a>            for filter_term in self.project_filters:
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a>                filter_lower = filter_term.lower()
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a>                # Method 1: Exact project name match
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a>                if filter_lower == project_name:
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a>                    project_match = True
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a>                    break
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a>                # Method 2: Full path contains the filter (for nested projects)
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a>                elif filter_lower in full_project_path:
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a>                    project_match = True
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a>                    break
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a>                # Method 3: Path-like filter matching (e.g., &quot;project1 &gt; project1a&quot;)
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a>                elif &#39; &gt; &#39; in filter_lower:
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a>                    # User specified a hierarchical path
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a>                    if filter_lower == full_project_path:
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a>                        project_match = True
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a>                        break
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a>                    # Also check if the full path ends with the specified path
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a>                    elif full_project_path.endswith(filter_lower):
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a>                        project_match = True
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a>                        break
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a>                # Method 4: Slash-separated path matching (e.g., &quot;project1/project1a&quot;)
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a>                elif &#39;/&#39; in filter_lower:
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a>                    # Convert slash format to hierarchy format
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a>                    hierarchy_filter = filter_lower.replace(&#39;/&#39;, &#39; &gt; &#39;)
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a>                    if hierarchy_filter == full_project_path:
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a>                        project_match = True
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a>                        break
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a>                    elif full_project_path.endswith(hierarchy_filter):
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a>                        project_match = True
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a>                        break
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a>                # Method 5: Check if it&#39;s a direct child project reference
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a>                elif filter_lower == project_id.lower():
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a>                    project_match = True
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#__codelineno-0-202"></a>                    break
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#__codelineno-0-203"></a>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#__codelineno-0-204"></a>        # Check build type filters  
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#__codelineno-0-205"></a>        build_type_match = True
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#__codelineno-0-206"></a>        if self.build_type_filters:
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#__codelineno-0-207"></a>            build_type_match = any(
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#__codelineno-0-208"></a>                filter_term in build_type_name or filter_term in build_type_id
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#__codelineno-0-209"></a>                for filter_term in self.build_type_filters
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#__codelineno-0-210"></a>            )
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#__codelineno-0-211"></a>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#__codelineno-0-212"></a>        # Check build name filters
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#__codelineno-0-213"></a>        build_name_match = True
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#__codelineno-0-214"></a>        if self.build_name_filters:
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#__codelineno-0-215"></a>            build_name_match = any(
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#__codelineno-0-216"></a>                filter_term in build_type_name
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#__codelineno-0-217"></a>                for filter_term in self.build_name_filters
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#__codelineno-0-218"></a>            )
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#__codelineno-0-219"></a>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#__codelineno-0-220"></a>        # Build must match ALL specified filter categories
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#__codelineno-0-221"></a>        return project_match and build_type_match and build_name_match
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#__codelineno-0-222"></a>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#__codelineno-0-223"></a>    def _get_matched_filter(self, build: Dict[str, Any]) -&gt; str:
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#__codelineno-0-224"></a>        &quot;&quot;&quot;
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#__codelineno-0-225"></a>        **NEW METHOD: Determine which specific filter matched this build**
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#__codelineno-0-226"></a>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#__codelineno-0-227"></a>        Args:
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#__codelineno-0-228"></a>            build: Build dictionary from TeamCity API
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#__codelineno-0-229"></a>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#__codelineno-0-230"></a>        Returns:
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231" href="#__codelineno-0-231"></a>            The filter string that matched this build
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232" href="#__codelineno-0-232"></a>        &quot;&quot;&quot;
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233" href="#__codelineno-0-233"></a>        build_type = build.get(&#39;buildType&#39;, {})
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234" href="#__codelineno-0-234"></a>        project_name = build_type.get(&#39;projectName&#39;, &#39;&#39;).lower()
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235" href="#__codelineno-0-235"></a>        project_id = build_type.get(&#39;projectId&#39;, &#39;&#39;)
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236" href="#__codelineno-0-236"></a>        full_project_path = self._get_project_full_path(project_id, project_name).lower()
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237" href="#__codelineno-0-237"></a>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238" href="#__codelineno-0-238"></a>        # Check which project filter matched
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239" href="#__codelineno-0-239"></a>        for filter_term in self.project_filters:
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240" href="#__codelineno-0-240"></a>            filter_lower = filter_term.lower()
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241" href="#__codelineno-0-241"></a>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242" href="#__codelineno-0-242"></a>            # Check all the same matching logic as in _matches_filters
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243" href="#__codelineno-0-243"></a>            if (filter_lower == project_name or
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244" href="#__codelineno-0-244"></a>                filter_lower in full_project_path or
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245" href="#__codelineno-0-245"></a>                (&#39; &gt; &#39; in filter_lower and (filter_lower == full_project_path or full_project_path.endswith(filter_lower))) or
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246" href="#__codelineno-0-246"></a>                (&#39;/&#39; in filter_lower and (filter_lower.replace(&#39;/&#39;, &#39; &gt; &#39;) == full_project_path or full_project_path.endswith(filter_lower.replace(&#39;/&#39;, &#39; &gt; &#39;)))) or
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247" href="#__codelineno-0-247"></a>                filter_lower == project_id.lower()):
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248" href="#__codelineno-0-248"></a>                return filter_term  # Return original filter (not lowercased)
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249" href="#__codelineno-0-249"></a>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250" href="#__codelineno-0-250"></a>        return &quot;Unknown Filter&quot;
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251" href="#__codelineno-0-251"></a>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252" href="#__codelineno-0-252"></a>    def _matches_filters(self, build: Dict[str, Any]) -&gt; bool:
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253" href="#__codelineno-0-253"></a>        &quot;&quot;&quot;
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254" href="#__codelineno-0-254"></a>        Check if a build matches the specified filters
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255" href="#__codelineno-0-255"></a>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256" href="#__codelineno-0-256"></a>        Args:
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257" href="#__codelineno-0-257"></a>            build: Build dictionary from TeamCity API
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258" href="#__codelineno-0-258"></a>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259" href="#__codelineno-0-259"></a>        Returns:
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260" href="#__codelineno-0-260"></a>            True if build matches filters, False otherwise
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261" href="#__codelineno-0-261"></a>        &quot;&quot;&quot;
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262" href="#__codelineno-0-262"></a>        # If no filters are specified, include all builds
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263" href="#__codelineno-0-263"></a>        if not self.project_filters and not self.build_type_filters and not self.build_name_filters:
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264" href="#__codelineno-0-264"></a>            return True
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265" href="#__codelineno-0-265"></a>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266" href="#__codelineno-0-266"></a>        build_type = build.get(&#39;buildType&#39;, {})
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267" href="#__codelineno-0-267"></a>        project_name = build_type.get(&#39;projectName&#39;, &#39;&#39;).lower()
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268" href="#__codelineno-0-268"></a>        project_id = build_type.get(&#39;projectId&#39;, &#39;&#39;).lower()
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269" href="#__codelineno-0-269"></a>        build_type_name = build_type.get(&#39;name&#39;, &#39;&#39;).lower()
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270" href="#__codelineno-0-270"></a>        build_type_id = build.get(&#39;buildTypeId&#39;, &#39;&#39;).lower()
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271" href="#__codelineno-0-271"></a>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272" href="#__codelineno-0-272"></a>        # Check project filters
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273" href="#__codelineno-0-273"></a>        project_match = True
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274" href="#__codelineno-0-274"></a>        if self.project_filters:
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275" href="#__codelineno-0-275"></a>            project_match = any(
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276" href="#__codelineno-0-276"></a>                filter_term in project_name or filter_term in project_id
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277" href="#__codelineno-0-277"></a>                for filter_term in self.project_filters
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278" href="#__codelineno-0-278"></a>            )
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279" href="#__codelineno-0-279"></a>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280" href="#__codelineno-0-280"></a>        # Check build type filters  
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281" href="#__codelineno-0-281"></a>        build_type_match = True
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282" href="#__codelineno-0-282"></a>        if self.build_type_filters:
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283" href="#__codelineno-0-283"></a>            build_type_match = any(
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284" href="#__codelineno-0-284"></a>                filter_term in build_type_name or filter_term in build_type_id
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285" href="#__codelineno-0-285"></a>                for filter_term in self.build_type_filters
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286" href="#__codelineno-0-286"></a>            )
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287" href="#__codelineno-0-287"></a>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288" href="#__codelineno-0-288"></a>        # Check build name filters
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289" href="#__codelineno-0-289"></a>        build_name_match = True
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290" href="#__codelineno-0-290"></a>        if self.build_name_filters:
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291" href="#__codelineno-0-291"></a>            build_name_match = any(
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292" href="#__codelineno-0-292"></a>                filter_term in build_type_name
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293" href="#__codelineno-0-293"></a>                for filter_term in self.build_name_filters
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294" href="#__codelineno-0-294"></a>            )
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295" href="#__codelineno-0-295"></a>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296" href="#__codelineno-0-296"></a>        # Build must match ALL specified filter categories
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297" href="#__codelineno-0-297"></a>        return project_match and build_type_match and build_name_match
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298" href="#__codelineno-0-298"></a>    def get_builds_last_month(self) -&gt; List[Dict[str, Any]]:
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299" href="#__codelineno-0-299"></a>        &quot;&quot;&quot;
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300" href="#__codelineno-0-300"></a>        Fetch all builds from the last month, filtered by specified criteria
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301" href="#__codelineno-0-301"></a>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302" href="#__codelineno-0-302"></a>        Returns:
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303" href="#__codelineno-0-303"></a>            List of build dictionaries that match the filters
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304" href="#__codelineno-0-304"></a>        &quot;&quot;&quot;
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305" href="#__codelineno-0-305"></a>        try:
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306" href="#__codelineno-0-306"></a>            # Calculate date range for last month
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307" href="#__codelineno-0-307"></a>            end_date = datetime.now()
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308" href="#__codelineno-0-308"></a>            start_date = end_date - timedelta(days=30)
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309" href="#__codelineno-0-309"></a>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310" href="#__codelineno-0-310"></a>            # Format dates for TeamCity API (YYYYMMDDTHHMMSS+HHMM format)
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311" href="#__codelineno-0-311"></a>            start_date_str = start_date.strftime(&#39;%Y%m%dT%H%M%S+0000&#39;)
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312" href="#__codelineno-0-312"></a>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313" href="#__codelineno-0-313"></a>            print(f&quot;Fetching builds from {start_date.strftime(&#39;%Y-%m-%d&#39;)} to {end_date.strftime(&#39;%Y-%m-%d&#39;)}&quot;)
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314" href="#__codelineno-0-314"></a>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315" href="#__codelineno-0-315"></a>            # Print active filters
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316" href="#__codelineno-0-316"></a>            if self.project_filters or self.build_type_filters or self.build_name_filters:
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317" href="#__codelineno-0-317"></a>                print(&quot;Active filters:&quot;)
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318" href="#__codelineno-0-318"></a>                if self.project_filters:
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319" href="#__codelineno-0-319"></a>                    print(f&quot;  - Project/Folder filters: {&#39;, &#39;.join(self.project_filters)}&quot;)
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320" href="#__codelineno-0-320"></a>                if self.build_type_filters:
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321" href="#__codelineno-0-321"></a>                    print(f&quot;  - Build type filters: {&#39;, &#39;.join(self.build_type_filters)}&quot;)
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322" href="#__codelineno-0-322"></a>                if self.build_name_filters:
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323" href="#__codelineno-0-323"></a>                    print(f&quot;  - Build name filters: {&#39;, &#39;.join(self.build_name_filters)}&quot;)
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324" href="#__codelineno-0-324"></a>            else:
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325" href="#__codelineno-0-325"></a>                print(&quot;No filters applied - fetching all builds&quot;)
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326" href="#__codelineno-0-326"></a>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327" href="#__codelineno-0-327"></a>            # TeamCity locator for builds in date range
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328" href="#__codelineno-0-328"></a>            locator = f&quot;sinceDate:{start_date_str}&quot;
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329" href="#__codelineno-0-329"></a>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330" href="#__codelineno-0-330"></a>            builds = []
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331" href="#__codelineno-0-331"></a>            filtered_builds = []
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332" href="#__codelineno-0-332"></a>            count = 100  # Number of builds per request
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333" href="#__codelineno-0-333"></a>            start = 0
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334" href="#__codelineno-0-334"></a>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335" href="#__codelineno-0-335"></a>            while True:
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336" href="#__codelineno-0-336"></a>                url = f&quot;{self.api_url}/builds&quot;
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337" href="#__codelineno-0-337"></a>                params = {
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338" href="#__codelineno-0-338"></a>                    &#39;locator&#39;: f&quot;{locator},start:{start},count:{count}&quot;,
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339" href="#__codelineno-0-339"></a>                    &#39;fields&#39;: &#39;build(id,number,status,state,buildTypeId,startDate,finishDate,queuedDate,branchName,statusText,triggered(type,user(username,name),date),buildType(id,name,projectId,projectName))&#39;
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340" href="#__codelineno-0-340"></a>                }
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341" href="#__codelineno-0-341"></a>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342" href="#__codelineno-0-342"></a>                try:
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343" href="#__codelineno-0-343"></a>                    response = requests.get(url, headers=self.headers, params=params, timeout=30)
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344" href="#__codelineno-0-344"></a>                    response.raise_for_status()
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345" href="#__codelineno-0-345"></a>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346" href="#__codelineno-0-346"></a>                    data = response.json()
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347" href="#__codelineno-0-347"></a>                    batch_builds = data.get(&#39;build&#39;, [])
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348" href="#__codelineno-0-348"></a>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349" href="#__codelineno-0-349"></a>                    if not batch_builds:
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350" href="#__codelineno-0-350"></a>                        break
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351" href="#__codelineno-0-351"></a>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352" href="#__codelineno-0-352"></a>                    builds.extend(batch_builds)
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353" href="#__codelineno-0-353"></a>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354" href="#__codelineno-0-354"></a>                    # Apply filters to this batch
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355" href="#__codelineno-0-355"></a>                    for build in batch_builds:
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356" href="#__codelineno-0-356"></a>                        if self._matches_filters(build):
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357" href="#__codelineno-0-357"></a>                            filtered_builds.append(build)
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358" href="#__codelineno-0-358"></a>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359" href="#__codelineno-0-359"></a>                    print(f&quot;Fetched {len(builds)} total builds, {len(filtered_builds)} match filters...&quot;)
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360" href="#__codelineno-0-360"></a>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361" href="#__codelineno-0-361"></a>                    # Check if we got fewer builds than requested (end of results)
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362" href="#__codelineno-0-362"></a>                    if len(batch_builds) &lt; count:
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363" href="#__codelineno-0-363"></a>                        break
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364" href="#__codelineno-0-364"></a>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365" href="#__codelineno-0-365"></a>                    start += count
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366" href="#__codelineno-0-366"></a>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367" href="#__codelineno-0-367"></a>                except requests.exceptions.Timeout:
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368" href="#__codelineno-0-368"></a>                    print(f&quot;⚠️  Request timeout while fetching builds. Retrying...&quot;)
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369" href="#__codelineno-0-369"></a>                    continue
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370" href="#__codelineno-0-370"></a>                except requests.exceptions.RequestException as e:
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371" href="#__codelineno-0-371"></a>                    print(f&quot;❌ Error fetching builds (batch starting at {start}): {e}&quot;)
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372" href="#__codelineno-0-372"></a>                    if &quot;401&quot; in str(e):
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373" href="#__codelineno-0-373"></a>                        raise Exception(&quot;Authentication failed. Please check your credentials.&quot;)
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374" href="#__codelineno-0-374"></a>                    elif &quot;403&quot; in str(e):
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375" href="#__codelineno-0-375"></a>                        raise Exception(&quot;Access forbidden. Please check your permissions.&quot;)
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376" href="#__codelineno-0-376"></a>                    else:
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377" href="#__codelineno-0-377"></a>                        print(f&quot;Continuing with {len(filtered_builds)} builds collected so far...&quot;)
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378" href="#__codelineno-0-378"></a>                        break
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379" href="#__codelineno-0-379"></a>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380" href="#__codelineno-0-380"></a>            print(f&quot;Total builds fetched: {len(builds)}&quot;)
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381" href="#__codelineno-0-381"></a>            print(f&quot;Builds matching filters: {len(filtered_builds)}&quot;)
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382" href="#__codelineno-0-382"></a>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383" href="#__codelineno-0-383"></a>            if filtered_builds:
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384" href="#__codelineno-0-384"></a>                # Show sample of filtered builds for verification
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385" href="#__codelineno-0-385"></a>                print(&quot;\n🔍 Sample of filtered builds:&quot;)
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386" href="#__codelineno-0-386"></a>                for i, build in enumerate(filtered_builds[:5]):
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387" href="#__codelineno-0-387"></a>                    build_type = build.get(&#39;buildType&#39;, {})
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388" href="#__codelineno-0-388"></a>                    project_path = self._get_project_full_path(
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389" href="#__codelineno-0-389"></a>                        build_type.get(&#39;projectId&#39;, &#39;&#39;), 
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390" href="#__codelineno-0-390"></a>                        build_type.get(&#39;projectName&#39;, &#39;&#39;)
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391" href="#__codelineno-0-391"></a>                    )
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392" href="#__codelineno-0-392"></a>                    print(f&quot;  {i+1}. Path: {project_path}&quot;)
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393" href="#__codelineno-0-393"></a>                    print(f&quot;     Build: {build_type.get(&#39;name&#39;, &#39;N/A&#39;)} | Status: {build.get(&#39;status&#39;, &#39;N/A&#39;)}&quot;)
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394" href="#__codelineno-0-394"></a>                if len(filtered_builds) &gt; 5:
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395" href="#__codelineno-0-395"></a>                    print(f&quot;  ... and {len(filtered_builds) - 5} more&quot;)
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396" href="#__codelineno-0-396"></a>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397" href="#__codelineno-0-397"></a>            return filtered_builds
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398" href="#__codelineno-0-398"></a>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399" href="#__codelineno-0-399"></a>        except Exception as e:
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400" href="#__codelineno-0-400"></a>            print(f&quot;❌ Critical error in get_builds_last_month: {e}&quot;)
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401" href="#__codelineno-0-401"></a>            raise
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402" href="#__codelineno-0-402"></a>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403" href="#__codelineno-0-403"></a>    def extract_application_code(self, build_type_name: str, project_name: str) -&gt; str:
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404" href="#__codelineno-0-404"></a>        &quot;&quot;&quot;
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405" href="#__codelineno-0-405"></a>        Extract application code from build type name or project name
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406" href="#__codelineno-0-406"></a>        You may need to customize this based on your naming conventions
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407" href="#__codelineno-0-407"></a>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408" href="#__codelineno-0-408"></a>        Args:
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409" href="#__codelineno-0-409"></a>            build_type_name: Name of the build type
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410" href="#__codelineno-0-410"></a>            project_name: Name of the project
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411" href="#__codelineno-0-411"></a>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412" href="#__codelineno-0-412"></a>        Returns:
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413" href="#__codelineno-0-413"></a>            Application code string
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414" href="#__codelineno-0-414"></a>        &quot;&quot;&quot;
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415" href="#__codelineno-0-415"></a>        # Example logic - customize based on your naming conventions
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416" href="#__codelineno-0-416"></a>        if &#39;_&#39; in build_type_name:
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417" href="#__codelineno-0-417"></a>            return build_type_name.split(&#39;_&#39;)[0]
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418" href="#__codelineno-0-418"></a>        elif &#39;-&#39; in build_type_name:
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419" href="#__codelineno-0-419"></a>            return build_type_name.split(&#39;-&#39;)[0]
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420" href="#__codelineno-0-420"></a>        else:
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421" href="#__codelineno-0-421"></a>            return project_name
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422" href="#__codelineno-0-422"></a>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423" href="#__codelineno-0-423"></a>    def analyze_builds(self, builds: List[Dict[str, Any]]) -&gt; pd.DataFrame:
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424" href="#__codelineno-0-424"></a>        &quot;&quot;&quot;
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425" href="#__codelineno-0-425"></a>        Analyze builds and create summary statistics
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426" href="#__codelineno-0-426"></a>
</span><span id="__span-0-427"><a id="__codelineno-0-427" name="__codelineno-0-427" href="#__codelineno-0-427"></a>        Args:
</span><span id="__span-0-428"><a id="__codelineno-0-428" name="__codelineno-0-428" href="#__codelineno-0-428"></a>            builds: List of build dictionaries
</span><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429" href="#__codelineno-0-429"></a>
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430" href="#__codelineno-0-430"></a>        Returns:
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431" href="#__codelineno-0-431"></a>            DataFrame with analysis results
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432" href="#__codelineno-0-432"></a>        &quot;&quot;&quot;
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433" href="#__codelineno-0-433"></a>        analysis_data = []
</span><span id="__span-0-434"><a id="__codelineno-0-434" name="__codelineno-0-434" href="#__codelineno-0-434"></a>
</span><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435" href="#__codelineno-0-435"></a>        for build in builds:
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436" href="#__codelineno-0-436"></a>            try:
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437" href="#__codelineno-0-437"></a>                # Extract build information
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438" href="#__codelineno-0-438"></a>                build_type = build.get(&#39;buildType&#39;, {})
</span><span id="__span-0-439"><a id="__codelineno-0-439" name="__codelineno-0-439" href="#__codelineno-0-439"></a>                build_type_id = build.get(&#39;buildTypeId&#39;, &#39;&#39;)
</span><span id="__span-0-440"><a id="__codelineno-0-440" name="__codelineno-0-440" href="#__codelineno-0-440"></a>                build_type_name = build_type.get(&#39;name&#39;, &#39;&#39;)
</span><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441" href="#__codelineno-0-441"></a>                project_name = build_type.get(&#39;projectName&#39;, &#39;&#39;)
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442" href="#__codelineno-0-442"></a>                project_id = build_type.get(&#39;projectId&#39;, &#39;&#39;)
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443" href="#__codelineno-0-443"></a>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444" href="#__codelineno-0-444"></a>                # Get full project path
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445" href="#__codelineno-0-445"></a>                full_project_path = self._get_project_full_path(project_id, project_name)
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446" href="#__codelineno-0-446"></a>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447" href="#__codelineno-0-447"></a>                # Extract application code
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448" href="#__codelineno-0-448"></a>                app_code = self.extract_application_code(build_type_name, project_name)
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449" href="#__codelineno-0-449"></a>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450" href="#__codelineno-0-450"></a>                # Parse timestamps
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451" href="#__codelineno-0-451"></a>                start_date = build.get(&#39;startDate&#39;, &#39;&#39;)
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452" href="#__codelineno-0-452"></a>                queued_date = build.get(&#39;queuedDate&#39;, &#39;&#39;)
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453" href="#__codelineno-0-453"></a>                finish_date = build.get(&#39;finishDate&#39;, &#39;&#39;)
</span><span id="__span-0-454"><a id="__codelineno-0-454" name="__codelineno-0-454" href="#__codelineno-0-454"></a>
</span><span id="__span-0-455"><a id="__codelineno-0-455" name="__codelineno-0-455" href="#__codelineno-0-455"></a>                # Convert timestamps to datetime objects
</span><span id="__span-0-456"><a id="__codelineno-0-456" name="__codelineno-0-456" href="#__codelineno-0-456"></a>                timestamp = None
</span><span id="__span-0-457"><a id="__codelineno-0-457" name="__codelineno-0-457" href="#__codelineno-0-457"></a>                start_datetime = None
</span><span id="__span-0-458"><a id="__codelineno-0-458" name="__codelineno-0-458" href="#__codelineno-0-458"></a>                finish_datetime = None
</span><span id="__span-0-459"><a id="__codelineno-0-459" name="__codelineno-0-459" href="#__codelineno-0-459"></a>                build_duration_minutes = None
</span><span id="__span-0-460"><a id="__codelineno-0-460" name="__codelineno-0-460" href="#__codelineno-0-460"></a>
</span><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461" href="#__codelineno-0-461"></a>                if start_date:
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462" href="#__codelineno-0-462"></a>                    try:
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463" href="#__codelineno-0-463"></a>                        timestamp = datetime.strptime(start_date[:15], &#39;%Y%m%dT%H%M%S&#39;)
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464" href="#__codelineno-0-464"></a>                        start_datetime = timestamp
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465" href="#__codelineno-0-465"></a>                    except ValueError:
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466" href="#__codelineno-0-466"></a>                        pass
</span><span id="__span-0-467"><a id="__codelineno-0-467" name="__codelineno-0-467" href="#__codelineno-0-467"></a>
</span><span id="__span-0-468"><a id="__codelineno-0-468" name="__codelineno-0-468" href="#__codelineno-0-468"></a>                # **NEW CODE: Calculate build duration**
</span><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469" href="#__codelineno-0-469"></a>                if start_date and finish_date:
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470" href="#__codelineno-0-470"></a>                    try:
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471" href="#__codelineno-0-471"></a>                        start_dt = datetime.strptime(start_date[:15], &#39;%Y%m%dT%H%M%S&#39;)
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472" href="#__codelineno-0-472"></a>                        finish_dt = datetime.strptime(finish_date[:15], &#39;%Y%m%dT%H%M%S&#39;)
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473" href="#__codelineno-0-473"></a>                        duration = finish_dt - start_dt
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474" href="#__codelineno-0-474"></a>                        build_duration_minutes = duration.total_seconds() / 60
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475" href="#__codelineno-0-475"></a>                    except ValueError:
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476" href="#__codelineno-0-476"></a>                        pass
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477" href="#__codelineno-0-477"></a>
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478" href="#__codelineno-0-478"></a>                # Determine build status
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479" href="#__codelineno-0-479"></a>                status = build.get(&#39;status&#39;, &#39;UNKNOWN&#39;)
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480" href="#__codelineno-0-480"></a>                state = build.get(&#39;state&#39;, &#39;UNKNOWN&#39;)
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481" href="#__codelineno-0-481"></a>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482" href="#__codelineno-0-482"></a>                is_successful = status == &#39;SUCCESS&#39; and state == &#39;finished&#39;
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483" href="#__codelineno-0-483"></a>                is_failed = status == &#39;FAILURE&#39; and state == &#39;finished&#39;
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484" href="#__codelineno-0-484"></a>
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485" href="#__codelineno-0-485"></a>                # Extract trigger information (who kicked off the build)
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486" href="#__codelineno-0-486"></a>                triggered_by = &#39;Unknown&#39;
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487" href="#__codelineno-0-487"></a>                trigger_type = &#39;Unknown&#39;
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488" href="#__codelineno-0-488"></a>                trigger_date = &#39;&#39;
</span><span id="__span-0-489"><a id="__codelineno-0-489" name="__codelineno-0-489" href="#__codelineno-0-489"></a>
</span><span id="__span-0-490"><a id="__codelineno-0-490" name="__codelineno-0-490" href="#__codelineno-0-490"></a>                triggered_info = build.get(&#39;triggered&#39;, {})
</span><span id="__span-0-491"><a id="__codelineno-0-491" name="__codelineno-0-491" href="#__codelineno-0-491"></a>                if triggered_info:
</span><span id="__span-0-492"><a id="__codelineno-0-492" name="__codelineno-0-492" href="#__codelineno-0-492"></a>                    trigger_type = triggered_info.get(&#39;type&#39;, &#39;Unknown&#39;)
</span><span id="__span-0-493"><a id="__codelineno-0-493" name="__codelineno-0-493" href="#__codelineno-0-493"></a>                    trigger_date = triggered_info.get(&#39;date&#39;, &#39;&#39;)
</span><span id="__span-0-494"><a id="__codelineno-0-494" name="__codelineno-0-494" href="#__codelineno-0-494"></a>
</span><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495" href="#__codelineno-0-495"></a>                    if trigger_type == &#39;user&#39;:
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496" href="#__codelineno-0-496"></a>                        user_info = triggered_info.get(&#39;user&#39;, {})
</span><span id="__span-0-497"><a id="__codelineno-0-497" name="__codelineno-0-497" href="#__codelineno-0-497"></a>                        if user_info:
</span><span id="__span-0-498"><a id="__codelineno-0-498" name="__codelineno-0-498" href="#__codelineno-0-498"></a>                            username = user_info.get(&#39;username&#39;, &#39;&#39;)
</span><span id="__span-0-499"><a id="__codelineno-0-499" name="__codelineno-0-499" href="#__codelineno-0-499"></a>                            name = user_info.get(&#39;name&#39;, &#39;&#39;)
</span><span id="__span-0-500"><a id="__codelineno-0-500" name="__codelineno-0-500" href="#__codelineno-0-500"></a>                            triggered_by = f&quot;{name} ({username})&quot; if name and username else (username or name or &#39;Unknown User&#39;)
</span><span id="__span-0-501"><a id="__codelineno-0-501" name="__codelineno-0-501" href="#__codelineno-0-501"></a>                    elif trigger_type == &#39;vcs&#39;:
</span><span id="__span-0-502"><a id="__codelineno-0-502" name="__codelineno-0-502" href="#__codelineno-0-502"></a>                        triggered_by = &#39;VCS Trigger (Code Change)&#39;
</span><span id="__span-0-503"><a id="__codelineno-0-503" name="__codelineno-0-503" href="#__codelineno-0-503"></a>                    elif trigger_type == &#39;schedule&#39;:
</span><span id="__span-0-504"><a id="__codelineno-0-504" name="__codelineno-0-504" href="#__codelineno-0-504"></a>                        triggered_by = &#39;Scheduled Trigger&#39;
</span><span id="__span-0-505"><a id="__codelineno-0-505" name="__codelineno-0-505" href="#__codelineno-0-505"></a>                    elif trigger_type == &#39;dependency&#39;:
</span><span id="__span-0-506"><a id="__codelineno-0-506" name="__codelineno-0-506" href="#__codelineno-0-506"></a>                        triggered_by = &#39;Dependency Trigger&#39;
</span><span id="__span-0-507"><a id="__codelineno-0-507" name="__codelineno-0-507" href="#__codelineno-0-507"></a>                    else:
</span><span id="__span-0-508"><a id="__codelineno-0-508" name="__codelineno-0-508" href="#__codelineno-0-508"></a>                        triggered_by = f&quot;{trigger_type.title()} Trigger&quot;
</span><span id="__span-0-509"><a id="__codelineno-0-509" name="__codelineno-0-509" href="#__codelineno-0-509"></a>
</span><span id="__span-0-510"><a id="__codelineno-0-510" name="__codelineno-0-510" href="#__codelineno-0-510"></a>                # **NEW CODE: Determine which filter matched this build**
</span><span id="__span-0-511"><a id="__codelineno-0-511" name="__codelineno-0-511" href="#__codelineno-0-511"></a>                matched_filter = self._get_matched_filter(build)
</span><span id="__span-0-512"><a id="__codelineno-0-512" name="__codelineno-0-512" href="#__codelineno-0-512"></a>
</span><span id="__span-0-513"><a id="__codelineno-0-513" name="__codelineno-0-513" href="#__codelineno-0-513"></a>                analysis_data.append({
</span><span id="__span-0-514"><a id="__codelineno-0-514" name="__codelineno-0-514" href="#__codelineno-0-514"></a>                    &#39;application_code&#39;: app_code,
</span><span id="__span-0-515"><a id="__codelineno-0-515" name="__codelineno-0-515" href="#__codelineno-0-515"></a>                    &#39;build_type_id&#39;: build_type_id,
</span><span id="__span-0-516"><a id="__codelineno-0-516" name="__codelineno-0-516" href="#__codelineno-0-516"></a>                    &#39;build_type_name&#39;: build_type_name,
</span><span id="__span-0-517"><a id="__codelineno-0-517" name="__codelineno-0-517" href="#__codelineno-0-517"></a>                    &#39;project_name&#39;: project_name,
</span><span id="__span-0-518"><a id="__codelineno-0-518" name="__codelineno-0-518" href="#__codelineno-0-518"></a>                    &#39;project_path&#39;: full_project_path,
</span><span id="__span-0-519"><a id="__codelineno-0-519" name="__codelineno-0-519" href="#__codelineno-0-519"></a>                    &#39;build_id&#39;: build.get(&#39;id&#39;, &#39;&#39;),
</span><span id="__span-0-520"><a id="__codelineno-0-520" name="__codelineno-0-520" href="#__codelineno-0-520"></a>                    &#39;build_number&#39;: build.get(&#39;number&#39;, &#39;&#39;),
</span><span id="__span-0-521"><a id="__codelineno-0-521" name="__codelineno-0-521" href="#__codelineno-0-521"></a>                    &#39;status&#39;: status,
</span><span id="__span-0-522"><a id="__codelineno-0-522" name="__codelineno-0-522" href="#__codelineno-0-522"></a>                    &#39;state&#39;: state,
</span><span id="__span-0-523"><a id="__codelineno-0-523" name="__codelineno-0-523" href="#__codelineno-0-523"></a>                    &#39;timestamp&#39;: timestamp,
</span><span id="__span-0-524"><a id="__codelineno-0-524" name="__codelineno-0-524" href="#__codelineno-0-524"></a>                    &#39;start_date&#39;: start_date,
</span><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525" href="#__codelineno-0-525"></a>                    &#39;queued_date&#39;: queued_date,
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526" href="#__codelineno-0-526"></a>                    &#39;finish_date&#39;: finish_date,
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527" href="#__codelineno-0-527"></a>                    &#39;branch&#39;: build.get(&#39;branchName&#39;, &#39;default&#39;),
</span><span id="__span-0-528"><a id="__codelineno-0-528" name="__codelineno-0-528" href="#__codelineno-0-528"></a>                    &#39;is_successful&#39;: is_successful,
</span><span id="__span-0-529"><a id="__codelineno-0-529" name="__codelineno-0-529" href="#__codelineno-0-529"></a>                    &#39;is_failed&#39;: is_failed,
</span><span id="__span-0-530"><a id="__codelineno-0-530" name="__codelineno-0-530" href="#__codelineno-0-530"></a>                    &#39;status_text&#39;: build.get(&#39;statusText&#39;, &#39;&#39;),
</span><span id="__span-0-531"><a id="__codelineno-0-531" name="__codelineno-0-531" href="#__codelineno-0-531"></a>                    &#39;triggered_by&#39;: triggered_by,
</span><span id="__span-0-532"><a id="__codelineno-0-532" name="__codelineno-0-532" href="#__codelineno-0-532"></a>                    &#39;trigger_type&#39;: trigger_type,
</span><span id="__span-0-533"><a id="__codelineno-0-533" name="__codelineno-0-533" href="#__codelineno-0-533"></a>                    &#39;trigger_date&#39;: trigger_date,
</span><span id="__span-0-534"><a id="__codelineno-0-534" name="__codelineno-0-534" href="#__codelineno-0-534"></a>                    &#39;build_duration_minutes&#39;: build_duration_minutes,  # **NEW**
</span><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535" href="#__codelineno-0-535"></a>                    &#39;matched_filter&#39;: matched_filter  # **NEW**
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536" href="#__codelineno-0-536"></a>                })
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537" href="#__codelineno-0-537"></a>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538" href="#__codelineno-0-538"></a>            except Exception as e:
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539" href="#__codelineno-0-539"></a>                print(f&quot;⚠️  Error processing build {build.get(&#39;id&#39;, &#39;unknown&#39;)}: {e}&quot;)
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540" href="#__codelineno-0-540"></a>                continue
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541" href="#__codelineno-0-541"></a>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542" href="#__codelineno-0-542"></a>        return pd.DataFrame(analysis_data)
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543" href="#__codelineno-0-543"></a>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544" href="#__codelineno-0-544"></a>    def generate_summary(self, df: pd.DataFrame) -&gt; pd.DataFrame:
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545" href="#__codelineno-0-545"></a>        &quot;&quot;&quot;
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546" href="#__codelineno-0-546"></a>        Generate summary statistics grouped by application code and build type
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547" href="#__codelineno-0-547"></a>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548" href="#__codelineno-0-548"></a>        Args:
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549" href="#__codelineno-0-549"></a>            df: DataFrame with build data
</span><span id="__span-0-550"><a id="__codelineno-0-550" name="__codelineno-0-550" href="#__codelineno-0-550"></a>
</span><span id="__span-0-551"><a id="__codelineno-0-551" name="__codelineno-0-551" href="#__codelineno-0-551"></a>        Returns:
</span><span id="__span-0-552"><a id="__codelineno-0-552" name="__codelineno-0-552" href="#__codelineno-0-552"></a>            DataFrame with summary statistics
</span><span id="__span-0-553"><a id="__codelineno-0-553" name="__codelineno-0-553" href="#__codelineno-0-553"></a>        &quot;&quot;&quot;
</span><span id="__span-0-554"><a id="__codelineno-0-554" name="__codelineno-0-554" href="#__codelineno-0-554"></a>        # Group by application code and build type
</span><span id="__span-0-555"><a id="__codelineno-0-555" name="__codelineno-0-555" href="#__codelineno-0-555"></a>        summary = df.groupby([&#39;application_code&#39;, &#39;build_type_name&#39;]).agg({
</span><span id="__span-0-556"><a id="__codelineno-0-556" name="__codelineno-0-556" href="#__codelineno-0-556"></a>            &#39;build_id&#39;: &#39;count&#39;,  # Total builds
</span><span id="__span-0-557"><a id="__codelineno-0-557" name="__codelineno-0-557" href="#__codelineno-0-557"></a>            &#39;is_successful&#39;: &#39;sum&#39;,  # Successful builds
</span><span id="__span-0-558"><a id="__codelineno-0-558" name="__codelineno-0-558" href="#__codelineno-0-558"></a>            &#39;is_failed&#39;: &#39;sum&#39;,  # Failed builds
</span><span id="__span-0-559"><a id="__codelineno-0-559" name="__codelineno-0-559" href="#__codelineno-0-559"></a>            &#39;timestamp&#39;: [&#39;min&#39;, &#39;max&#39;]  # First and last build timestamps
</span><span id="__span-0-560"><a id="__codelineno-0-560" name="__codelineno-0-560" href="#__codelineno-0-560"></a>        }).round(2)
</span><span id="__span-0-561"><a id="__codelineno-0-561" name="__codelineno-0-561" href="#__codelineno-0-561"></a>
</span><span id="__span-0-562"><a id="__codelineno-0-562" name="__codelineno-0-562" href="#__codelineno-0-562"></a>        # Flatten column names
</span><span id="__span-0-563"><a id="__codelineno-0-563" name="__codelineno-0-563" href="#__codelineno-0-563"></a>        summary.columns = [&#39;total_builds&#39;, &#39;successful_builds&#39;, &#39;failed_builds&#39;, &#39;first_build&#39;, &#39;last_build&#39;]
</span><span id="__span-0-564"><a id="__codelineno-0-564" name="__codelineno-0-564" href="#__codelineno-0-564"></a>
</span><span id="__span-0-565"><a id="__codelineno-0-565" name="__codelineno-0-565" href="#__codelineno-0-565"></a>        # Calculate success rate
</span><span id="__span-0-566"><a id="__codelineno-0-566" name="__codelineno-0-566" href="#__codelineno-0-566"></a>        summary[&#39;success_rate&#39;] = (summary[&#39;successful_builds&#39;] / summary[&#39;total_builds&#39;] * 100).round(2)
</span><span id="__span-0-567"><a id="__codelineno-0-567" name="__codelineno-0-567" href="#__codelineno-0-567"></a>        summary[&#39;failure_rate&#39;] = (summary[&#39;failed_builds&#39;] / summary[&#39;total_builds&#39;] * 100).round(2)
</span><span id="__span-0-568"><a id="__codelineno-0-568" name="__codelineno-0-568" href="#__codelineno-0-568"></a>
</span><span id="__span-0-569"><a id="__codelineno-0-569" name="__codelineno-0-569" href="#__codelineno-0-569"></a>        # Reset index to make grouping columns regular columns
</span><span id="__span-0-570"><a id="__codelineno-0-570" name="__codelineno-0-570" href="#__codelineno-0-570"></a>        summary = summary.reset_index()
</span><span id="__span-0-571"><a id="__codelineno-0-571" name="__codelineno-0-571" href="#__codelineno-0-571"></a>
</span><span id="__span-0-572"><a id="__codelineno-0-572" name="__codelineno-0-572" href="#__codelineno-0-572"></a>        # Sort by application code, then by total builds (descending)
</span><span id="__span-0-573"><a id="__codelineno-0-573" name="__codelineno-0-573" href="#__codelineno-0-573"></a>        summary = summary.sort_values([&#39;application_code&#39;, &#39;total_builds&#39;], ascending=[True, False])
</span><span id="__span-0-574"><a id="__codelineno-0-574" name="__codelineno-0-574" href="#__codelineno-0-574"></a>
</span><span id="__span-0-575"><a id="__codelineno-0-575" name="__codelineno-0-575" href="#__codelineno-0-575"></a>        return summary
</span><span id="__span-0-576"><a id="__codelineno-0-576" name="__codelineno-0-576" href="#__codelineno-0-576"></a>
</span><span id="__span-0-577"><a id="__codelineno-0-577" name="__codelineno-0-577" href="#__codelineno-0-577"></a>    def save_results(self, df: pd.DataFrame, summary: pd.DataFrame, output_prefix: str = &#39;teamcity_analysis&#39;):
</span><span id="__span-0-578"><a id="__codelineno-0-578" name="__codelineno-0-578" href="#__codelineno-0-578"></a>        &quot;&quot;&quot;
</span><span id="__span-0-579"><a id="__codelineno-0-579" name="__codelineno-0-579" href="#__codelineno-0-579"></a>        Save results to CSV files and formatted Excel file
</span><span id="__span-0-580"><a id="__codelineno-0-580" name="__codelineno-0-580" href="#__codelineno-0-580"></a>
</span><span id="__span-0-581"><a id="__codelineno-0-581" name="__codelineno-0-581" href="#__codelineno-0-581"></a>        Args:
</span><span id="__span-0-582"><a id="__codelineno-0-582" name="__codelineno-0-582" href="#__codelineno-0-582"></a>            df: Detailed build data
</span><span id="__span-0-583"><a id="__codelineno-0-583" name="__codelineno-0-583" href="#__codelineno-0-583"></a>            summary: Summary statistics
</span><span id="__span-0-584"><a id="__codelineno-0-584" name="__codelineno-0-584" href="#__codelineno-0-584"></a>            output_prefix: Prefix for output files
</span><span id="__span-0-585"><a id="__codelineno-0-585" name="__codelineno-0-585" href="#__codelineno-0-585"></a>        &quot;&quot;&quot;
</span><span id="__span-0-586"><a id="__codelineno-0-586" name="__codelineno-0-586" href="#__codelineno-0-586"></a>        timestamp = datetime.now().strftime(&#39;%Y%m%d_%H%M%S&#39;)
</span><span id="__span-0-587"><a id="__codelineno-0-587" name="__codelineno-0-587" href="#__codelineno-0-587"></a>
</span><span id="__span-0-588"><a id="__codelineno-0-588" name="__codelineno-0-588" href="#__codelineno-0-588"></a>        # Save detailed data
</span><span id="__span-0-589"><a id="__codelineno-0-589" name="__codelineno-0-589" href="#__codelineno-0-589"></a>        detailed_file = f&quot;{output_prefix}_detailed_{timestamp}.csv&quot;
</span><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590" href="#__codelineno-0-590"></a>        df.to_csv(detailed_file, index=False)
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591" href="#__codelineno-0-591"></a>        print(f&quot;Detailed data saved to: {detailed_file}&quot;)
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592" href="#__codelineno-0-592"></a>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593" href="#__codelineno-0-593"></a>        # Save summary data
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594" href="#__codelineno-0-594"></a>        summary_file = f&quot;{output_prefix}_summary_{timestamp}.csv&quot;
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595" href="#__codelineno-0-595"></a>        summary.to_csv(summary_file, index=False)
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596" href="#__codelineno-0-596"></a>        print(f&quot;Summary data saved to: {summary_file}&quot;)
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597" href="#__codelineno-0-597"></a>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598" href="#__codelineno-0-598"></a>        # Save formatted Excel file
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599" href="#__codelineno-0-599"></a>        excel_file = f&quot;{output_prefix}_report_{timestamp}.xlsx&quot;
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600" href="#__codelineno-0-600"></a>        self.create_excel_report(df, summary, excel_file)
</span><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601" href="#__codelineno-0-601"></a>        print(f&quot;Formatted Excel report saved to: {excel_file}&quot;)
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602" href="#__codelineno-0-602"></a>
</span><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603" href="#__codelineno-0-603"></a>        return detailed_file, summary_file, excel_file
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604" href="#__codelineno-0-604"></a>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605" href="#__codelineno-0-605"></a>    def create_excel_report(self, df: pd.DataFrame, summary: pd.DataFrame, filename: str):
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606" href="#__codelineno-0-606"></a>        &quot;&quot;&quot;
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607" href="#__codelineno-0-607"></a>        Create a beautifully formatted Excel report with multiple sheets
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608" href="#__codelineno-0-608"></a>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609" href="#__codelineno-0-609"></a>        Args:
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610" href="#__codelineno-0-610"></a>            df: Detailed build data
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611" href="#__codelineno-0-611"></a>            summary: Summary statistics
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612" href="#__codelineno-0-612"></a>            filename: Output Excel filename
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613" href="#__codelineno-0-613"></a>        &quot;&quot;&quot;
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614" href="#__codelineno-0-614"></a>        wb = Workbook()
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615" href="#__codelineno-0-615"></a>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616" href="#__codelineno-0-616"></a>        # Remove default sheet
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617" href="#__codelineno-0-617"></a>        wb.remove(wb.active)
</span><span id="__span-0-618"><a id="__codelineno-0-618" name="__codelineno-0-618" href="#__codelineno-0-618"></a>
</span><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619" href="#__codelineno-0-619"></a>        # Create sheets
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620" href="#__codelineno-0-620"></a>        self._create_executive_summary_sheet(wb, df, summary)  # **NEW: Make this first**
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621" href="#__codelineno-0-621"></a>        self._create_overview_sheet(wb, df, summary)
</span><span id="__span-0-622"><a id="__codelineno-0-622" name="__codelineno-0-622" href="#__codelineno-0-622"></a>        self._create_summary_sheet(wb, summary)
</span><span id="__span-0-623"><a id="__codelineno-0-623" name="__codelineno-0-623" href="#__codelineno-0-623"></a>        self._create_detailed_sheet(wb, df)
</span><span id="__span-0-624"><a id="__codelineno-0-624" name="__codelineno-0-624" href="#__codelineno-0-624"></a>        self._create_charts_sheet(wb, summary)
</span><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625" href="#__codelineno-0-625"></a>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626" href="#__codelineno-0-626"></a>        # Save workbook
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627" href="#__codelineno-0-627"></a>        wb.save(filename)
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628" href="#__codelineno-0-628"></a>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629" href="#__codelineno-0-629"></a>    def _create_executive_summary_sheet(self, wb: Workbook, df: pd.DataFrame, summary: pd.DataFrame):
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630" href="#__codelineno-0-630"></a>        &quot;&quot;&quot;
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631" href="#__codelineno-0-631"></a>        **NEW METHOD: Create executive summary sheet by project filter**
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632" href="#__codelineno-0-632"></a>        &quot;&quot;&quot;
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633" href="#__codelineno-0-633"></a>        ws = wb.create_sheet(&quot;🎯 Executive Summary&quot;, 0)  # Make it the first sheet (index 0)
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634" href="#__codelineno-0-634"></a>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635" href="#__codelineno-0-635"></a>        # Title
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636" href="#__codelineno-0-636"></a>        ws[&#39;A1&#39;] = &quot;Executive Summary - Build Analysis by Project Filter&quot;
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637" href="#__codelineno-0-637"></a>        ws[&#39;A1&#39;].font = Font(size=18, bold=True, color=&quot;2E4057&quot;)
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638" href="#__codelineno-0-638"></a>        ws[&#39;A2&#39;] = f&quot;Analysis Period: Last 30 Days ({datetime.now().strftime(&#39;%Y-%m-%d&#39;)})&quot;
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639" href="#__codelineno-0-639"></a>        ws[&#39;A2&#39;].font = Font(size=12, italic=True)
</span><span id="__span-0-640"><a id="__codelineno-0-640" name="__codelineno-0-640" href="#__codelineno-0-640"></a>
</span><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641" href="#__codelineno-0-641"></a>        # Check if we have the required columns
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642" href="#__codelineno-0-642"></a>        if &#39;matched_filter&#39; not in df.columns:
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643" href="#__codelineno-0-643"></a>            ws[&#39;A4&#39;] = &quot;Error: Build analysis data incomplete. Please regenerate the report.&quot;
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644" href="#__codelineno-0-644"></a>            ws[&#39;A4&#39;].font = Font(size=12, color=&quot;FF0000&quot;, bold=True)
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645" href="#__codelineno-0-645"></a>            return
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646" href="#__codelineno-0-646"></a>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647" href="#__codelineno-0-647"></a>        # Group by matched filter to get summary statistics
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648" href="#__codelineno-0-648"></a>        filter_summary = df.groupby(&#39;matched_filter&#39;).agg({
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649" href="#__codelineno-0-649"></a>            &#39;build_id&#39;: &#39;count&#39;,  # Total builds
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650" href="#__codelineno-0-650"></a>            &#39;is_successful&#39;: &#39;sum&#39;,  # Successful builds
</span><span id="__span-0-651"><a id="__codelineno-0-651" name="__codelineno-0-651" href="#__codelineno-0-651"></a>            &#39;is_failed&#39;: &#39;sum&#39;,  # Failed builds
</span><span id="__span-0-652"><a id="__codelineno-0-652" name="__codelineno-0-652" href="#__codelineno-0-652"></a>            &#39;build_duration_minutes&#39;: [&#39;mean&#39;, &#39;median&#39;]  # Average build time
</span><span id="__span-0-653"><a id="__codelineno-0-653" name="__codelineno-0-653" href="#__codelineno-0-653"></a>        }).round(2)
</span><span id="__span-0-654"><a id="__codelineno-0-654" name="__codelineno-0-654" href="#__codelineno-0-654"></a>
</span><span id="__span-0-655"><a id="__codelineno-0-655" name="__codelineno-0-655" href="#__codelineno-0-655"></a>        # Flatten column names
</span><span id="__span-0-656"><a id="__codelineno-0-656" name="__codelineno-0-656" href="#__codelineno-0-656"></a>        filter_summary.columns = [&#39;total_builds&#39;, &#39;successful_builds&#39;, &#39;failed_builds&#39;, &#39;avg_build_time_minutes&#39;, &#39;median_build_time_minutes&#39;]
</span><span id="__span-0-657"><a id="__codelineno-0-657" name="__codelineno-0-657" href="#__codelineno-0-657"></a>
</span><span id="__span-0-658"><a id="__codelineno-0-658" name="__codelineno-0-658" href="#__codelineno-0-658"></a>        # Calculate rates
</span><span id="__span-0-659"><a id="__codelineno-0-659" name="__codelineno-0-659" href="#__codelineno-0-659"></a>        filter_summary[&#39;success_rate&#39;] = (filter_summary[&#39;successful_builds&#39;] / filter_summary[&#39;total_builds&#39;] * 100).round(1)
</span><span id="__span-0-660"><a id="__codelineno-0-660" name="__codelineno-0-660" href="#__codelineno-0-660"></a>        filter_summary[&#39;failure_rate&#39;] = (filter_summary[&#39;failed_builds&#39;] / filter_summary[&#39;total_builds&#39;] * 100).round(1)
</span><span id="__span-0-661"><a id="__codelineno-0-661" name="__codelineno-0-661" href="#__codelineno-0-661"></a>
</span><span id="__span-0-662"><a id="__codelineno-0-662" name="__codelineno-0-662" href="#__codelineno-0-662"></a>        # Reset index to make matched_filter a regular column
</span><span id="__span-0-663"><a id="__codelineno-0-663" name="__codelineno-0-663" href="#__codelineno-0-663"></a>        filter_summary = filter_summary.reset_index()
</span><span id="__span-0-664"><a id="__codelineno-0-664" name="__codelineno-0-664" href="#__codelineno-0-664"></a>
</span><span id="__span-0-665"><a id="__codelineno-0-665" name="__codelineno-0-665" href="#__codelineno-0-665"></a>        # Sort by total builds (descending)
</span><span id="__span-0-666"><a id="__codelineno-0-666" name="__codelineno-0-666" href="#__codelineno-0-666"></a>        filter_summary = filter_summary.sort_values(&#39;total_builds&#39;, ascending=False)
</span><span id="__span-0-667"><a id="__codelineno-0-667" name="__codelineno-0-667" href="#__codelineno-0-667"></a>
</span><span id="__span-0-668"><a id="__codelineno-0-668" name="__codelineno-0-668" href="#__codelineno-0-668"></a>        # Create the table
</span><span id="__span-0-669"><a id="__codelineno-0-669" name="__codelineno-0-669" href="#__codelineno-0-669"></a>        start_row = 5
</span><span id="__span-0-670"><a id="__codelineno-0-670" name="__codelineno-0-670" href="#__codelineno-0-670"></a>        headers = [
</span><span id="__span-0-671"><a id="__codelineno-0-671" name="__codelineno-0-671" href="#__codelineno-0-671"></a>            &quot;Project Filter&quot;,
</span><span id="__span-0-672"><a id="__codelineno-0-672" name="__codelineno-0-672" href="#__codelineno-0-672"></a>            &quot;Total Builds&quot;, 
</span><span id="__span-0-673"><a id="__codelineno-0-673" name="__codelineno-0-673" href="#__codelineno-0-673"></a>            &quot;Successful&quot;,
</span><span id="__span-0-674"><a id="__codelineno-0-674" name="__codelineno-0-674" href="#__codelineno-0-674"></a>            &quot;Failed&quot;,
</span><span id="__span-0-675"><a id="__codelineno-0-675" name="__codelineno-0-675" href="#__codelineno-0-675"></a>            &quot;Success Rate (%)&quot;,
</span><span id="__span-0-676"><a id="__codelineno-0-676" name="__codelineno-0-676" href="#__codelineno-0-676"></a>            &quot;Failure Rate (%)&quot;,
</span><span id="__span-0-677"><a id="__codelineno-0-677" name="__codelineno-0-677" href="#__codelineno-0-677"></a>            &quot;Avg Build Time (min)&quot;,
</span><span id="__span-0-678"><a id="__codelineno-0-678" name="__codelineno-0-678" href="#__codelineno-0-678"></a>            &quot;Median Build Time (min)&quot;
</span><span id="__span-0-679"><a id="__codelineno-0-679" name="__codelineno-0-679" href="#__codelineno-0-679"></a>        ]
</span><span id="__span-0-680"><a id="__codelineno-0-680" name="__codelineno-0-680" href="#__codelineno-0-680"></a>
</span><span id="__span-0-681"><a id="__codelineno-0-681" name="__codelineno-0-681" href="#__codelineno-0-681"></a>        # Write headers
</span><span id="__span-0-682"><a id="__codelineno-0-682" name="__codelineno-0-682" href="#__codelineno-0-682"></a>        for j, header in enumerate(headers):
</span><span id="__span-0-683"><a id="__codelineno-0-683" name="__codelineno-0-683" href="#__codelineno-0-683"></a>            cell = ws.cell(row=start_row, column=j + 1, value=header)
</span><span id="__span-0-684"><a id="__codelineno-0-684" name="__codelineno-0-684" href="#__codelineno-0-684"></a>            cell.font = Font(bold=True, color=&quot;FFFFFF&quot;)
</span><span id="__span-0-685"><a id="__codelineno-0-685" name="__codelineno-0-685" href="#__codelineno-0-685"></a>            cell.fill = PatternFill(start_color=&quot;2E4057&quot;, end_color=&quot;2E4057&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-686"><a id="__codelineno-0-686" name="__codelineno-0-686" href="#__codelineno-0-686"></a>            cell.alignment = Alignment(horizontal=&#39;center&#39;, vertical=&#39;center&#39;)
</span><span id="__span-0-687"><a id="__codelineno-0-687" name="__codelineno-0-687" href="#__codelineno-0-687"></a>            cell.border = Border(
</span><span id="__span-0-688"><a id="__codelineno-0-688" name="__codelineno-0-688" href="#__codelineno-0-688"></a>                left=Side(style=&#39;thin&#39;),
</span><span id="__span-0-689"><a id="__codelineno-0-689" name="__codelineno-0-689" href="#__codelineno-0-689"></a>                right=Side(style=&#39;thin&#39;),
</span><span id="__span-0-690"><a id="__codelineno-0-690" name="__codelineno-0-690" href="#__codelineno-0-690"></a>                top=Side(style=&#39;thin&#39;),
</span><span id="__span-0-691"><a id="__codelineno-0-691" name="__codelineno-0-691" href="#__codelineno-0-691"></a>                bottom=Side(style=&#39;thin&#39;)
</span><span id="__span-0-692"><a id="__codelineno-0-692" name="__codelineno-0-692" href="#__codelineno-0-692"></a>            )
</span><span id="__span-0-693"><a id="__codelineno-0-693" name="__codelineno-0-693" href="#__codelineno-0-693"></a>
</span><span id="__span-0-694"><a id="__codelineno-0-694" name="__codelineno-0-694" href="#__codelineno-0-694"></a>        # Write data rows
</span><span id="__span-0-695"><a id="__codelineno-0-695" name="__codelineno-0-695" href="#__codelineno-0-695"></a>        for i, (_, row) in enumerate(filter_summary.iterrows()):
</span><span id="__span-0-696"><a id="__codelineno-0-696" name="__codelineno-0-696" href="#__codelineno-0-696"></a>            row_data = [
</span><span id="__span-0-697"><a id="__codelineno-0-697" name="__codelineno-0-697" href="#__codelineno-0-697"></a>                row[&#39;matched_filter&#39;],
</span><span id="__span-0-698"><a id="__codelineno-0-698" name="__codelineno-0-698" href="#__codelineno-0-698"></a>                row[&#39;total_builds&#39;],
</span><span id="__span-0-699"><a id="__codelineno-0-699" name="__codelineno-0-699" href="#__codelineno-0-699"></a>                row[&#39;successful_builds&#39;],
</span><span id="__span-0-700"><a id="__codelineno-0-700" name="__codelineno-0-700" href="#__codelineno-0-700"></a>                row[&#39;failed_builds&#39;],
</span><span id="__span-0-701"><a id="__codelineno-0-701" name="__codelineno-0-701" href="#__codelineno-0-701"></a>                f&quot;{row[&#39;success_rate&#39;]:.1f}%&quot;,
</span><span id="__span-0-702"><a id="__codelineno-0-702" name="__codelineno-0-702" href="#__codelineno-0-702"></a>                f&quot;{row[&#39;failure_rate&#39;]:.1f}%&quot;,
</span><span id="__span-0-703"><a id="__codelineno-0-703" name="__codelineno-0-703" href="#__codelineno-0-703"></a>                f&quot;{row[&#39;avg_build_time_minutes&#39;]:.1f}&quot; if pd.notna(row[&#39;avg_build_time_minutes&#39;]) else &quot;N/A&quot;,
</span><span id="__span-0-704"><a id="__codelineno-0-704" name="__codelineno-0-704" href="#__codelineno-0-704"></a>                f&quot;{row[&#39;median_build_time_minutes&#39;]:.1f}&quot; if pd.notna(row[&#39;median_build_time_minutes&#39;]) else &quot;N/A&quot;
</span><span id="__span-0-705"><a id="__codelineno-0-705" name="__codelineno-0-705" href="#__codelineno-0-705"></a>            ]
</span><span id="__span-0-706"><a id="__codelineno-0-706" name="__codelineno-0-706" href="#__codelineno-0-706"></a>
</span><span id="__span-0-707"><a id="__codelineno-0-707" name="__codelineno-0-707" href="#__codelineno-0-707"></a>            for j, value in enumerate(row_data):
</span><span id="__span-0-708"><a id="__codelineno-0-708" name="__codelineno-0-708" href="#__codelineno-0-708"></a>                cell = ws.cell(row=start_row + 1 + i, column=j + 1, value=value)
</span><span id="__span-0-709"><a id="__codelineno-0-709" name="__codelineno-0-709" href="#__codelineno-0-709"></a>                cell.border = Border(
</span><span id="__span-0-710"><a id="__codelineno-0-710" name="__codelineno-0-710" href="#__codelineno-0-710"></a>                    left=Side(style=&#39;thin&#39;),
</span><span id="__span-0-711"><a id="__codelineno-0-711" name="__codelineno-0-711" href="#__codelineno-0-711"></a>                    right=Side(style=&#39;thin&#39;),
</span><span id="__span-0-712"><a id="__codelineno-0-712" name="__codelineno-0-712" href="#__codelineno-0-712"></a>                    top=Side(style=&#39;thin&#39;),
</span><span id="__span-0-713"><a id="__codelineno-0-713" name="__codelineno-0-713" href="#__codelineno-0-713"></a>                    bottom=Side(style=&#39;thin&#39;)
</span><span id="__span-0-714"><a id="__codelineno-0-714" name="__codelineno-0-714" href="#__codelineno-0-714"></a>                )
</span><span id="__span-0-715"><a id="__codelineno-0-715" name="__codelineno-0-715" href="#__codelineno-0-715"></a>                cell.alignment = Alignment(horizontal=&#39;center&#39;, vertical=&#39;center&#39;)
</span><span id="__span-0-716"><a id="__codelineno-0-716" name="__codelineno-0-716" href="#__codelineno-0-716"></a>
</span><span id="__span-0-717"><a id="__codelineno-0-717" name="__codelineno-0-717" href="#__codelineno-0-717"></a>                # Color code success rate column
</span><span id="__span-0-718"><a id="__codelineno-0-718" name="__codelineno-0-718" href="#__codelineno-0-718"></a>                if j == 4:  # Success rate column
</span><span id="__span-0-719"><a id="__codelineno-0-719" name="__codelineno-0-719" href="#__codelineno-0-719"></a>                    success_rate = row[&#39;success_rate&#39;]
</span><span id="__span-0-720"><a id="__codelineno-0-720" name="__codelineno-0-720" href="#__codelineno-0-720"></a>                    if success_rate &gt;= 90:
</span><span id="__span-0-721"><a id="__codelineno-0-721" name="__codelineno-0-721" href="#__codelineno-0-721"></a>                        cell.fill = PatternFill(start_color=&quot;C6EFCE&quot;, end_color=&quot;C6EFCE&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-722"><a id="__codelineno-0-722" name="__codelineno-0-722" href="#__codelineno-0-722"></a>                    elif success_rate &gt;= 70:
</span><span id="__span-0-723"><a id="__codelineno-0-723" name="__codelineno-0-723" href="#__codelineno-0-723"></a>                        cell.fill = PatternFill(start_color=&quot;FFEB9C&quot;, end_color=&quot;FFEB9C&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-724"><a id="__codelineno-0-724" name="__codelineno-0-724" href="#__codelineno-0-724"></a>                    else:
</span><span id="__span-0-725"><a id="__codelineno-0-725" name="__codelineno-0-725" href="#__codelineno-0-725"></a>                        cell.fill = PatternFill(start_color=&quot;FFC7CE&quot;, end_color=&quot;FFC7CE&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-726"><a id="__codelineno-0-726" name="__codelineno-0-726" href="#__codelineno-0-726"></a>
</span><span id="__span-0-727"><a id="__codelineno-0-727" name="__codelineno-0-727" href="#__codelineno-0-727"></a>        # Add summary totals at the bottom
</span><span id="__span-0-728"><a id="__codelineno-0-728" name="__codelineno-0-728" href="#__codelineno-0-728"></a>        total_row = start_row + len(filter_summary) + 2
</span><span id="__span-0-729"><a id="__codelineno-0-729" name="__codelineno-0-729" href="#__codelineno-0-729"></a>        ws.cell(row=total_row, column=1, value=&quot;OVERALL TOTALS:&quot;).font = Font(bold=True, size=12)
</span><span id="__span-0-730"><a id="__codelineno-0-730" name="__codelineno-0-730" href="#__codelineno-0-730"></a>
</span><span id="__span-0-731"><a id="__codelineno-0-731" name="__codelineno-0-731" href="#__codelineno-0-731"></a>        overall_total_builds = filter_summary[&#39;total_builds&#39;].sum()
</span><span id="__span-0-732"><a id="__codelineno-0-732" name="__codelineno-0-732" href="#__codelineno-0-732"></a>        overall_successful = filter_summary[&#39;successful_builds&#39;].sum()
</span><span id="__span-0-733"><a id="__codelineno-0-733" name="__codelineno-0-733" href="#__codelineno-0-733"></a>        overall_failed = filter_summary[&#39;failed_builds&#39;].sum()
</span><span id="__span-0-734"><a id="__codelineno-0-734" name="__codelineno-0-734" href="#__codelineno-0-734"></a>        overall_success_rate = (overall_successful / overall_total_builds * 100) if overall_total_builds &gt; 0 else 0
</span><span id="__span-0-735"><a id="__codelineno-0-735" name="__codelineno-0-735" href="#__codelineno-0-735"></a>
</span><span id="__span-0-736"><a id="__codelineno-0-736" name="__codelineno-0-736" href="#__codelineno-0-736"></a>        # Calculate weighted average build time
</span><span id="__span-0-737"><a id="__codelineno-0-737" name="__codelineno-0-737" href="#__codelineno-0-737"></a>        total_build_time = 0
</span><span id="__span-0-738"><a id="__codelineno-0-738" name="__codelineno-0-738" href="#__codelineno-0-738"></a>        total_builds_with_time = 0
</span><span id="__span-0-739"><a id="__codelineno-0-739" name="__codelineno-0-739" href="#__codelineno-0-739"></a>        for _, row in filter_summary.iterrows():
</span><span id="__span-0-740"><a id="__codelineno-0-740" name="__codelineno-0-740" href="#__codelineno-0-740"></a>            if pd.notna(row[&#39;avg_build_time_minutes&#39;]):
</span><span id="__span-0-741"><a id="__codelineno-0-741" name="__codelineno-0-741" href="#__codelineno-0-741"></a>                total_build_time += row[&#39;avg_build_time_minutes&#39;] * row[&#39;total_builds&#39;]
</span><span id="__span-0-742"><a id="__codelineno-0-742" name="__codelineno-0-742" href="#__codelineno-0-742"></a>                total_builds_with_time += row[&#39;total_builds&#39;]
</span><span id="__span-0-743"><a id="__codelineno-0-743" name="__codelineno-0-743" href="#__codelineno-0-743"></a>
</span><span id="__span-0-744"><a id="__codelineno-0-744" name="__codelineno-0-744" href="#__codelineno-0-744"></a>        overall_avg_build_time = total_build_time / total_builds_with_time if total_builds_with_time &gt; 0 else 0
</span><span id="__span-0-745"><a id="__codelineno-0-745" name="__codelineno-0-745" href="#__codelineno-0-745"></a>
</span><span id="__span-0-746"><a id="__codelineno-0-746" name="__codelineno-0-746" href="#__codelineno-0-746"></a>        totals_data = [
</span><span id="__span-0-747"><a id="__codelineno-0-747" name="__codelineno-0-747" href="#__codelineno-0-747"></a>            [&quot;Total Builds:&quot;, overall_total_builds],
</span><span id="__span-0-748"><a id="__codelineno-0-748" name="__codelineno-0-748" href="#__codelineno-0-748"></a>            [&quot;Total Successful:&quot;, f&quot;{overall_successful} ({overall_success_rate:.1f}%)&quot;],
</span><span id="__span-0-749"><a id="__codelineno-0-749" name="__codelineno-0-749" href="#__codelineno-0-749"></a>            [&quot;Total Failed:&quot;, f&quot;{overall_failed} ({100-overall_success_rate:.1f}%)&quot;],
</span><span id="__span-0-750"><a id="__codelineno-0-750" name="__codelineno-0-750" href="#__codelineno-0-750"></a>            [&quot;Overall Avg Build Time:&quot;, f&quot;{overall_avg_build_time:.1f} minutes&quot; if overall_avg_build_time &gt; 0 else &quot;N/A&quot;]
</span><span id="__span-0-751"><a id="__codelineno-0-751" name="__codelineno-0-751" href="#__codelineno-0-751"></a>        ]
</span><span id="__span-0-752"><a id="__codelineno-0-752" name="__codelineno-0-752" href="#__codelineno-0-752"></a>
</span><span id="__span-0-753"><a id="__codelineno-0-753" name="__codelineno-0-753" href="#__codelineno-0-753"></a>        for i, (label, value) in enumerate(totals_data):
</span><span id="__span-0-754"><a id="__codelineno-0-754" name="__codelineno-0-754" href="#__codelineno-0-754"></a>            ws.cell(row=total_row + 1 + i, column=1, value=label).font = Font(bold=True)
</span><span id="__span-0-755"><a id="__codelineno-0-755" name="__codelineno-0-755" href="#__codelineno-0-755"></a>            ws.cell(row=total_row + 1 + i, column=2, value=value)
</span><span id="__span-0-756"><a id="__codelineno-0-756" name="__codelineno-0-756" href="#__codelineno-0-756"></a>
</span><span id="__span-0-757"><a id="__codelineno-0-757" name="__codelineno-0-757" href="#__codelineno-0-757"></a>        # Auto-adjust column widths
</span><span id="__span-0-758"><a id="__codelineno-0-758" name="__codelineno-0-758" href="#__codelineno-0-758"></a>        for column in ws.columns:
</span><span id="__span-0-759"><a id="__codelineno-0-759" name="__codelineno-0-759" href="#__codelineno-0-759"></a>            max_length = 0
</span><span id="__span-0-760"><a id="__codelineno-0-760" name="__codelineno-0-760" href="#__codelineno-0-760"></a>            column_letter = column[0].column_letter
</span><span id="__span-0-761"><a id="__codelineno-0-761" name="__codelineno-0-761" href="#__codelineno-0-761"></a>            for cell in column:
</span><span id="__span-0-762"><a id="__codelineno-0-762" name="__codelineno-0-762" href="#__codelineno-0-762"></a>                try:
</span><span id="__span-0-763"><a id="__codelineno-0-763" name="__codelineno-0-763" href="#__codelineno-0-763"></a>                    if len(str(cell.value)) &gt; max_length:
</span><span id="__span-0-764"><a id="__codelineno-0-764" name="__codelineno-0-764" href="#__codelineno-0-764"></a>                        max_length = len(str(cell.value))
</span><span id="__span-0-765"><a id="__codelineno-0-765" name="__codelineno-0-765" href="#__codelineno-0-765"></a>                except:
</span><span id="__span-0-766"><a id="__codelineno-0-766" name="__codelineno-0-766" href="#__codelineno-0-766"></a>                    pass
</span><span id="__span-0-767"><a id="__codelineno-0-767" name="__codelineno-0-767" href="#__codelineno-0-767"></a>            adjusted_width = min(max_length + 2, 50)
</span><span id="__span-0-768"><a id="__codelineno-0-768" name="__codelineno-0-768" href="#__codelineno-0-768"></a>            ws.column_dimensions[column_letter].width = adjusted_width
</span><span id="__span-0-769"><a id="__codelineno-0-769" name="__codelineno-0-769" href="#__codelineno-0-769"></a>
</span><span id="__span-0-770"><a id="__codelineno-0-770" name="__codelineno-0-770" href="#__codelineno-0-770"></a>    def _create_overview_sheet(self, wb: Workbook, df: pd.DataFrame, summary: pd.DataFrame):
</span><span id="__span-0-771"><a id="__codelineno-0-771" name="__codelineno-0-771" href="#__codelineno-0-771"></a>        &quot;&quot;&quot;Create overview sheet with key metrics&quot;&quot;&quot;
</span><span id="__span-0-772"><a id="__codelineno-0-772" name="__codelineno-0-772" href="#__codelineno-0-772"></a>        ws = wb.create_sheet(&quot;📊 Overview&quot;, 0)
</span><span id="__span-0-773"><a id="__codelineno-0-773" name="__codelineno-0-773" href="#__codelineno-0-773"></a>
</span><span id="__span-0-774"><a id="__codelineno-0-774" name="__codelineno-0-774" href="#__codelineno-0-774"></a>        # Title
</span><span id="__span-0-775"><a id="__codelineno-0-775" name="__codelineno-0-775" href="#__codelineno-0-775"></a>        ws[&#39;A1&#39;] = &quot;TeamCity Build Analysis Report&quot;
</span><span id="__span-0-776"><a id="__codelineno-0-776" name="__codelineno-0-776" href="#__codelineno-0-776"></a>        ws[&#39;A1&#39;].font = Font(size=20, bold=True, color=&quot;2E4057&quot;)
</span><span id="__span-0-777"><a id="__codelineno-0-777" name="__codelineno-0-777" href="#__codelineno-0-777"></a>        ws[&#39;A2&#39;] = f&quot;Analysis Period: Last 30 Days ({datetime.now().strftime(&#39;%Y-%m-%d&#39;)})&quot;
</span><span id="__span-0-778"><a id="__codelineno-0-778" name="__codelineno-0-778" href="#__codelineno-0-778"></a>        ws[&#39;A2&#39;].font = Font(size=12, italic=True)
</span><span id="__span-0-779"><a id="__codelineno-0-779" name="__codelineno-0-779" href="#__codelineno-0-779"></a>
</span><span id="__span-0-780"><a id="__codelineno-0-780" name="__codelineno-0-780" href="#__codelineno-0-780"></a>        # Key metrics
</span><span id="__span-0-781"><a id="__codelineno-0-781" name="__codelineno-0-781" href="#__codelineno-0-781"></a>        total_apps = summary[&#39;application_code&#39;].nunique()
</span><span id="__span-0-782"><a id="__codelineno-0-782" name="__codelineno-0-782" href="#__codelineno-0-782"></a>        total_build_types = len(summary)
</span><span id="__span-0-783"><a id="__codelineno-0-783" name="__codelineno-0-783" href="#__codelineno-0-783"></a>        total_builds = summary[&#39;total_builds&#39;].sum()
</span><span id="__span-0-784"><a id="__codelineno-0-784" name="__codelineno-0-784" href="#__codelineno-0-784"></a>        total_successful = summary[&#39;successful_builds&#39;].sum()
</span><span id="__span-0-785"><a id="__codelineno-0-785" name="__codelineno-0-785" href="#__codelineno-0-785"></a>        total_failed = summary[&#39;failed_builds&#39;].sum()
</span><span id="__span-0-786"><a id="__codelineno-0-786" name="__codelineno-0-786" href="#__codelineno-0-786"></a>        overall_success_rate = (total_successful / total_builds * 100) if total_builds &gt; 0 else 0
</span><span id="__span-0-787"><a id="__codelineno-0-787" name="__codelineno-0-787" href="#__codelineno-0-787"></a>
</span><span id="__span-0-788"><a id="__codelineno-0-788" name="__codelineno-0-788" href="#__codelineno-0-788"></a>        # Metrics table
</span><span id="__span-0-789"><a id="__codelineno-0-789" name="__codelineno-0-789" href="#__codelineno-0-789"></a>        metrics_data = [
</span><span id="__span-0-790"><a id="__codelineno-0-790" name="__codelineno-0-790" href="#__codelineno-0-790"></a>            [&quot;Metric&quot;, &quot;Value&quot;],
</span><span id="__span-0-791"><a id="__codelineno-0-791" name="__codelineno-0-791" href="#__codelineno-0-791"></a>            [&quot;Total Applications&quot;, total_apps],
</span><span id="__span-0-792"><a id="__codelineno-0-792" name="__codelineno-0-792" href="#__codelineno-0-792"></a>            [&quot;Total Build Types&quot;, total_build_types],
</span><span id="__span-0-793"><a id="__codelineno-0-793" name="__codelineno-0-793" href="#__codelineno-0-793"></a>            [&quot;Total Builds&quot;, total_builds],
</span><span id="__span-0-794"><a id="__codelineno-0-794" name="__codelineno-0-794" href="#__codelineno-0-794"></a>            [&quot;Successful Builds&quot;, f&quot;{total_successful} ({overall_success_rate:.1f}%)&quot;],
</span><span id="__span-0-795"><a id="__codelineno-0-795" name="__codelineno-0-795" href="#__codelineno-0-795"></a>            [&quot;Failed Builds&quot;, f&quot;{total_failed} ({100-overall_success_rate:.1f}%)&quot;],
</span><span id="__span-0-796"><a id="__codelineno-0-796" name="__codelineno-0-796" href="#__codelineno-0-796"></a>            [&quot;Overall Success Rate&quot;, f&quot;{overall_success_rate:.1f}%&quot;]
</span><span id="__span-0-797"><a id="__codelineno-0-797" name="__codelineno-0-797" href="#__codelineno-0-797"></a>        ]
</span><span id="__span-0-798"><a id="__codelineno-0-798" name="__codelineno-0-798" href="#__codelineno-0-798"></a>
</span><span id="__span-0-799"><a id="__codelineno-0-799" name="__codelineno-0-799" href="#__codelineno-0-799"></a>        # Write metrics
</span><span id="__span-0-800"><a id="__codelineno-0-800" name="__codelineno-0-800" href="#__codelineno-0-800"></a>        start_row = 4
</span><span id="__span-0-801"><a id="__codelineno-0-801" name="__codelineno-0-801" href="#__codelineno-0-801"></a>        for i, row in enumerate(metrics_data):
</span><span id="__span-0-802"><a id="__codelineno-0-802" name="__codelineno-0-802" href="#__codelineno-0-802"></a>            for j, value in enumerate(row):
</span><span id="__span-0-803"><a id="__codelineno-0-803" name="__codelineno-0-803" href="#__codelineno-0-803"></a>                cell = ws.cell(row=start_row + i, column=j + 1, value=value)
</span><span id="__span-0-804"><a id="__codelineno-0-804" name="__codelineno-0-804" href="#__codelineno-0-804"></a>                if i == 0:  # Header row
</span><span id="__span-0-805"><a id="__codelineno-0-805" name="__codelineno-0-805" href="#__codelineno-0-805"></a>                    cell.font = Font(bold=True, color=&quot;FFFFFF&quot;)
</span><span id="__span-0-806"><a id="__codelineno-0-806" name="__codelineno-0-806" href="#__codelineno-0-806"></a>                    cell.fill = PatternFill(start_color=&quot;4472C4&quot;, end_color=&quot;4472C4&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-807"><a id="__codelineno-0-807" name="__codelineno-0-807" href="#__codelineno-0-807"></a>                elif j == 0:  # Metric names
</span><span id="__span-0-808"><a id="__codelineno-0-808" name="__codelineno-0-808" href="#__codelineno-0-808"></a>                    cell.font = Font(bold=True)
</span><span id="__span-0-809"><a id="__codelineno-0-809" name="__codelineno-0-809" href="#__codelineno-0-809"></a>
</span><span id="__span-0-810"><a id="__codelineno-0-810" name="__codelineno-0-810" href="#__codelineno-0-810"></a>                cell.border = Border(
</span><span id="__span-0-811"><a id="__codelineno-0-811" name="__codelineno-0-811" href="#__codelineno-0-811"></a>                    left=Side(style=&#39;thin&#39;),
</span><span id="__span-0-812"><a id="__codelineno-0-812" name="__codelineno-0-812" href="#__codelineno-0-812"></a>                    right=Side(style=&#39;thin&#39;),
</span><span id="__span-0-813"><a id="__codelineno-0-813" name="__codelineno-0-813" href="#__codelineno-0-813"></a>                    top=Side(style=&#39;thin&#39;),
</span><span id="__span-0-814"><a id="__codelineno-0-814" name="__codelineno-0-814" href="#__codelineno-0-814"></a>                    bottom=Side(style=&#39;thin&#39;)
</span><span id="__span-0-815"><a id="__codelineno-0-815" name="__codelineno-0-815" href="#__codelineno-0-815"></a>                )
</span><span id="__span-0-816"><a id="__codelineno-0-816" name="__codelineno-0-816" href="#__codelineno-0-816"></a>                cell.alignment = Alignment(horizontal=&#39;left&#39;, vertical=&#39;center&#39;)
</span><span id="__span-0-817"><a id="__codelineno-0-817" name="__codelineno-0-817" href="#__codelineno-0-817"></a>
</span><span id="__span-0-818"><a id="__codelineno-0-818" name="__codelineno-0-818" href="#__codelineno-0-818"></a>        # Top applications table
</span><span id="__span-0-819"><a id="__codelineno-0-819" name="__codelineno-0-819" href="#__codelineno-0-819"></a>        ws[&#39;A13&#39;] = &quot;Top 10 Applications by Build Volume&quot;
</span><span id="__span-0-820"><a id="__codelineno-0-820" name="__codelineno-0-820" href="#__codelineno-0-820"></a>        ws[&#39;A13&#39;].font = Font(size=14, bold=True, color=&quot;2E4057&quot;)
</span><span id="__span-0-821"><a id="__codelineno-0-821" name="__codelineno-0-821" href="#__codelineno-0-821"></a>
</span><span id="__span-0-822"><a id="__codelineno-0-822" name="__codelineno-0-822" href="#__codelineno-0-822"></a>        app_summary = summary.groupby(&#39;application_code&#39;).agg({
</span><span id="__span-0-823"><a id="__codelineno-0-823" name="__codelineno-0-823" href="#__codelineno-0-823"></a>            &#39;total_builds&#39;: &#39;sum&#39;,
</span><span id="__span-0-824"><a id="__codelineno-0-824" name="__codelineno-0-824" href="#__codelineno-0-824"></a>            &#39;successful_builds&#39;: &#39;sum&#39;,
</span><span id="__span-0-825"><a id="__codelineno-0-825" name="__codelineno-0-825" href="#__codelineno-0-825"></a>            &#39;failed_builds&#39;: &#39;sum&#39;
</span><span id="__span-0-826"><a id="__codelineno-0-826" name="__codelineno-0-826" href="#__codelineno-0-826"></a>        }).reset_index()
</span><span id="__span-0-827"><a id="__codelineno-0-827" name="__codelineno-0-827" href="#__codelineno-0-827"></a>        app_summary[&#39;success_rate&#39;] = (app_summary[&#39;successful_builds&#39;] / app_summary[&#39;total_builds&#39;] * 100).round(1)
</span><span id="__span-0-828"><a id="__codelineno-0-828" name="__codelineno-0-828" href="#__codelineno-0-828"></a>        app_summary = app_summary.sort_values(&#39;total_builds&#39;, ascending=False).head(10)
</span><span id="__span-0-829"><a id="__codelineno-0-829" name="__codelineno-0-829" href="#__codelineno-0-829"></a>
</span><span id="__span-0-830"><a id="__codelineno-0-830" name="__codelineno-0-830" href="#__codelineno-0-830"></a>        # Write top apps table
</span><span id="__span-0-831"><a id="__codelineno-0-831" name="__codelineno-0-831" href="#__codelineno-0-831"></a>        headers = [&quot;Application&quot;, &quot;Total Builds&quot;, &quot;Successful&quot;, &quot;Failed&quot;, &quot;Success Rate&quot;]
</span><span id="__span-0-832"><a id="__codelineno-0-832" name="__codelineno-0-832" href="#__codelineno-0-832"></a>        start_row = 15
</span><span id="__span-0-833"><a id="__codelineno-0-833" name="__codelineno-0-833" href="#__codelineno-0-833"></a>
</span><span id="__span-0-834"><a id="__codelineno-0-834" name="__codelineno-0-834" href="#__codelineno-0-834"></a>        for j, header in enumerate(headers):
</span><span id="__span-0-835"><a id="__codelineno-0-835" name="__codelineno-0-835" href="#__codelineno-0-835"></a>            cell = ws.cell(row=start_row, column=j + 1, value=header)
</span><span id="__span-0-836"><a id="__codelineno-0-836" name="__codelineno-0-836" href="#__codelineno-0-836"></a>            cell.font = Font(bold=True, color=&quot;FFFFFF&quot;)
</span><span id="__span-0-837"><a id="__codelineno-0-837" name="__codelineno-0-837" href="#__codelineno-0-837"></a>            cell.fill = PatternFill(start_color=&quot;70AD47&quot;, end_color=&quot;70AD47&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-838"><a id="__codelineno-0-838" name="__codelineno-0-838" href="#__codelineno-0-838"></a>            cell.alignment = Alignment(horizontal=&#39;center&#39;, vertical=&#39;center&#39;)
</span><span id="__span-0-839"><a id="__codelineno-0-839" name="__codelineno-0-839" href="#__codelineno-0-839"></a>            cell.border = Border(
</span><span id="__span-0-840"><a id="__codelineno-0-840" name="__codelineno-0-840" href="#__codelineno-0-840"></a>                left=Side(style=&#39;thin&#39;),
</span><span id="__span-0-841"><a id="__codelineno-0-841" name="__codelineno-0-841" href="#__codelineno-0-841"></a>                right=Side(style=&#39;thin&#39;),
</span><span id="__span-0-842"><a id="__codelineno-0-842" name="__codelineno-0-842" href="#__codelineno-0-842"></a>                top=Side(style=&#39;thin&#39;),
</span><span id="__span-0-843"><a id="__codelineno-0-843" name="__codelineno-0-843" href="#__codelineno-0-843"></a>                bottom=Side(style=&#39;thin&#39;)
</span><span id="__span-0-844"><a id="__codelineno-0-844" name="__codelineno-0-844" href="#__codelineno-0-844"></a>            )
</span><span id="__span-0-845"><a id="__codelineno-0-845" name="__codelineno-0-845" href="#__codelineno-0-845"></a>
</span><span id="__span-0-846"><a id="__codelineno-0-846" name="__codelineno-0-846" href="#__codelineno-0-846"></a>        for i, (_, row) in enumerate(app_summary.iterrows()):
</span><span id="__span-0-847"><a id="__codelineno-0-847" name="__codelineno-0-847" href="#__codelineno-0-847"></a>            row_data = [
</span><span id="__span-0-848"><a id="__codelineno-0-848" name="__codelineno-0-848" href="#__codelineno-0-848"></a>                row[&#39;application_code&#39;],
</span><span id="__span-0-849"><a id="__codelineno-0-849" name="__codelineno-0-849" href="#__codelineno-0-849"></a>                row[&#39;total_builds&#39;],
</span><span id="__span-0-850"><a id="__codelineno-0-850" name="__codelineno-0-850" href="#__codelineno-0-850"></a>                row[&#39;successful_builds&#39;],
</span><span id="__span-0-851"><a id="__codelineno-0-851" name="__codelineno-0-851" href="#__codelineno-0-851"></a>                row[&#39;failed_builds&#39;],
</span><span id="__span-0-852"><a id="__codelineno-0-852" name="__codelineno-0-852" href="#__codelineno-0-852"></a>                f&quot;{row[&#39;success_rate&#39;]:.1f}%&quot;
</span><span id="__span-0-853"><a id="__codelineno-0-853" name="__codelineno-0-853" href="#__codelineno-0-853"></a>            ]
</span><span id="__span-0-854"><a id="__codelineno-0-854" name="__codelineno-0-854" href="#__codelineno-0-854"></a>
</span><span id="__span-0-855"><a id="__codelineno-0-855" name="__codelineno-0-855" href="#__codelineno-0-855"></a>            for j, value in enumerate(row_data):
</span><span id="__span-0-856"><a id="__codelineno-0-856" name="__codelineno-0-856" href="#__codelineno-0-856"></a>                cell = ws.cell(row=start_row + 1 + i, column=j + 1, value=value)
</span><span id="__span-0-857"><a id="__codelineno-0-857" name="__codelineno-0-857" href="#__codelineno-0-857"></a>                cell.border = Border(
</span><span id="__span-0-858"><a id="__codelineno-0-858" name="__codelineno-0-858" href="#__codelineno-0-858"></a>                    left=Side(style=&#39;thin&#39;),
</span><span id="__span-0-859"><a id="__codelineno-0-859" name="__codelineno-0-859" href="#__codelineno-0-859"></a>                    right=Side(style=&#39;thin&#39;),
</span><span id="__span-0-860"><a id="__codelineno-0-860" name="__codelineno-0-860" href="#__codelineno-0-860"></a>                    top=Side(style=&#39;thin&#39;),
</span><span id="__span-0-861"><a id="__codelineno-0-861" name="__codelineno-0-861" href="#__codelineno-0-861"></a>                    bottom=Side(style=&#39;thin&#39;)
</span><span id="__span-0-862"><a id="__codelineno-0-862" name="__codelineno-0-862" href="#__codelineno-0-862"></a>                )
</span><span id="__span-0-863"><a id="__codelineno-0-863" name="__codelineno-0-863" href="#__codelineno-0-863"></a>                cell.alignment = Alignment(horizontal=&#39;center&#39;, vertical=&#39;center&#39;)
</span><span id="__span-0-864"><a id="__codelineno-0-864" name="__codelineno-0-864" href="#__codelineno-0-864"></a>
</span><span id="__span-0-865"><a id="__codelineno-0-865" name="__codelineno-0-865" href="#__codelineno-0-865"></a>                # Color code success rates
</span><span id="__span-0-866"><a id="__codelineno-0-866" name="__codelineno-0-866" href="#__codelineno-0-866"></a>                if j == 4:  # Success rate column
</span><span id="__span-0-867"><a id="__codelineno-0-867" name="__codelineno-0-867" href="#__codelineno-0-867"></a>                    if row[&#39;success_rate&#39;] &gt;= 90:
</span><span id="__span-0-868"><a id="__codelineno-0-868" name="__codelineno-0-868" href="#__codelineno-0-868"></a>                        cell.fill = PatternFill(start_color=&quot;C6EFCE&quot;, end_color=&quot;C6EFCE&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-869"><a id="__codelineno-0-869" name="__codelineno-0-869" href="#__codelineno-0-869"></a>                    elif row[&#39;success_rate&#39;] &gt;= 70:
</span><span id="__span-0-870"><a id="__codelineno-0-870" name="__codelineno-0-870" href="#__codelineno-0-870"></a>                        cell.fill = PatternFill(start_color=&quot;FFEB9C&quot;, end_color=&quot;FFEB9C&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-871"><a id="__codelineno-0-871" name="__codelineno-0-871" href="#__codelineno-0-871"></a>                    else:
</span><span id="__span-0-872"><a id="__codelineno-0-872" name="__codelineno-0-872" href="#__codelineno-0-872"></a>                        cell.fill = PatternFill(start_color=&quot;FFC7CE&quot;, end_color=&quot;FFC7CE&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-873"><a id="__codelineno-0-873" name="__codelineno-0-873" href="#__codelineno-0-873"></a>
</span><span id="__span-0-874"><a id="__codelineno-0-874" name="__codelineno-0-874" href="#__codelineno-0-874"></a>        # Auto-adjust column widths
</span><span id="__span-0-875"><a id="__codelineno-0-875" name="__codelineno-0-875" href="#__codelineno-0-875"></a>        for column in ws.columns:
</span><span id="__span-0-876"><a id="__codelineno-0-876" name="__codelineno-0-876" href="#__codelineno-0-876"></a>            max_length = 0
</span><span id="__span-0-877"><a id="__codelineno-0-877" name="__codelineno-0-877" href="#__codelineno-0-877"></a>            column_letter = column[0].column_letter
</span><span id="__span-0-878"><a id="__codelineno-0-878" name="__codelineno-0-878" href="#__codelineno-0-878"></a>            for cell in column:
</span><span id="__span-0-879"><a id="__codelineno-0-879" name="__codelineno-0-879" href="#__codelineno-0-879"></a>                try:
</span><span id="__span-0-880"><a id="__codelineno-0-880" name="__codelineno-0-880" href="#__codelineno-0-880"></a>                    if len(str(cell.value)) &gt; max_length:
</span><span id="__span-0-881"><a id="__codelineno-0-881" name="__codelineno-0-881" href="#__codelineno-0-881"></a>                        max_length = len(str(cell.value))
</span><span id="__span-0-882"><a id="__codelineno-0-882" name="__codelineno-0-882" href="#__codelineno-0-882"></a>                except:
</span><span id="__span-0-883"><a id="__codelineno-0-883" name="__codelineno-0-883" href="#__codelineno-0-883"></a>                    pass
</span><span id="__span-0-884"><a id="__codelineno-0-884" name="__codelineno-0-884" href="#__codelineno-0-884"></a>            adjusted_width = min(max_length + 2, 50)
</span><span id="__span-0-885"><a id="__codelineno-0-885" name="__codelineno-0-885" href="#__codelineno-0-885"></a>            ws.column_dimensions[column_letter].width = adjusted_width
</span><span id="__span-0-886"><a id="__codelineno-0-886" name="__codelineno-0-886" href="#__codelineno-0-886"></a>
</span><span id="__span-0-887"><a id="__codelineno-0-887" name="__codelineno-0-887" href="#__codelineno-0-887"></a>    def _create_summary_sheet(self, wb: Workbook, summary: pd.DataFrame):
</span><span id="__span-0-888"><a id="__codelineno-0-888" name="__codelineno-0-888" href="#__codelineno-0-888"></a>        &quot;&quot;&quot;Create formatted summary sheet&quot;&quot;&quot;
</span><span id="__span-0-889"><a id="__codelineno-0-889" name="__codelineno-0-889" href="#__codelineno-0-889"></a>        ws = wb.create_sheet(&quot;📋 Summary by Build Type&quot;)
</span><span id="__span-0-890"><a id="__codelineno-0-890" name="__codelineno-0-890" href="#__codelineno-0-890"></a>
</span><span id="__span-0-891"><a id="__codelineno-0-891" name="__codelineno-0-891" href="#__codelineno-0-891"></a>        # Title
</span><span id="__span-0-892"><a id="__codelineno-0-892" name="__codelineno-0-892" href="#__codelineno-0-892"></a>        ws[&#39;A1&#39;] = &quot;Build Summary by Application and Build Type&quot;
</span><span id="__span-0-893"><a id="__codelineno-0-893" name="__codelineno-0-893" href="#__codelineno-0-893"></a>        ws[&#39;A1&#39;].font = Font(size=16, bold=True, color=&quot;2E4057&quot;)
</span><span id="__span-0-894"><a id="__codelineno-0-894" name="__codelineno-0-894" href="#__codelineno-0-894"></a>
</span><span id="__span-0-895"><a id="__codelineno-0-895" name="__codelineno-0-895" href="#__codelineno-0-895"></a>        # Write data starting from row 3
</span><span id="__span-0-896"><a id="__codelineno-0-896" name="__codelineno-0-896" href="#__codelineno-0-896"></a>        start_row = 3
</span><span id="__span-0-897"><a id="__codelineno-0-897" name="__codelineno-0-897" href="#__codelineno-0-897"></a>
</span><span id="__span-0-898"><a id="__codelineno-0-898" name="__codelineno-0-898" href="#__codelineno-0-898"></a>        # Headers
</span><span id="__span-0-899"><a id="__codelineno-0-899" name="__codelineno-0-899" href="#__codelineno-0-899"></a>        headers = list(summary.columns)
</span><span id="__span-0-900"><a id="__codelineno-0-900" name="__codelineno-0-900" href="#__codelineno-0-900"></a>        for j, header in enumerate(headers):
</span><span id="__span-0-901"><a id="__codelineno-0-901" name="__codelineno-0-901" href="#__codelineno-0-901"></a>            cell = ws.cell(row=start_row, column=j + 1, value=header.replace(&#39;_&#39;, &#39; &#39;).title())
</span><span id="__span-0-902"><a id="__codelineno-0-902" name="__codelineno-0-902" href="#__codelineno-0-902"></a>            cell.font = Font(bold=True, color=&quot;FFFFFF&quot;)
</span><span id="__span-0-903"><a id="__codelineno-0-903" name="__codelineno-0-903" href="#__codelineno-0-903"></a>            cell.fill = PatternFill(start_color=&quot;4472C4&quot;, end_color=&quot;4472C4&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-904"><a id="__codelineno-0-904" name="__codelineno-0-904" href="#__codelineno-0-904"></a>            cell.alignment = Alignment(horizontal=&#39;center&#39;, vertical=&#39;center&#39;)
</span><span id="__span-0-905"><a id="__codelineno-0-905" name="__codelineno-0-905" href="#__codelineno-0-905"></a>            cell.border = Border(
</span><span id="__span-0-906"><a id="__codelineno-0-906" name="__codelineno-0-906" href="#__codelineno-0-906"></a>                left=Side(style=&#39;thin&#39;),
</span><span id="__span-0-907"><a id="__codelineno-0-907" name="__codelineno-0-907" href="#__codelineno-0-907"></a>                right=Side(style=&#39;thin&#39;),
</span><span id="__span-0-908"><a id="__codelineno-0-908" name="__codelineno-0-908" href="#__codelineno-0-908"></a>                top=Side(style=&#39;thin&#39;),
</span><span id="__span-0-909"><a id="__codelineno-0-909" name="__codelineno-0-909" href="#__codelineno-0-909"></a>                bottom=Side(style=&#39;thin&#39;)
</span><span id="__span-0-910"><a id="__codelineno-0-910" name="__codelineno-0-910" href="#__codelineno-0-910"></a>            )
</span><span id="__span-0-911"><a id="__codelineno-0-911" name="__codelineno-0-911" href="#__codelineno-0-911"></a>
</span><span id="__span-0-912"><a id="__codelineno-0-912" name="__codelineno-0-912" href="#__codelineno-0-912"></a>        # Data rows
</span><span id="__span-0-913"><a id="__codelineno-0-913" name="__codelineno-0-913" href="#__codelineno-0-913"></a>        for i, (_, row) in enumerate(summary.iterrows()):
</span><span id="__span-0-914"><a id="__codelineno-0-914" name="__codelineno-0-914" href="#__codelineno-0-914"></a>            for j, value in enumerate(row):
</span><span id="__span-0-915"><a id="__codelineno-0-915" name="__codelineno-0-915" href="#__codelineno-0-915"></a>                cell = ws.cell(row=start_row + 1 + i, column=j + 1, value=value)
</span><span id="__span-0-916"><a id="__codelineno-0-916" name="__codelineno-0-916" href="#__codelineno-0-916"></a>                cell.border = Border(
</span><span id="__span-0-917"><a id="__codelineno-0-917" name="__codelineno-0-917" href="#__codelineno-0-917"></a>                    left=Side(style=&#39;thin&#39;),
</span><span id="__span-0-918"><a id="__codelineno-0-918" name="__codelineno-0-918" href="#__codelineno-0-918"></a>                    right=Side(style=&#39;thin&#39;),
</span><span id="__span-0-919"><a id="__codelineno-0-919" name="__codelineno-0-919" href="#__codelineno-0-919"></a>                    top=Side(style=&#39;thin&#39;),
</span><span id="__span-0-920"><a id="__codelineno-0-920" name="__codelineno-0-920" href="#__codelineno-0-920"></a>                    bottom=Side(style=&#39;thin&#39;)
</span><span id="__span-0-921"><a id="__codelineno-0-921" name="__codelineno-0-921" href="#__codelineno-0-921"></a>                )
</span><span id="__span-0-922"><a id="__codelineno-0-922" name="__codelineno-0-922" href="#__codelineno-0-922"></a>                cell.alignment = Alignment(horizontal=&#39;center&#39;, vertical=&#39;center&#39;)
</span><span id="__span-0-923"><a id="__codelineno-0-923" name="__codelineno-0-923" href="#__codelineno-0-923"></a>
</span><span id="__span-0-924"><a id="__codelineno-0-924" name="__codelineno-0-924" href="#__codelineno-0-924"></a>                # Format percentage columns
</span><span id="__span-0-925"><a id="__codelineno-0-925" name="__codelineno-0-925" href="#__codelineno-0-925"></a>                if &#39;rate&#39; in summary.columns[j].lower():
</span><span id="__span-0-926"><a id="__codelineno-0-926" name="__codelineno-0-926" href="#__codelineno-0-926"></a>                    if isinstance(value, (int, float)):
</span><span id="__span-0-927"><a id="__codelineno-0-927" name="__codelineno-0-927" href="#__codelineno-0-927"></a>                        if value &gt;= 90:
</span><span id="__span-0-928"><a id="__codelineno-0-928" name="__codelineno-0-928" href="#__codelineno-0-928"></a>                            cell.fill = PatternFill(start_color=&quot;C6EFCE&quot;, end_color=&quot;C6EFCE&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-929"><a id="__codelineno-0-929" name="__codelineno-0-929" href="#__codelineno-0-929"></a>                        elif value &gt;= 70:
</span><span id="__span-0-930"><a id="__codelineno-0-930" name="__codelineno-0-930" href="#__codelineno-0-930"></a>                            cell.fill = PatternFill(start_color=&quot;FFEB9C&quot;, end_color=&quot;FFEB9C&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-931"><a id="__codelineno-0-931" name="__codelineno-0-931" href="#__codelineno-0-931"></a>                        else:
</span><span id="__span-0-932"><a id="__codelineno-0-932" name="__codelineno-0-932" href="#__codelineno-0-932"></a>                            cell.fill = PatternFill(start_color=&quot;FFC7CE&quot;, end_color=&quot;FFC7CE&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-933"><a id="__codelineno-0-933" name="__codelineno-0-933" href="#__codelineno-0-933"></a>
</span><span id="__span-0-934"><a id="__codelineno-0-934" name="__codelineno-0-934" href="#__codelineno-0-934"></a>        # Auto-adjust column widths
</span><span id="__span-0-935"><a id="__codelineno-0-935" name="__codelineno-0-935" href="#__codelineno-0-935"></a>        for column in ws.columns:
</span><span id="__span-0-936"><a id="__codelineno-0-936" name="__codelineno-0-936" href="#__codelineno-0-936"></a>            max_length = 0
</span><span id="__span-0-937"><a id="__codelineno-0-937" name="__codelineno-0-937" href="#__codelineno-0-937"></a>            column_letter = column[0].column_letter
</span><span id="__span-0-938"><a id="__codelineno-0-938" name="__codelineno-0-938" href="#__codelineno-0-938"></a>            for cell in column:
</span><span id="__span-0-939"><a id="__codelineno-0-939" name="__codelineno-0-939" href="#__codelineno-0-939"></a>                try:
</span><span id="__span-0-940"><a id="__codelineno-0-940" name="__codelineno-0-940" href="#__codelineno-0-940"></a>                    if len(str(cell.value)) &gt; max_length:
</span><span id="__span-0-941"><a id="__codelineno-0-941" name="__codelineno-0-941" href="#__codelineno-0-941"></a>                        max_length = len(str(cell.value))
</span><span id="__span-0-942"><a id="__codelineno-0-942" name="__codelineno-0-942" href="#__codelineno-0-942"></a>                except:
</span><span id="__span-0-943"><a id="__codelineno-0-943" name="__codelineno-0-943" href="#__codelineno-0-943"></a>                    pass
</span><span id="__span-0-944"><a id="__codelineno-0-944" name="__codelineno-0-944" href="#__codelineno-0-944"></a>            adjusted_width = min(max_length + 2, 50)
</span><span id="__span-0-945"><a id="__codelineno-0-945" name="__codelineno-0-945" href="#__codelineno-0-945"></a>            ws.column_dimensions[column_letter].width = adjusted_width
</span><span id="__span-0-946"><a id="__codelineno-0-946" name="__codelineno-0-946" href="#__codelineno-0-946"></a>
</span><span id="__span-0-947"><a id="__codelineno-0-947" name="__codelineno-0-947" href="#__codelineno-0-947"></a>    def _create_detailed_sheet(self, wb: Workbook, df: pd.DataFrame):
</span><span id="__span-0-948"><a id="__codelineno-0-948" name="__codelineno-0-948" href="#__codelineno-0-948"></a>        &quot;&quot;&quot;Create detailed data sheet&quot;&quot;&quot;
</span><span id="__span-0-949"><a id="__codelineno-0-949" name="__codelineno-0-949" href="#__codelineno-0-949"></a>        ws = wb.create_sheet(&quot;📝 Detailed Build Data&quot;)
</span><span id="__span-0-950"><a id="__codelineno-0-950" name="__codelineno-0-950" href="#__codelineno-0-950"></a>
</span><span id="__span-0-951"><a id="__codelineno-0-951" name="__codelineno-0-951" href="#__codelineno-0-951"></a>        # Title
</span><span id="__span-0-952"><a id="__codelineno-0-952" name="__codelineno-0-952" href="#__codelineno-0-952"></a>        ws[&#39;A1&#39;] = &quot;Detailed Build Information&quot;
</span><span id="__span-0-953"><a id="__codelineno-0-953" name="__codelineno-0-953" href="#__codelineno-0-953"></a>        ws[&#39;A1&#39;].font = Font(size=16, bold=True, color=&quot;2E4057&quot;)
</span><span id="__span-0-954"><a id="__codelineno-0-954" name="__codelineno-0-954" href="#__codelineno-0-954"></a>
</span><span id="__span-0-955"><a id="__codelineno-0-955" name="__codelineno-0-955" href="#__codelineno-0-955"></a>        # Select and reorder columns for better readability
</span><span id="__span-0-956"><a id="__codelineno-0-956" name="__codelineno-0-956" href="#__codelineno-0-956"></a>        columns_to_show = [
</span><span id="__span-0-957"><a id="__codelineno-0-957" name="__codelineno-0-957" href="#__codelineno-0-957"></a>            &#39;project_path&#39;, &#39;build_type_name&#39;, &#39;build_number&#39;, &#39;status&#39;, 
</span><span id="__span-0-958"><a id="__codelineno-0-958" name="__codelineno-0-958" href="#__codelineno-0-958"></a>            &#39;timestamp&#39;, &#39;branch&#39;, &#39;triggered_by&#39;, &#39;trigger_type&#39;, &#39;status_text&#39;
</span><span id="__span-0-959"><a id="__codelineno-0-959" name="__codelineno-0-959" href="#__codelineno-0-959"></a>        ]
</span><span id="__span-0-960"><a id="__codelineno-0-960" name="__codelineno-0-960" href="#__codelineno-0-960"></a>
</span><span id="__span-0-961"><a id="__codelineno-0-961" name="__codelineno-0-961" href="#__codelineno-0-961"></a>        # Only include columns that exist in the DataFrame
</span><span id="__span-0-962"><a id="__codelineno-0-962" name="__codelineno-0-962" href="#__codelineno-0-962"></a>        available_columns = [col for col in columns_to_show if col in df.columns]
</span><span id="__span-0-963"><a id="__codelineno-0-963" name="__codelineno-0-963" href="#__codelineno-0-963"></a>        display_df = df[available_columns].copy()
</span><span id="__span-0-964"><a id="__codelineno-0-964" name="__codelineno-0-964" href="#__codelineno-0-964"></a>
</span><span id="__span-0-965"><a id="__codelineno-0-965" name="__codelineno-0-965" href="#__codelineno-0-965"></a>        # Format timestamp
</span><span id="__span-0-966"><a id="__codelineno-0-966" name="__codelineno-0-966" href="#__codelineno-0-966"></a>        if &#39;timestamp&#39; in display_df.columns:
</span><span id="__span-0-967"><a id="__codelineno-0-967" name="__codelineno-0-967" href="#__codelineno-0-967"></a>            display_df[&#39;timestamp&#39;] = display_df[&#39;timestamp&#39;].dt.strftime(&#39;%Y-%m-%d %H:%M:%S&#39;)
</span><span id="__span-0-968"><a id="__codelineno-0-968" name="__codelineno-0-968" href="#__codelineno-0-968"></a>
</span><span id="__span-0-969"><a id="__codelineno-0-969" name="__codelineno-0-969" href="#__codelineno-0-969"></a>        # Write data starting from row 3
</span><span id="__span-0-970"><a id="__codelineno-0-970" name="__codelineno-0-970" href="#__codelineno-0-970"></a>        start_row = 3
</span><span id="__span-0-971"><a id="__codelineno-0-971" name="__codelineno-0-971" href="#__codelineno-0-971"></a>
</span><span id="__span-0-972"><a id="__codelineno-0-972" name="__codelineno-0-972" href="#__codelineno-0-972"></a>        # Headers
</span><span id="__span-0-973"><a id="__codelineno-0-973" name="__codelineno-0-973" href="#__codelineno-0-973"></a>        for j, column in enumerate(display_df.columns):
</span><span id="__span-0-974"><a id="__codelineno-0-974" name="__codelineno-0-974" href="#__codelineno-0-974"></a>            cell = ws.cell(row=start_row, column=j + 1, value=column.replace(&#39;_&#39;, &#39; &#39;).title())
</span><span id="__span-0-975"><a id="__codelineno-0-975" name="__codelineno-0-975" href="#__codelineno-0-975"></a>            cell.font = Font(bold=True, color=&quot;FFFFFF&quot;)
</span><span id="__span-0-976"><a id="__codelineno-0-976" name="__codelineno-0-976" href="#__codelineno-0-976"></a>            cell.fill = PatternFill(start_color=&quot;4472C4&quot;, end_color=&quot;4472C4&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-977"><a id="__codelineno-0-977" name="__codelineno-0-977" href="#__codelineno-0-977"></a>            cell.alignment = Alignment(horizontal=&#39;center&#39;, vertical=&#39;center&#39;)
</span><span id="__span-0-978"><a id="__codelineno-0-978" name="__codelineno-0-978" href="#__codelineno-0-978"></a>            cell.border = Border(
</span><span id="__span-0-979"><a id="__codelineno-0-979" name="__codelineno-0-979" href="#__codelineno-0-979"></a>                left=Side(style=&#39;thin&#39;),
</span><span id="__span-0-980"><a id="__codelineno-0-980" name="__codelineno-0-980" href="#__codelineno-0-980"></a>                right=Side(style=&#39;thin&#39;),
</span><span id="__span-0-981"><a id="__codelineno-0-981" name="__codelineno-0-981" href="#__codelineno-0-981"></a>                top=Side(style=&#39;thin&#39;),
</span><span id="__span-0-982"><a id="__codelineno-0-982" name="__codelineno-0-982" href="#__codelineno-0-982"></a>                bottom=Side(style=&#39;thin&#39;)
</span><span id="__span-0-983"><a id="__codelineno-0-983" name="__codelineno-0-983" href="#__codelineno-0-983"></a>            )
</span><span id="__span-0-984"><a id="__codelineno-0-984" name="__codelineno-0-984" href="#__codelineno-0-984"></a>
</span><span id="__span-0-985"><a id="__codelineno-0-985" name="__codelineno-0-985" href="#__codelineno-0-985"></a>        # Data rows
</span><span id="__span-0-986"><a id="__codelineno-0-986" name="__codelineno-0-986" href="#__codelineno-0-986"></a>        for i, (_, row) in enumerate(display_df.iterrows()):
</span><span id="__span-0-987"><a id="__codelineno-0-987" name="__codelineno-0-987" href="#__codelineno-0-987"></a>            for j, value in enumerate(row):
</span><span id="__span-0-988"><a id="__codelineno-0-988" name="__codelineno-0-988" href="#__codelineno-0-988"></a>                cell = ws.cell(row=start_row + 1 + i, column=j + 1, value=value)
</span><span id="__span-0-989"><a id="__codelineno-0-989" name="__codelineno-0-989" href="#__codelineno-0-989"></a>                cell.border = Border(
</span><span id="__span-0-990"><a id="__codelineno-0-990" name="__codelineno-0-990" href="#__codelineno-0-990"></a>                    left=Side(style=&#39;thin&#39;),
</span><span id="__span-0-991"><a id="__codelineno-0-991" name="__codelineno-0-991" href="#__codelineno-0-991"></a>                    right=Side(style=&#39;thin&#39;),
</span><span id="__span-0-992"><a id="__codelineno-0-992" name="__codelineno-0-992" href="#__codelineno-0-992"></a>                    top=Side(style=&#39;thin&#39;),
</span><span id="__span-0-993"><a id="__codelineno-0-993" name="__codelineno-0-993" href="#__codelineno-0-993"></a>                    bottom=Side(style=&#39;thin&#39;)
</span><span id="__span-0-994"><a id="__codelineno-0-994" name="__codelineno-0-994" href="#__codelineno-0-994"></a>                )
</span><span id="__span-0-995"><a id="__codelineno-0-995" name="__codelineno-0-995" href="#__codelineno-0-995"></a>                cell.alignment = Alignment(horizontal=&#39;left&#39;, vertical=&#39;center&#39;)
</span><span id="__span-0-996"><a id="__codelineno-0-996" name="__codelineno-0-996" href="#__codelineno-0-996"></a>
</span><span id="__span-0-997"><a id="__codelineno-0-997" name="__codelineno-0-997" href="#__codelineno-0-997"></a>                # Color code status column
</span><span id="__span-0-998"><a id="__codelineno-0-998" name="__codelineno-0-998" href="#__codelineno-0-998"></a>                if j == 3 and &#39;status&#39; in display_df.columns:  # Status column
</span><span id="__span-0-999"><a id="__codelineno-0-999" name="__codelineno-0-999" href="#__codelineno-0-999"></a>                    if value == &#39;SUCCESS&#39;:
</span><span id="__span-0-1000"><a id="__codelineno-0-1000" name="__codelineno-0-1000" href="#__codelineno-0-1000"></a>                        cell.fill = PatternFill(start_color=&quot;C6EFCE&quot;, end_color=&quot;C6EFCE&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-1001"><a id="__codelineno-0-1001" name="__codelineno-0-1001" href="#__codelineno-0-1001"></a>                    elif value == &#39;FAILURE&#39;:
</span><span id="__span-0-1002"><a id="__codelineno-0-1002" name="__codelineno-0-1002" href="#__codelineno-0-1002"></a>                        cell.fill = PatternFill(start_color=&quot;FFC7CE&quot;, end_color=&quot;FFC7CE&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-1003"><a id="__codelineno-0-1003" name="__codelineno-0-1003" href="#__codelineno-0-1003"></a>                    else:
</span><span id="__span-0-1004"><a id="__codelineno-0-1004" name="__codelineno-0-1004" href="#__codelineno-0-1004"></a>                        cell.fill = PatternFill(start_color=&quot;FFEB9C&quot;, end_color=&quot;FFEB9C&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-1005"><a id="__codelineno-0-1005" name="__codelineno-0-1005" href="#__codelineno-0-1005"></a>
</span><span id="__span-0-1006"><a id="__codelineno-0-1006" name="__codelineno-0-1006" href="#__codelineno-0-1006"></a>        # Auto-adjust column widths
</span><span id="__span-0-1007"><a id="__codelineno-0-1007" name="__codelineno-0-1007" href="#__codelineno-0-1007"></a>        for column in ws.columns:
</span><span id="__span-0-1008"><a id="__codelineno-0-1008" name="__codelineno-0-1008" href="#__codelineno-0-1008"></a>            max_length = 0
</span><span id="__span-0-1009"><a id="__codelineno-0-1009" name="__codelineno-0-1009" href="#__codelineno-0-1009"></a>            column_letter = column[0].column_letter
</span><span id="__span-0-1010"><a id="__codelineno-0-1010" name="__codelineno-0-1010" href="#__codelineno-0-1010"></a>            for cell in column:
</span><span id="__span-0-1011"><a id="__codelineno-0-1011" name="__codelineno-0-1011" href="#__codelineno-0-1011"></a>                try:
</span><span id="__span-0-1012"><a id="__codelineno-0-1012" name="__codelineno-0-1012" href="#__codelineno-0-1012"></a>                    if len(str(cell.value)) &gt; max_length:
</span><span id="__span-0-1013"><a id="__codelineno-0-1013" name="__codelineno-0-1013" href="#__codelineno-0-1013"></a>                        max_length = len(str(cell.value))
</span><span id="__span-0-1014"><a id="__codelineno-0-1014" name="__codelineno-0-1014" href="#__codelineno-0-1014"></a>                except:
</span><span id="__span-0-1015"><a id="__codelineno-0-1015" name="__codelineno-0-1015" href="#__codelineno-0-1015"></a>                    pass
</span><span id="__span-0-1016"><a id="__codelineno-0-1016" name="__codelineno-0-1016" href="#__codelineno-0-1016"></a>            adjusted_width = min(max_length + 2, 50)
</span><span id="__span-0-1017"><a id="__codelineno-0-1017" name="__codelineno-0-1017" href="#__codelineno-0-1017"></a>            ws.column_dimensions[column_letter].width = adjusted_width7CE&quot;, end_color=&quot;FFC7CE&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-1018"><a id="__codelineno-0-1018" name="__codelineno-0-1018" href="#__codelineno-0-1018"></a>                    else:
</span><span id="__span-0-1019"><a id="__codelineno-0-1019" name="__codelineno-0-1019" href="#__codelineno-0-1019"></a>                        cell.fill = PatternFill(start_color=&quot;FFEB9C&quot;, end_color=&quot;FFEB9C&quot;, fill_type=&quot;solid&quot;)
</span><span id="__span-0-1020"><a id="__codelineno-0-1020" name="__codelineno-0-1020" href="#__codelineno-0-1020"></a>
</span><span id="__span-0-1021"><a id="__codelineno-0-1021" name="__codelineno-0-1021" href="#__codelineno-0-1021"></a>        # Auto-adjust column widths
</span><span id="__span-0-1022"><a id="__codelineno-0-1022" name="__codelineno-0-1022" href="#__codelineno-0-1022"></a>        for column in ws.columns:
</span><span id="__span-0-1023"><a id="__codelineno-0-1023" name="__codelineno-0-1023" href="#__codelineno-0-1023"></a>            max_length = 0
</span><span id="__span-0-1024"><a id="__codelineno-0-1024" name="__codelineno-0-1024" href="#__codelineno-0-1024"></a>            column_letter = column[0].column_letter
</span><span id="__span-0-1025"><a id="__codelineno-0-1025" name="__codelineno-0-1025" href="#__codelineno-0-1025"></a>            for cell in column:
</span><span id="__span-0-1026"><a id="__codelineno-0-1026" name="__codelineno-0-1026" href="#__codelineno-0-1026"></a>                try:
</span><span id="__span-0-1027"><a id="__codelineno-0-1027" name="__codelineno-0-1027" href="#__codelineno-0-1027"></a>                    if len(str(cell.value)) &gt; max_length:
</span><span id="__span-0-1028"><a id="__codelineno-0-1028" name="__codelineno-0-1028" href="#__codelineno-0-1028"></a>                        max_length = len(str(cell.value))
</span><span id="__span-0-1029"><a id="__codelineno-0-1029" name="__codelineno-0-1029" href="#__codelineno-0-1029"></a>                except:
</span><span id="__span-0-1030"><a id="__codelineno-0-1030" name="__codelineno-0-1030" href="#__codelineno-0-1030"></a>                    pass
</span><span id="__span-0-1031"><a id="__codelineno-0-1031" name="__codelineno-0-1031" href="#__codelineno-0-1031"></a>            adjusted_width = min(max_length + 2, 50)
</span><span id="__span-0-1032"><a id="__codelineno-0-1032" name="__codelineno-0-1032" href="#__codelineno-0-1032"></a>            ws.column_dimensions[column_letter].width = adjusted_width
</span><span id="__span-0-1033"><a id="__codelineno-0-1033" name="__codelineno-0-1033" href="#__codelineno-0-1033"></a>
</span><span id="__span-0-1034"><a id="__codelineno-0-1034" name="__codelineno-0-1034" href="#__codelineno-0-1034"></a>    def _create_charts_sheet(self, wb: Workbook, summary: pd.DataFrame):
</span><span id="__span-0-1035"><a id="__codelineno-0-1035" name="__codelineno-0-1035" href="#__codelineno-0-1035"></a>        &quot;&quot;&quot;Create charts and visualizations sheet&quot;&quot;&quot;
</span><span id="__span-0-1036"><a id="__codelineno-0-1036" name="__codelineno-0-1036" href="#__codelineno-0-1036"></a>        ws = wb.create_sheet(&quot;📊 Charts &amp; Analytics&quot;)
</span><span id="__span-0-1037"><a id="__codelineno-0-1037" name="__codelineno-0-1037" href="#__codelineno-0-1037"></a>
</span><span id="__span-0-1038"><a id="__codelineno-0-1038" name="__codelineno-0-1038" href="#__codelineno-0-1038"></a>        # Title
</span><span id="__span-0-1039"><a id="__codelineno-0-1039" name="__codelineno-0-1039" href="#__codelineno-0-1039"></a>        ws[&#39;A1&#39;] = &quot;Build Analytics Dashboard&quot;
</span><span id="__span-0-1040"><a id="__codelineno-0-1040" name="__codelineno-0-1040" href="#__codelineno-0-1040"></a>        ws[&#39;A1&#39;].font = Font(size=16, bold=True, color=&quot;2E4057&quot;)
</span><span id="__span-0-1041"><a id="__codelineno-0-1041" name="__codelineno-0-1041" href="#__codelineno-0-1041"></a>
</span><span id="__span-0-1042"><a id="__codelineno-0-1042" name="__codelineno-0-1042" href="#__codelineno-0-1042"></a>        # Prepare data for charts
</span><span id="__span-0-1043"><a id="__codelineno-0-1043" name="__codelineno-0-1043" href="#__codelineno-0-1043"></a>        app_summary = summary.groupby(&#39;application_code&#39;).agg({
</span><span id="__span-0-1044"><a id="__codelineno-0-1044" name="__codelineno-0-1044" href="#__codelineno-0-1044"></a>            &#39;total_builds&#39;: &#39;sum&#39;,
</span><span id="__span-0-1045"><a id="__codelineno-0-1045" name="__codelineno-0-1045" href="#__codelineno-0-1045"></a>            &#39;successful_builds&#39;: &#39;sum&#39;,
</span><span id="__span-0-1046"><a id="__codelineno-0-1046" name="__codelineno-0-1046" href="#__codelineno-0-1046"></a>            &#39;failed_builds&#39;: &#39;sum&#39;
</span><span id="__span-0-1047"><a id="__codelineno-0-1047" name="__codelineno-0-1047" href="#__codelineno-0-1047"></a>        }).reset_index()
</span><span id="__span-0-1048"><a id="__codelineno-0-1048" name="__codelineno-0-1048" href="#__codelineno-0-1048"></a>        app_summary = app_summary.sort_values(&#39;total_builds&#39;, ascending=False).head(10)
</span><span id="__span-0-1049"><a id="__codelineno-0-1049" name="__codelineno-0-1049" href="#__codelineno-0-1049"></a>
</span><span id="__span-0-1050"><a id="__codelineno-0-1050" name="__codelineno-0-1050" href="#__codelineno-0-1050"></a>        # Create data table for chart
</span><span id="__span-0-1051"><a id="__codelineno-0-1051" name="__codelineno-0-1051" href="#__codelineno-0-1051"></a>        chart_start_row = 3
</span><span id="__span-0-1052"><a id="__codelineno-0-1052" name="__codelineno-0-1052" href="#__codelineno-0-1052"></a>        ws.cell(row=chart_start_row, column=1, value=&quot;Application&quot;)
</span><span id="__span-0-1053"><a id="__codelineno-0-1053" name="__codelineno-0-1053" href="#__codelineno-0-1053"></a>        ws.cell(row=chart_start_row, column=2, value=&quot;Total Builds&quot;)
</span><span id="__span-0-1054"><a id="__codelineno-0-1054" name="__codelineno-0-1054" href="#__codelineno-0-1054"></a>        ws.cell(row=chart_start_row, column=3, value=&quot;Successful&quot;)
</span><span id="__span-0-1055"><a id="__codelineno-0-1055" name="__codelineno-0-1055" href="#__codelineno-0-1055"></a>        ws.cell(row=chart_start_row, column=4, value=&quot;Failed&quot;)
</span><span id="__span-0-1056"><a id="__codelineno-0-1056" name="__codelineno-0-1056" href="#__codelineno-0-1056"></a>
</span><span id="__span-0-1057"><a id="__codelineno-0-1057" name="__codelineno-0-1057" href="#__codelineno-0-1057"></a>        for i, (_, row) in enumerate(app_summary.iterrows()):
</span><span id="__span-0-1058"><a id="__codelineno-0-1058" name="__codelineno-0-1058" href="#__codelineno-0-1058"></a>            ws.cell(row=chart_start_row + 1 + i, column=1, value=row[&#39;application_code&#39;])
</span><span id="__span-0-1059"><a id="__codelineno-0-1059" name="__codelineno-0-1059" href="#__codelineno-0-1059"></a>            ws.cell(row=chart_start_row + 1 + i, column=2, value=row[&#39;total_builds&#39;])
</span><span id="__span-0-1060"><a id="__codelineno-0-1060" name="__codelineno-0-1060" href="#__codelineno-0-1060"></a>            ws.cell(row=chart_start_row + 1 + i, column=3, value=row[&#39;successful_builds&#39;])
</span><span id="__span-0-1061"><a id="__codelineno-0-1061" name="__codelineno-0-1061" href="#__codelineno-0-1061"></a>            ws.cell(row=chart_start_row + 1 + i, column=4, value=row[&#39;failed_builds&#39;])
</span><span id="__span-0-1062"><a id="__codelineno-0-1062" name="__codelineno-0-1062" href="#__codelineno-0-1062"></a>
</span><span id="__span-0-1063"><a id="__codelineno-0-1063" name="__codelineno-0-1063" href="#__codelineno-0-1063"></a>        # Create bar chart
</span><span id="__span-0-1064"><a id="__codelineno-0-1064" name="__codelineno-0-1064" href="#__codelineno-0-1064"></a>        chart = BarChart()
</span><span id="__span-0-1065"><a id="__codelineno-0-1065" name="__codelineno-0-1065" href="#__codelineno-0-1065"></a>        chart.type = &quot;col&quot;
</span><span id="__span-0-1066"><a id="__codelineno-0-1066" name="__codelineno-0-1066" href="#__codelineno-0-1066"></a>        chart.style = 10
</span><span id="__span-0-1067"><a id="__codelineno-0-1067" name="__codelineno-0-1067" href="#__codelineno-0-1067"></a>        chart.title = &quot;Build Volume by Application&quot;
</span><span id="__span-0-1068"><a id="__codelineno-0-1068" name="__codelineno-0-1068" href="#__codelineno-0-1068"></a>        chart.y_axis.title = &#39;Number of Builds&#39;
</span><span id="__span-0-1069"><a id="__codelineno-0-1069" name="__codelineno-0-1069" href="#__codelineno-0-1069"></a>        chart.x_axis.title = &#39;Applications&#39;
</span><span id="__span-0-1070"><a id="__codelineno-0-1070" name="__codelineno-0-1070" href="#__codelineno-0-1070"></a>
</span><span id="__span-0-1071"><a id="__codelineno-0-1071" name="__codelineno-0-1071" href="#__codelineno-0-1071"></a>        # Define data ranges
</span><span id="__span-0-1072"><a id="__codelineno-0-1072" name="__codelineno-0-1072" href="#__codelineno-0-1072"></a>        data = Reference(ws, min_col=2, min_row=chart_start_row, max_row=chart_start_row + len(app_summary), max_col=4)
</span><span id="__span-0-1073"><a id="__codelineno-0-1073" name="__codelineno-0-1073" href="#__codelineno-0-1073"></a>        cats = Reference(ws, min_col=1, min_row=chart_start_row + 1, max_row=chart_start_row + len(app_summary))
</span><span id="__span-0-1074"><a id="__codelineno-0-1074" name="__codelineno-0-1074" href="#__codelineno-0-1074"></a>
</span><span id="__span-0-1075"><a id="__codelineno-0-1075" name="__codelineno-0-1075" href="#__codelineno-0-1075"></a>        chart.add_data(data, titles_from_data=True)
</span><span id="__span-0-1076"><a id="__codelineno-0-1076" name="__codelineno-0-1076" href="#__codelineno-0-1076"></a>        chart.set_categories(cats)
</span><span id="__span-0-1077"><a id="__codelineno-0-1077" name="__codelineno-0-1077" href="#__codelineno-0-1077"></a>        chart.height = 10
</span><span id="__span-0-1078"><a id="__codelineno-0-1078" name="__codelineno-0-1078" href="#__codelineno-0-1078"></a>        chart.width = 15
</span><span id="__span-0-1079"><a id="__codelineno-0-1079" name="__codelineno-0-1079" href="#__codelineno-0-1079"></a>
</span><span id="__span-0-1080"><a id="__codelineno-0-1080" name="__codelineno-0-1080" href="#__codelineno-0-1080"></a>        # Add chart to worksheet
</span><span id="__span-0-1081"><a id="__codelineno-0-1081" name="__codelineno-0-1081" href="#__codelineno-0-1081"></a>        ws.add_chart(chart, &quot;F3&quot;)
</span><span id="__span-0-1082"><a id="__codelineno-0-1082" name="__codelineno-0-1082" href="#__codelineno-0-1082"></a>
</span><span id="__span-0-1083"><a id="__codelineno-0-1083" name="__codelineno-0-1083" href="#__codelineno-0-1083"></a>    def print_summary_report(self, summary: pd.DataFrame):
</span><span id="__span-0-1084"><a id="__codelineno-0-1084" name="__codelineno-0-1084" href="#__codelineno-0-1084"></a>        &quot;&quot;&quot;
</span><span id="__span-0-1085"><a id="__codelineno-0-1085" name="__codelineno-0-1085" href="#__codelineno-0-1085"></a>        Print a formatted summary report
</span><span id="__span-0-1086"><a id="__codelineno-0-1086" name="__codelineno-0-1086" href="#__codelineno-0-1086"></a>
</span><span id="__span-0-1087"><a id="__codelineno-0-1087" name="__codelineno-0-1087" href="#__codelineno-0-1087"></a>        Args:
</span><span id="__span-0-1088"><a id="__codelineno-0-1088" name="__codelineno-0-1088" href="#__codelineno-0-1088"></a>            summary: Summary DataFrame
</span><span id="__span-0-1089"><a id="__codelineno-0-1089" name="__codelineno-0-1089" href="#__codelineno-0-1089"></a>        &quot;&quot;&quot;
</span><span id="__span-0-1090"><a id="__codelineno-0-1090" name="__codelineno-0-1090" href="#__codelineno-0-1090"></a>        print(&quot;\n&quot; + &quot;=&quot;*80)
</span><span id="__span-0-1091"><a id="__codelineno-0-1091" name="__codelineno-0-1091" href="#__codelineno-0-1091"></a>        print(&quot;TEAMCITY BUILD ANALYSIS REPORT - LAST 30 DAYS&quot;)
</span><span id="__span-0-1092"><a id="__codelineno-0-1092" name="__codelineno-0-1092" href="#__codelineno-0-1092"></a>        print(&quot;=&quot;*80)
</span><span id="__span-0-1093"><a id="__codelineno-0-1093" name="__codelineno-0-1093" href="#__codelineno-0-1093"></a>
</span><span id="__span-0-1094"><a id="__codelineno-0-1094" name="__codelineno-0-1094" href="#__codelineno-0-1094"></a>        total_apps = summary[&#39;application_code&#39;].nunique()
</span><span id="__span-0-1095"><a id="__codelineno-0-1095" name="__codelineno-0-1095" href="#__codelineno-0-1095"></a>        total_build_types = len(summary)
</span><span id="__span-0-1096"><a id="__codelineno-0-1096" name="__codelineno-0-1096" href="#__codelineno-0-1096"></a>        total_builds = summary[&#39;total_builds&#39;].sum()
</span><span id="__span-0-1097"><a id="__codelineno-0-1097" name="__codelineno-0-1097" href="#__codelineno-0-1097"></a>        total_successful = summary[&#39;successful_builds&#39;].sum()
</span><span id="__span-0-1098"><a id="__codelineno-0-1098" name="__codelineno-0-1098" href="#__codelineno-0-1098"></a>        total_failed = summary[&#39;failed_builds&#39;].sum()
</span><span id="__span-0-1099"><a id="__codelineno-0-1099" name="__codelineno-0-1099" href="#__codelineno-0-1099"></a>
</span><span id="__span-0-1100"><a id="__codelineno-0-1100" name="__codelineno-0-1100" href="#__codelineno-0-1100"></a>        print(f&quot;\nOVERALL STATISTICS:&quot;)
</span><span id="__span-0-1101"><a id="__codelineno-0-1101" name="__codelineno-0-1101" href="#__codelineno-0-1101"></a>        print(f&quot;  Total Applications: {total_apps}&quot;)
</span><span id="__span-0-1102"><a id="__codelineno-0-1102" name="__codelineno-0-1102" href="#__codelineno-0-1102"></a>        print(f&quot;  Total Build Types: {total_build_types}&quot;)
</span><span id="__span-0-1103"><a id="__codelineno-0-1103" name="__codelineno-0-1103" href="#__codelineno-0-1103"></a>        print(f&quot;  Total Builds: {total_builds}&quot;)
</span><span id="__span-0-1104"><a id="__codelineno-0-1104" name="__codelineno-0-1104" href="#__codelineno-0-1104"></a>        print(f&quot;  Successful Builds: {total_successful} ({total_successful/total_builds*100:.1f}%)&quot;)
</span><span id="__span-0-1105"><a id="__codelineno-0-1105" name="__codelineno-0-1105" href="#__codelineno-0-1105"></a>        print(f&quot;  Failed Builds: {total_failed} ({total_failed/total_builds*100:.1f}%)&quot;)
</span><span id="__span-0-1106"><a id="__codelineno-0-1106" name="__codelineno-0-1106" href="#__codelineno-0-1106"></a>
</span><span id="__span-0-1107"><a id="__codelineno-0-1107" name="__codelineno-0-1107" href="#__codelineno-0-1107"></a>        print(f&quot;\nTOP 10 MOST ACTIVE BUILD TYPES:&quot;)
</span><span id="__span-0-1108"><a id="__codelineno-0-1108" name="__codelineno-0-1108" href="#__codelineno-0-1108"></a>        print(&quot;-&quot; * 80)
</span><span id="__span-0-1109"><a id="__codelineno-0-1109" name="__codelineno-0-1109" href="#__codelineno-0-1109"></a>        top_builds = summary.nlargest(10, &#39;total_builds&#39;)
</span><span id="__span-0-1110"><a id="__codelineno-0-1110" name="__codelineno-0-1110" href="#__codelineno-0-1110"></a>        for _, row in top_builds.iterrows():
</span><span id="__span-0-1111"><a id="__codelineno-0-1111" name="__codelineno-0-1111" href="#__codelineno-0-1111"></a>            print(f&quot;  {row[&#39;application_code&#39;]:&lt;20} | {row[&#39;build_type_name&#39;]:&lt;30} | &quot;
</span><span id="__span-0-1112"><a id="__codelineno-0-1112" name="__codelineno-0-1112" href="#__codelineno-0-1112"></a>                  f&quot;Total: {row[&#39;total_builds&#39;]:&lt;4} | Success: {row[&#39;success_rate&#39;]:&lt;5.1f}%&quot;)
</span><span id="__span-0-1113"><a id="__codelineno-0-1113" name="__codelineno-0-1113" href="#__codelineno-0-1113"></a>
</span><span id="__span-0-1114"><a id="__codelineno-0-1114" name="__codelineno-0-1114" href="#__codelineno-0-1114"></a>        print(f&quot;\nBUILD SUMMARY BY APPLICATION:&quot;)
</span><span id="__span-0-1115"><a id="__codelineno-0-1115" name="__codelineno-0-1115" href="#__codelineno-0-1115"></a>        print(&quot;-&quot; * 80)
</span><span id="__span-0-1116"><a id="__codelineno-0-1116" name="__codelineno-0-1116" href="#__codelineno-0-1116"></a>        app_summary = summary.groupby(&#39;application_code&#39;).agg({
</span><span id="__span-0-1117"><a id="__codelineno-0-1117" name="__codelineno-0-1117" href="#__codelineno-0-1117"></a>            &#39;total_builds&#39;: &#39;sum&#39;,
</span><span id="__span-0-1118"><a id="__codelineno-0-1118" name="__codelineno-0-1118" href="#__codelineno-0-1118"></a>            &#39;successful_builds&#39;: &#39;sum&#39;,
</span><span id="__span-0-1119"><a id="__codelineno-0-1119" name="__codelineno-0-1119" href="#__codelineno-0-1119"></a>            &#39;failed_builds&#39;: &#39;sum&#39;
</span><span id="__span-0-1120"><a id="__codelineno-0-1120" name="__codelineno-0-1120" href="#__codelineno-0-1120"></a>        }).reset_index()
</span><span id="__span-0-1121"><a id="__codelineno-0-1121" name="__codelineno-0-1121" href="#__codelineno-0-1121"></a>        app_summary[&#39;success_rate&#39;] = (app_summary[&#39;successful_builds&#39;] / app_summary[&#39;total_builds&#39;] * 100).round(1)
</span><span id="__span-0-1122"><a id="__codelineno-0-1122" name="__codelineno-0-1122" href="#__codelineno-0-1122"></a>        app_summary = app_summary.sort_values(&#39;total_builds&#39;, ascending=False)
</span><span id="__span-0-1123"><a id="__codelineno-0-1123" name="__codelineno-0-1123" href="#__codelineno-0-1123"></a>
</span><span id="__span-0-1124"><a id="__codelineno-0-1124" name="__codelineno-0-1124" href="#__codelineno-0-1124"></a>        for _, row in app_summary.iterrows():
</span><span id="__span-0-1125"><a id="__codelineno-0-1125" name="__codelineno-0-1125" href="#__codelineno-0-1125"></a>            print(f&quot;  {row[&#39;application_code&#39;]:&lt;20} | Total: {row[&#39;total_builds&#39;]:&lt;4} | &quot;
</span><span id="__span-0-1126"><a id="__codelineno-0-1126" name="__codelineno-0-1126" href="#__codelineno-0-1126"></a>                  f&quot;Success: {row[&#39;successful_builds&#39;]:&lt;4} | Failed: {row[&#39;failed_builds&#39;]:&lt;4} | &quot;
</span><span id="__span-0-1127"><a id="__codelineno-0-1127" name="__codelineno-0-1127" href="#__codelineno-0-1127"></a>                  f&quot;Success Rate: {row[&#39;success_rate&#39;]:&lt;5.1f}%&quot;)
</span><span id="__span-0-1128"><a id="__codelineno-0-1128" name="__codelineno-0-1128" href="#__codelineno-0-1128"></a>
</span><span id="__span-0-1129"><a id="__codelineno-0-1129" name="__codelineno-0-1129" href="#__codelineno-0-1129"></a>def main():
</span><span id="__span-0-1130"><a id="__codelineno-0-1130" name="__codelineno-0-1130" href="#__codelineno-0-1130"></a>    &quot;&quot;&quot;
</span><span id="__span-0-1131"><a id="__codelineno-0-1131" name="__codelineno-0-1131" href="#__codelineno-0-1131"></a>    Main function to run the analysis
</span><span id="__span-0-1132"><a id="__codelineno-0-1132" name="__codelineno-0-1132" href="#__codelineno-0-1132"></a>    &quot;&quot;&quot;
</span><span id="__span-0-1133"><a id="__codelineno-0-1133" name="__codelineno-0-1133" href="#__codelineno-0-1133"></a>    # Configuration - Update these values
</span><span id="__span-0-1134"><a id="__codelineno-0-1134" name="__codelineno-0-1134" href="#__codelineno-0-1134"></a>    TEAMCITY_URL = &quot;https://your-teamcity-server.com&quot;  # Replace with your TeamCity URL
</span><span id="__span-0-1135"><a id="__codelineno-0-1135" name="__codelineno-0-1135" href="#__codelineno-0-1135"></a>    USERNAME = &quot;your_username&quot;  # Replace with your username
</span><span id="__span-0-1136"><a id="__codelineno-0-1136" name="__codelineno-0-1136" href="#__codelineno-0-1136"></a>    PASSWORD = &quot;your_password&quot;  # Replace with your password
</span><span id="__span-0-1137"><a id="__codelineno-0-1137" name="__codelineno-0-1137" href="#__codelineno-0-1137"></a>
</span><span id="__span-0-1138"><a id="__codelineno-0-1138" name="__codelineno-0-1138" href="#__codelineno-0-1138"></a>    # =================== FILTER CONFIGURATION ===================
</span><span id="__span-0-1139"><a id="__codelineno-0-1139" name="__codelineno-0-1139" href="#__codelineno-0-1139"></a>    # Specify which builds you want to analyze (all filters are optional)
</span><span id="__span-0-1140"><a id="__codelineno-0-1140" name="__codelineno-0-1140" href="#__codelineno-0-1140"></a>
</span><span id="__span-0-1141"><a id="__codelineno-0-1141" name="__codelineno-0-1141" href="#__codelineno-0-1141"></a>    # Filter by project names/paths (case-insensitive, supports multiple formats)
</span><span id="__span-0-1142"><a id="__codelineno-0-1142" name="__codelineno-0-1142" href="#__codelineno-0-1142"></a>    PROJECT_FILTERS = [
</span><span id="__span-0-1143"><a id="__codelineno-0-1143" name="__codelineno-0-1143" href="#__codelineno-0-1143"></a>        # Method 1: Exact project name
</span><span id="__span-0-1144"><a id="__codelineno-0-1144" name="__codelineno-0-1144" href="#__codelineno-0-1144"></a>        &quot;project1a&quot;,
</span><span id="__span-0-1145"><a id="__codelineno-0-1145" name="__codelineno-0-1145" href="#__codelineno-0-1145"></a>        &quot;project2a&quot;,
</span><span id="__span-0-1146"><a id="__codelineno-0-1146" name="__codelineno-0-1146" href="#__codelineno-0-1146"></a>
</span><span id="__span-0-1147"><a id="__codelineno-0-1147" name="__codelineno-0-1147" href="#__codelineno-0-1147"></a>        # Method 2: Full hierarchical path with &quot; &gt; &quot; separator
</span><span id="__span-0-1148"><a id="__codelineno-0-1148" name="__codelineno-0-1148" href="#__codelineno-0-1148"></a>        # &quot;Project1 &gt; project1a&quot;,
</span><span id="__span-0-1149"><a id="__codelineno-0-1149" name="__codelineno-0-1149" href="#__codelineno-0-1149"></a>        # &quot;Project2 &gt; project2a&quot;,
</span><span id="__span-0-1150"><a id="__codelineno-0-1150" name="__codelineno-0-1150" href="#__codelineno-0-1150"></a>
</span><span id="__span-0-1151"><a id="__codelineno-0-1151" name="__codelineno-0-1151" href="#__codelineno-0-1151"></a>        # Method 3: Path with &quot;/&quot; separator (will be converted to hierarchy)
</span><span id="__span-0-1152"><a id="__codelineno-0-1152" name="__codelineno-0-1152" href="#__codelineno-0-1152"></a>        # &quot;Project1/project1a&quot;,
</span><span id="__span-0-1153"><a id="__codelineno-0-1153" name="__codelineno-0-1153" href="#__codelineno-0-1153"></a>        # &quot;Project2/project2a&quot;,
</span><span id="__span-0-1154"><a id="__codelineno-0-1154" name="__codelineno-0-1154" href="#__codelineno-0-1154"></a>
</span><span id="__span-0-1155"><a id="__codelineno-0-1155" name="__codelineno-0-1155" href="#__codelineno-0-1155"></a>        # Method 4: For your specific PAT Builds requirements:
</span><span id="__span-0-1156"><a id="__codelineno-0-1156" name="__codelineno-0-1156" href="#__codelineno-0-1156"></a>        &quot;PAT Builds&quot;,  # This will match any project named &quot;PAT Builds&quot;
</span><span id="__span-0-1157"><a id="__codelineno-0-1157" name="__codelineno-0-1157" href="#__codelineno-0-1157"></a>        &quot;Veritas Release Projects &gt; PAT - Release Builds&quot;  # Full hierarchy path
</span><span id="__span-0-1158"><a id="__codelineno-0-1158" name="__codelineno-0-1158" href="#__codelineno-0-1158"></a>
</span><span id="__span-0-1159"><a id="__codelineno-0-1159" name="__codelineno-0-1159" href="#__codelineno-0-1159"></a>        # Alternative ways to specify the same:
</span><span id="__span-0-1160"><a id="__codelineno-0-1160" name="__codelineno-0-1160" href="#__codelineno-0-1160"></a>        # &quot;PAT - Release Builds&quot;,  # Just the subproject name
</span><span id="__span-0-1161"><a id="__codelineno-0-1161" name="__codelineno-0-1161" href="#__codelineno-0-1161"></a>        # &quot;Veritas Release Projects/PAT - Release Builds&quot;  # Slash format
</span><span id="__span-0-1162"><a id="__codelineno-0-1162" name="__codelineno-0-1162" href="#__codelineno-0-1162"></a>    ]
</span><span id="__span-0-1163"><a id="__codelineno-0-1163" name="__codelineno-0-1163" href="#__codelineno-0-1163"></a>
</span><span id="__span-0-1164"><a id="__codelineno-0-1164" name="__codelineno-0-1164" href="#__codelineno-0-1164"></a>    # Filter by build type names (case-insensitive, partial matching)  
</span><span id="__span-0-1165"><a id="__codelineno-0-1165" name="__codelineno-0-1165" href="#__codelineno-0-1165"></a>    BUILD_TYPE_FILTERS = [
</span><span id="__span-0-1166"><a id="__codelineno-0-1166" name="__codelineno-0-1166" href="#__codelineno-0-1166"></a>        # Examples:
</span><span id="__span-0-1167"><a id="__codelineno-0-1167" name="__codelineno-0-1167" href="#__codelineno-0-1167"></a>        # &quot;Production Deploy&quot;,
</span><span id="__span-0-1168"><a id="__codelineno-0-1168" name="__codelineno-0-1168" href="#__codelineno-0-1168"></a>        # &quot;Integration Test&quot;,
</span><span id="__span-0-1169"><a id="__codelineno-0-1169" name="__codelineno-0-1169" href="#__codelineno-0-1169"></a>        # &quot;Unit Test&quot;
</span><span id="__span-0-1170"><a id="__codelineno-0-1170" name="__codelineno-0-1170" href="#__codelineno-0-1170"></a>    ]
</span><span id="__span-0-1171"><a id="__codelineno-0-1171" name="__codelineno-0-1171" href="#__codelineno-0-1171"></a>
</span><span id="__span-0-1172"><a id="__codelineno-0-1172" name="__codelineno-0-1172" href="#__codelineno-0-1172"></a>    # Filter by specific build names (case-insensitive, partial matching)
</span><span id="__span-0-1173"><a id="__codelineno-0-1173" name="__codelineno-0-1173" href="#__codelineno-0-1173"></a>    BUILD_NAME_FILTERS = [
</span><span id="__span-0-1174"><a id="__codelineno-0-1174" name="__codelineno-0-1174" href="#__codelineno-0-1174"></a>        # Examples:
</span><span id="__span-0-1175"><a id="__codelineno-0-1175" name="__codelineno-0-1175" href="#__codelineno-0-1175"></a>        # &quot;nightly&quot;,
</span><span id="__span-0-1176"><a id="__codelineno-0-1176" name="__codelineno-0-1176" href="#__codelineno-0-1176"></a>        # &quot;release&quot;,
</span><span id="__span-0-1177"><a id="__codelineno-0-1177" name="__codelineno-0-1177" href="#__codelineno-0-1177"></a>        # &quot;hotfix&quot;
</span><span id="__span-0-1178"><a id="__codelineno-0-1178" name="__codelineno-0-1178" href="#__codelineno-0-1178"></a>    ]
</span><span id="__span-0-1179"><a id="__codelineno-0-1179" name="__codelineno-0-1179" href="#__codelineno-0-1179"></a>
</span><span id="__span-0-1180"><a id="__codelineno-0-1180" name="__codelineno-0-1180" href="#__codelineno-0-1180"></a>    # ============================================================
</span><span id="__span-0-1181"><a id="__codelineno-0-1181" name="__codelineno-0-1181" href="#__codelineno-0-1181"></a>    # IMPORTANT NOTES:
</span><span id="__span-0-1182"><a id="__codelineno-0-1182" name="__codelineno-0-1182" href="#__codelineno-0-1182"></a>    # - Project filters support multiple formats:
</span><span id="__span-0-1183"><a id="__codelineno-0-1183" name="__codelineno-0-1183" href="#__codelineno-0-1183"></a>    #   1. Exact project name: &quot;project1a&quot;
</span><span id="__span-0-1184"><a id="__codelineno-0-1184" name="__codelineno-0-1184" href="#__codelineno-0-1184"></a>    #   2. Hierarchy with &quot; &gt; &quot;: &quot;Project1 &gt; project1a&quot;
</span><span id="__span-0-1185"><a id="__codelineno-0-1185" name="__codelineno-0-1185" href="#__codelineno-0-1185"></a>    #   3. Hierarchy with &quot;/&quot;: &quot;Project1/project1a&quot;
</span><span id="__span-0-1186"><a id="__codelineno-0-1186" name="__codelineno-0-1186" href="#__codelineno-0-1186"></a>    # - All matching is case-insensitive
</span><span id="__span-0-1187"><a id="__codelineno-0-1187" name="__codelineno-0-1187" href="#__codelineno-0-1187"></a>    # - You can mix different formats in the same list
</span><span id="__span-0-1188"><a id="__codelineno-0-1188" name="__codelineno-0-1188" href="#__codelineno-0-1188"></a>    # - If you leave a filter list empty [], it won&#39;t filter on that criteria
</span><span id="__span-0-1189"><a id="__codelineno-0-1189" name="__codelineno-0-1189" href="#__codelineno-0-1189"></a>    # ============================================================
</span><span id="__span-0-1190"><a id="__codelineno-0-1190" name="__codelineno-0-1190" href="#__codelineno-0-1190"></a>
</span><span id="__span-0-1191"><a id="__codelineno-0-1191" name="__codelineno-0-1191" href="#__codelineno-0-1191"></a>    try:
</span><span id="__span-0-1192"><a id="__codelineno-0-1192" name="__codelineno-0-1192" href="#__codelineno-0-1192"></a>        # Initialize analyzer with filters
</span><span id="__span-0-1193"><a id="__codelineno-0-1193" name="__codelineno-0-1193" href="#__codelineno-0-1193"></a>        analyzer = TeamCityBuildAnalyzer(
</span><span id="__span-0-1194"><a id="__codelineno-0-1194" name="__codelineno-0-1194" href="#__codelineno-0-1194"></a>            TEAMCITY_URL, 
</span><span id="__span-0-1195"><a id="__codelineno-0-1195" name="__codelineno-0-1195" href="#__codelineno-0-1195"></a>            USERNAME, 
</span><span id="__span-0-1196"><a id="__codelineno-0-1196" name="__codelineno-0-1196" href="#__codelineno-0-1196"></a>            PASSWORD,
</span><span id="__span-0-1197"><a id="__codelineno-0-1197" name="__codelineno-0-1197" href="#__codelineno-0-1197"></a>            project_filters=PROJECT_FILTERS,
</span><span id="__span-0-1198"><a id="__codelineno-0-1198" name="__codelineno-0-1198" href="#__codelineno-0-1198"></a>            build_type_filters=BUILD_TYPE_FILTERS,
</span><span id="__span-0-1199"><a id="__codelineno-0-1199" name="__codelineno-0-1199" href="#__codelineno-0-1199"></a>            build_name_filters=BUILD_NAME_FILTERS
</span><span id="__span-0-1200"><a id="__codelineno-0-1200" name="__codelineno-0-1200" href="#__codelineno-0-1200"></a>        )
</span><span id="__span-0-1201"><a id="__codelineno-0-1201" name="__codelineno-0-1201" href="#__codelineno-0-1201"></a>
</span><span id="__span-0-1202"><a id="__codelineno-0-1202" name="__codelineno-0-1202" href="#__codelineno-0-1202"></a>        # Fetch builds from last month (filtered)
</span><span id="__span-0-1203"><a id="__codelineno-0-1203" name="__codelineno-0-1203" href="#__codelineno-0-1203"></a>        print(&quot;Starting TeamCity build analysis...&quot;)
</span><span id="__span-0-1204"><a id="__codelineno-0-1204" name="__codelineno-0-1204" href="#__codelineno-0-1204"></a>        builds = analyzer.get_builds_last_month()
</span><span id="__span-0-1205"><a id="__codelineno-0-1205" name="__codelineno-0-1205" href="#__codelineno-0-1205"></a>
</span><span id="__span-0-1206"><a id="__codelineno-0-1206" name="__codelineno-0-1206" href="#__codelineno-0-1206"></a>        if not builds:
</span><span id="__span-0-1207"><a id="__codelineno-0-1207" name="__codelineno-0-1207" href="#__codelineno-0-1207"></a>            print(&quot;No builds found matching the specified filters for the last month.&quot;)
</span><span id="__span-0-1208"><a id="__codelineno-0-1208" name="__codelineno-0-1208" href="#__codelineno-0-1208"></a>            print(&quot;Consider:&quot;)
</span><span id="__span-0-1209"><a id="__codelineno-0-1209" name="__codelineno-0-1209" href="#__codelineno-0-1209"></a>            print(&quot;  1. Checking if the filter terms are correct&quot;)
</span><span id="__span-0-1210"><a id="__codelineno-0-1210" name="__codelineno-0-1210" href="#__codelineno-0-1210"></a>            print(&quot;  2. Verifying the project/build names in TeamCity&quot;)
</span><span id="__span-0-1211"><a id="__codelineno-0-1211" name="__codelineno-0-1211" href="#__codelineno-0-1211"></a>            print(&quot;  3. Try using the full hierarchy path: &#39;Parent Project &gt; Sub Project&#39;&quot;)
</span><span id="__span-0-1212"><a id="__codelineno-0-1212" name="__codelineno-0-1212" href="#__codelineno-0-1212"></a>            print(&quot;  4. Expanding the date range or removing some filters&quot;)
</span><span id="__span-0-1213"><a id="__codelineno-0-1213" name="__codelineno-0-1213" href="#__codelineno-0-1213"></a>            return
</span><span id="__span-0-1214"><a id="__codelineno-0-1214" name="__codelineno-0-1214" href="#__codelineno-0-1214"></a>
</span><span id="__span-0-1215"><a id="__codelineno-0-1215" name="__codelineno-0-1215" href="#__codelineno-0-1215"></a>        # Analyze builds
</span><span id="__span-0-1216"><a id="__codelineno-0-1216" name="__codelineno-0-1216" href="#__codelineno-0-1216"></a>        print(&quot;Analyzing build data...&quot;)
</span><span id="__span-0-1217"><a id="__codelineno-0-1217" name="__codelineno-0-1217" href="#__codelineno-0-1217"></a>        df = analyzer.analyze_builds(builds)
</span><span id="__span-0-1218"><a id="__codelineno-0-1218" name="__codelineno-0-1218" href="#__codelineno-0-1218"></a>
</span><span id="__span-0-1219"><a id="__codelineno-0-1219" name="__codelineno-0-1219" href="#__codelineno-0-1219"></a>        # Generate summary
</span><span id="__span-0-1220"><a id="__codelineno-0-1220" name="__codelineno-0-1220" href="#__codelineno-0-1220"></a>        summary = analyzer.generate_summary(df)
</span><span id="__span-0-1221"><a id="__codelineno-0-1221" name="__codelineno-0-1221" href="#__codelineno-0-1221"></a>
</span><span id="__span-0-1222"><a id="__codelineno-0-1222" name="__codelineno-0-1222" href="#__codelineno-0-1222"></a>        # Save results (now includes Excel)
</span><span id="__span-0-1223"><a id="__codelineno-0-1223" name="__codelineno-0-1223" href="#__codelineno-0-1223"></a>        analyzer.save_results(df, summary)
</span><span id="__span-0-1224"><a id="__codelineno-0-1224" name="__codelineno-0-1224" href="#__codelineno-0-1224"></a>
</span><span id="__span-0-1225"><a id="__codelineno-0-1225" name="__codelineno-0-1225" href="#__codelineno-0-1225"></a>        # Print report
</span><span id="__span-0-1226"><a id="__codelineno-0-1226" name="__codelineno-0-1226" href="#__codelineno-0-1226"></a>        analyzer.print_summary_report(summary)
</span><span id="__span-0-1227"><a id="__codelineno-0-1227" name="__codelineno-0-1227" href="#__codelineno-0-1227"></a>
</span><span id="__span-0-1228"><a id="__codelineno-0-1228" name="__codelineno-0-1228" href="#__codelineno-0-1228"></a>        print(&quot;\n&quot; + &quot;=&quot;*60)
</span><span id="__span-0-1229"><a id="__codelineno-0-1229" name="__codelineno-0-1229" href="#__codelineno-0-1229"></a>        print(&quot;📊 ANALYSIS COMPLETE!&quot;)
</span><span id="__span-0-1230"><a id="__codelineno-0-1230" name="__codelineno-0-1230" href="#__codelineno-0-1230"></a>        print(&quot;Files generated:&quot;)
</span><span id="__span-0-1231"><a id="__codelineno-0-1231" name="__codelineno-0-1231" href="#__codelineno-0-1231"></a>        print(&quot;  - CSV files for detailed and summary data&quot;)
</span><span id="__span-0-1232"><a id="__codelineno-0-1232" name="__codelineno-0-1232" href="#__codelineno-0-1232"></a>        print(&quot;  - Formatted Excel report with multiple sheets&quot;)
</span><span id="__span-0-1233"><a id="__codelineno-0-1233" name="__codelineno-0-1233" href="#__codelineno-0-1233"></a>        print(&quot;=&quot;*60)
</span><span id="__span-0-1234"><a id="__codelineno-0-1234" name="__codelineno-0-1234" href="#__codelineno-0-1234"></a>
</span><span id="__span-0-1235"><a id="__codelineno-0-1235" name="__codelineno-0-1235" href="#__codelineno-0-1235"></a>    except Exception as e:
</span><span id="__span-0-1236"><a id="__codelineno-0-1236" name="__codelineno-0-1236" href="#__codelineno-0-1236"></a>        print(f&quot;Error during analysis: {e}&quot;)
</span><span id="__span-0-1237"><a id="__codelineno-0-1237" name="__codelineno-0-1237" href="#__codelineno-0-1237"></a>        raise
</span><span id="__span-0-1238"><a id="__codelineno-0-1238" name="__codelineno-0-1238" href="#__codelineno-0-1238"></a>
</span><span id="__span-0-1239"><a id="__codelineno-0-1239" name="__codelineno-0-1239" href="#__codelineno-0-1239"></a>if __name__ == &quot;__main__&quot;:
</span><span id="__span-0-1240"><a id="__codelineno-0-1240" name="__codelineno-0-1240" href="#__codelineno-0-1240"></a>    main()
</span></code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../javascripts/extra.js"></script>
      
    
  </body>
</html>